{
  "success": true,
  "phase": "Phase 7 Week 2",
  "elapsed_time": "1.0s",
  "analysis_results": {
    "db_analysis": {
      "current_db_coverage": "100.0%",
      "db_test_files_found": 34,
      "valid_db_tests": 33,
      "total_db_tests": 33
    },
    "repository_components": {
      "repositories_by_file": {
        "src/repositories/base.py": [
          {
            "name": "QuerySpec",
            "file": "src/repositories/base.py",
            "line": 23,
            "has_repo_methods": false,
            "base_classes": []
          },
          {
            "name": "BaseRepository",
            "file": "src/repositories/base.py",
            "line": 33,
            "has_repo_methods": false,
            "base_classes": [
              "ABC"
            ]
          },
          {
            "name": "ReadOnlyRepository",
            "file": "src/repositories/base.py",
            "line": 129,
            "has_repo_methods": false,
            "base_classes": [
              "ABC"
            ]
          },
          {
            "name": "WriteOnlyRepository",
            "file": "src/repositories/base.py",
            "line": 156,
            "has_repo_methods": false,
            "base_classes": [
              "ABC"
            ]
          },
          {
            "name": "Repository",
            "file": "src/repositories/base.py",
            "line": 196,
            "has_repo_methods": false,
            "base_classes": [
              "ABC"
            ]
          }
        ],
        "src/repositories/prediction.py": [
          {
            "name": "PredictionRepositoryInterface",
            "file": "src/repositories/prediction.py",
            "line": 19,
            "has_repo_methods": false,
            "base_classes": []
          },
          {
            "name": "ReadOnlyPredictionRepository",
            "file": "src/repositories/prediction.py",
            "line": 25,
            "has_repo_methods": false,
            "base_classes": []
          },
          {
            "name": "PredictionRepository",
            "file": "src/repositories/prediction.py",
            "line": 202,
            "has_repo_methods": false,
            "base_classes": [
              "PredictionRepositoryInterface"
            ]
          }
        ],
        "src/repositories/user.py": [
          {
            "name": "UserRepositoryInterface",
            "file": "src/repositories/user.py",
            "line": 18,
            "has_repo_methods": false,
            "base_classes": []
          },
          {
            "name": "ReadOnlyUserRepository",
            "file": "src/repositories/user.py",
            "line": 24,
            "has_repo_methods": false,
            "base_classes": []
          },
          {
            "name": "UserRepository",
            "file": "src/repositories/user.py",
            "line": 122,
            "has_repo_methods": false,
            "base_classes": [
              "UserRepositoryInterface"
            ]
          }
        ],
        "src/repositories/provider.py": [
          {
            "name": "RepositoryFactory",
            "file": "src/repositories/provider.py",
            "line": 25,
            "has_repo_methods": false,
            "base_classes": [
              "Protocol"
            ]
          },
          {
            "name": "DefaultRepositoryFactory",
            "file": "src/repositories/provider.py",
            "line": 47,
            "has_repo_methods": false,
            "base_classes": []
          },
          {
            "name": "RepositoryProvider",
            "file": "src/repositories/provider.py",
            "line": 78,
            "has_repo_methods": false,
            "base_classes": []
          }
        ],
        "src/repositories/auth_user.py": [
          {
            "name": "AuthUserRepository",
            "file": "src/repositories/auth_user.py",
            "line": 15,
            "has_repo_methods": false,
            "base_classes": []
          }
        ],
        "src/repositories/match.py": [
          {
            "name": "MatchStatus",
            "file": "src/repositories/match.py",
            "line": 19,
            "has_repo_methods": false,
            "base_classes": [
              "str",
              "Enum"
            ]
          },
          {
            "name": "MatchRepositoryInterface",
            "file": "src/repositories/match.py",
            "line": 29,
            "has_repo_methods": false,
            "base_classes": []
          },
          {
            "name": "ReadOnlyMatchRepository",
            "file": "src/repositories/match.py",
            "line": 35,
            "has_repo_methods": false,
            "base_classes": []
          },
          {
            "name": "MatchRepository",
            "file": "src/repositories/match.py",
            "line": 196,
            "has_repo_methods": false,
            "base_classes": [
              "MatchRepositoryInterface"
            ]
          }
        ],
        "src/database/models/league.py": [
          {
            "name": "League",
            "file": "src/database/models/league.py",
            "line": 10,
            "has_repo_methods": false,
            "base_classes": [
              "BaseModel"
            ]
          }
        ],
        "src/database/models/audit_log.py": [
          {
            "name": "AuditAction",
            "file": "src/database/models/audit_log.py",
            "line": 20,
            "has_repo_methods": false,
            "base_classes": [
              "str",
              "Enum"
            ]
          },
          {
            "name": "AuditSeverity",
            "file": "src/database/models/audit_log.py",
            "line": 44,
            "has_repo_methods": false,
            "base_classes": [
              "str",
              "Enum"
            ]
          },
          {
            "name": "AuditLog",
            "file": "src/database/models/audit_log.py",
            "line": 54,
            "has_repo_methods": false,
            "base_classes": [
              "BaseModel"
            ]
          },
          {
            "name": "AuditLogSummary",
            "file": "src/database/models/audit_log.py",
            "line": 99,
            "has_repo_methods": false,
            "base_classes": [
              "BaseModel"
            ]
          }
        ],
        "src/database/models/data_quality_log.py": [
          {
            "name": "DataQualityLog",
            "file": "src/database/models/data_quality_log.py",
            "line": 19,
            "has_repo_methods": false,
            "base_classes": [
              "BaseModel"
            ]
          }
        ],
        "src/database/models/features.py": [
          {
            "name": "TeamType",
            "file": "src/database/models/features.py",
            "line": 36,
            "has_repo_methods": false,
            "base_classes": [
              "str",
              "Enum"
            ]
          },
          {
            "name": "FeatureEntityType",
            "file": "src/database/models/features.py",
            "line": 43,
            "has_repo_methods": false,
            "base_classes": [
              "str",
              "Enum"
            ]
          },
          {
            "name": "FeatureEntity",
            "file": "src/database/models/features.py",
            "line": 52,
            "has_repo_methods": false,
            "base_classes": [
              "BaseModel"
            ]
          },
          {
            "name": "Features",
            "file": "src/database/models/features.py",
            "line": 75,
            "has_repo_methods": false,
            "base_classes": [
              "BaseModel"
            ]
          }
        ],
        "src/database/models/data_collection_log.py": [
          {
            "name": "CollectionStatus",
            "file": "src/database/models/data_collection_log.py",
            "line": 27,
            "has_repo_methods": false,
            "base_classes": [
              "Enum"
            ]
          },
          {
            "name": "CollectionType",
            "file": "src/database/models/data_collection_log.py",
            "line": 36,
            "has_repo_methods": false,
            "base_classes": [
              "Enum"
            ]
          },
          {
            "name": "DataCollectionLog",
            "file": "src/database/models/data_collection_log.py",
            "line": 45,
            "has_repo_methods": false,
            "base_classes": [
              "BaseModel"
            ]
          }
        ],
        "src/database/models/user.py": [
          {
            "name": "UserRole",
            "file": "src/database/models/user.py",
            "line": 12,
            "has_repo_methods": false,
            "base_classes": [
              "str",
              "Enum"
            ]
          },
          {
            "name": "User",
            "file": "src/database/models/user.py",
            "line": 21,
            "has_repo_methods": true,
            "base_classes": [
              "BaseModel"
            ]
          }
        ],
        "src/database/models/predictions.py": [
          {
            "name": "PredictedResult",
            "file": "src/database/models/predictions.py",
            "line": 29,
            "has_repo_methods": false,
            "base_classes": [
              "Enum"
            ]
          },
          {
            "name": "Predictions",
            "file": "src/database/models/predictions.py",
            "line": 37,
            "has_repo_methods": false,
            "base_classes": [
              "BaseModel"
            ]
          }
        ],
        "src/database/models/raw_data.py": [
          {
            "name": "RawData",
            "file": "src/database/models/raw_data.py",
            "line": 7,
            "has_repo_methods": false,
            "base_classes": [
              "BaseModel"
            ]
          },
          {
            "name": "RawMatchData",
            "file": "src/database/models/raw_data.py",
            "line": 19,
            "has_repo_methods": false,
            "base_classes": [
              "BaseModel"
            ]
          },
          {
            "name": "RawOddsData",
            "file": "src/database/models/raw_data.py",
            "line": 33,
            "has_repo_methods": false,
            "base_classes": [
              "BaseModel"
            ]
          },
          {
            "name": "RawScoresData",
            "file": "src/database/models/raw_data.py",
            "line": 47,
            "has_repo_methods": false,
            "base_classes": [
              "BaseModel"
            ]
          }
        ],
        "src/database/models/odds.py": [
          {
            "name": "MarketType",
            "file": "src/database/models/odds.py",
            "line": 18,
            "has_repo_methods": false,
            "base_classes": [
              "Enum"
            ]
          },
          {
            "name": "BetType",
            "file": "src/database/models/odds.py",
            "line": 29,
            "has_repo_methods": false,
            "base_classes": [
              "Enum"
            ]
          },
          {
            "name": "Odds",
            "file": "src/database/models/odds.py",
            "line": 40,
            "has_repo_methods": false,
            "base_classes": [
              "Base"
            ]
          },
          {
            "name": "OddsHistory",
            "file": "src/database/models/odds.py",
            "line": 67,
            "has_repo_methods": false,
            "base_classes": [
              "Base"
            ]
          },
          {
            "name": "MarketAnalysis",
            "file": "src/database/models/odds.py",
            "line": 82,
            "has_repo_methods": false,
            "base_classes": [
              "Base"
            ]
          }
        ],
        "src/database/models/team.py": [
          {
            "name": "TeamForm",
            "file": "src/database/models/team.py",
            "line": 15,
            "has_repo_methods": false,
            "base_classes": [
              "Enum"
            ]
          },
          {
            "name": "Team",
            "file": "src/database/models/team.py",
            "line": 23,
            "has_repo_methods": false,
            "base_classes": [
              "BaseModel"
            ]
          }
        ],
        "src/database/models/match.py": [
          {
            "name": "MatchStatus",
            "file": "src/database/models/match.py",
            "line": 29,
            "has_repo_methods": false,
            "base_classes": [
              "Enum"
            ]
          },
          {
            "name": "MatchResult",
            "file": "src/database/models/match.py",
            "line": 38,
            "has_repo_methods": false,
            "base_classes": [
              "Enum"
            ]
          },
          {
            "name": "Match",
            "file": "src/database/models/match.py",
            "line": 46,
            "has_repo_methods": false,
            "base_classes": [
              "BaseModel"
            ]
          }
        ],
        "src/database/repositories/base.py": [
          {
            "name": "BaseRepository",
            "file": "src/database/repositories/base.py",
            "line": 23,
            "has_repo_methods": false,
            "base_classes": [
              "ABC"
            ]
          }
        ],
        "src/database/repositories/prediction.py": [
          {
            "name": "PredictionStatus",
            "file": "src/database/repositories/prediction.py",
            "line": 24,
            "has_repo_methods": false,
            "base_classes": []
          },
          {
            "name": "PredictionRepository",
            "file": "src/database/repositories/prediction.py",
            "line": 30,
            "has_repo_methods": false,
            "base_classes": []
          }
        ],
        "src/database/repositories/user.py": [
          {
            "name": "UserRepository",
            "file": "src/database/repositories/user.py",
            "line": 20,
            "has_repo_methods": false,
            "base_classes": []
          }
        ],
        "src/database/repositories/team_repository.py": [
          {
            "name": "TeamRepository",
            "file": "src/database/repositories/team_repository.py",
            "line": 12,
            "has_repo_methods": false,
            "base_classes": [
              "ABC"
            ]
          }
        ],
        "src/database/repositories/match.py": [
          {
            "name": "MatchRepository",
            "file": "src/database/repositories/match.py",
            "line": 20,
            "has_repo_methods": false,
            "base_classes": []
          }
        ],
        "src/database/repositories/match_repository/match.py": [
          {
            "name": "MatchRepository",
            "file": "src/database/repositories/match_repository/match.py",
            "line": 15,
            "has_repo_methods": false,
            "base_classes": []
          }
        ]
      },
      "total_repositories": 57,
      "files_analyzed": 3
    },
    "db_test_expansion": {
      "tests_generated": 171,
      "repositories_tested": 57,
      "test_files_created": 23
    },
    "db_integration": {
      "integration_status": "✅ 集成测试通过",
      "integration_files": [
        "tests/unit/database: 60 个文件",
        "tests/integration: 36 个文件"
      ],
      "simple_db_test": "✅ 通过",
      "status": "integration_verified"
    },
    "db_report": {
      "db_coverage": "已扩展",
      "test_files_covered": 24,
      "status": "tests_generated"
    }
  },
  "summary": {
    "current_db_coverage": "100.0%",
    "target_db_coverage": "60%+",
    "tests_generated": 23,
    "repositories_tested": 57,
    "db_integration_status": "✅ 集成测试通过"
  },
  "recommendations": [
    "📈 继续扩展数据库仓储层测试至60%+覆盖率",
    "🔧 优化数据库连接池和事务管理",
    "📊 建立数据库性能监控机制",
    "🔄 集成数据库迁移和版本控制",
    "🚀 准备生产环境数据库配置"
  ]
}