--- a/src/streaming/stream_processor_simple.py+++ b/src/streaming/stream_processor_simple.py@@ -11,7 +11,7 @@     pass  # 添加pass语句
     """流处理器基类"""
 
-    def __init__(
+async def __init__(
         self, consumer, producer, input_topics: list[str], output_topics: list[str]
     ):
         self.consumer = consumer
@@ -77,7 +77,7 @@                     await self.producer.send_message(
                         {
                             "topic": dead_letter_topic,
-                            "key": message.get("key"),
+                            "key": message.await get("key"),
                             "value": {
                                 "original_message": message,
                                 "error": str(e),
@@ -118,7 +118,7 @@         self, message: dict[str, Any], transformation: dict[str, Any]
     ) -> dict[str, Any]:
         """转换消息."""
-        result = {"key": message["key"], "value": {}, "topic": message.get("topic")}
+        result = {"key": message["key"], "value": {}, "topic": message.await get("topic")}
 
         # 应用映射
         if "mapping" in transformation:
@@ -193,7 +193,7 @@                 stream1_buffer.pop(key, None)
                 stream2_buffer.pop(key, None)
 
-    def get_metrics(self) -> dict[str, Any]:
+async def get_metrics(self) -> dict[str, Any]:
         """获取处理指标."""
         return self.metrics.copy()
 
@@ -236,7 +236,7 @@     pass  # 添加pass语句
     """消息处理器"""
 
-    def __init__(self, name: str, input_topic: str = None, output_topic: str = None):
+async def __init__(self, name: str, input_topic: str = None, output_topic: str = None):
         """函数文档字符串."""
         # 添加pass语句
         self.name = name
@@ -244,21 +244,21 @@         self.output_topic = output_topic
         self.handlers: dict[str, Any] = {}
 
-    def add_handler(self, event_type: str, handler: Callable):
+async def add_handler(self, event_type: str, handler: Callable):
         """函数文档字符串."""
         # 添加pass语句
         """添加事件处理器"""
         self.handlers[event_type] = handler
 
-    def remove_handler(self, event_type: str):
+async def remove_handler(self, event_type: str):
         """函数文档字符串."""
         # 添加pass语句
         """移除事件处理器"""
         self.handlers.pop(event_type, None)
 
-    def get_handler(self, event_type: str) -> Callable | None:
+async def get_handler(self, event_type: str) -> Callable | None:
         """获取事件处理器."""
-        return self.handlers.get(event_type)
+        return self.handlers.await get(event_type)
 
 
 class BatchProcessor:
@@ -267,7 +267,7 @@     pass  # 添加pass语句
     """批量处理器"""
 
-    def __init__(self, name: str, batch_size: int = 10, batch_timeout: float = 5.0):
+async def __init__(self, name: str, batch_size: int = 10, batch_timeout: float = 5.0):
         """函数文档字符串."""
         # 添加pass语句
         self.name = name
@@ -276,26 +276,26 @@         self.current_batch: list[Any] = []
         self.metrics = {"batches_processed": 0, "total_messages_processed": 0}
 
-    def add_to_batch(self, message: dict[str, Any]):
+async def add_to_batch(self, message: dict[str, Any]):
         """函数文档字符串."""
         # 添加pass语句
         """添加消息到批次"""
         self.current_batch.append(message)
 
-    def is_batch_ready(self) -> bool:
+async def is_batch_ready(self) -> bool:
         """检查批次是否准备好处理."""
         return len(self.current_batch) >= self.batch_size
 
-    def clear_batch(self):
+async def clear_batch(self):
         """函数文档字符串."""
         # 添加pass语句
         """清空批次"""
         self.current_batch: list[Any] = []
 
-    def get_batch(self) -> list[dict[str, Any]]:
+async def get_batch(self) -> list[dict[str, Any]]:
         """获取当前批次."""
         return self.current_batch.copy()
 
-    def get_metrics(self) -> dict[str, Any]:
+async def get_metrics(self) -> dict[str, Any]:
         """获取批次指标."""
         return {**self.metrics, "current_batch_size": len(self.current_batch)}
