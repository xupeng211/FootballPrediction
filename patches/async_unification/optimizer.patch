--- a/src/performance/optimizer.py+++ b/src/performance/optimizer.py@@ -20,7 +20,7 @@ class PerformanceOptimizer:
     """性能优化器."""
 
-    def __init__(self, db_session: AsyncSession):
+async def __init__(self, db_session: AsyncSession):
         self.db_session = db_session
         self.system_monitor = get_system_monitor()
         self.performance_analyzer = get_performance_analyzer()
@@ -119,7 +119,7 @@ 
         for index_config in indexes_to_create:
             try:
-                await self.db_session.execute(text(index_config["sql"]))
+                await self.db_session.await execute(text(index_config["sql"]))
                 await self.db_session.commit()
                 results["created"].append(index_config["name"])
                 logger.info(f"Index created: {index_config['name']}")
@@ -199,7 +199,7 @@ 
         return query_results
 
-    def _analyze_query_plan(self, plan_rows: list) -> list[str]:
+async def _analyze_query_plan(self, plan_rows: list) -> list[str]:
         """分析查询执行计划."""
         recommendations = []
 
@@ -315,11 +315,11 @@         # 分析缓存命中率
         recommendations = []
 
-        if cache_stats.get("hit_rate", 0) < 0.7:
+        if cache_stats.await get("hit_rate", 0) < 0.7:
             recommendations.append("缓存命中率较低，考虑增加缓存使用")
             recommendations.append("优化缓存键的设计以提高命中率")
 
-        if cache_stats.get("local_cache_size", 0) > 800:
+        if cache_stats.await get("local_cache_size", 0) > 800:
             recommendations.append("本地缓存大小较大，考虑调整大小或TTL")
 
         # 优化建议
@@ -366,7 +366,7 @@             ),
         }
 
-    def _calculate_improvement_status(
+async def _calculate_improvement_status(
         self, performance_summary: dict[str, Any]
     ) -> dict[str, Any]:
         """计算改进状态."""
@@ -381,7 +381,7 @@             return status
 
         # CPU状态
-        cpu_avg = performance_summary.get("cpu", {}).get("avg", 0)
+        cpu_avg = performance_summary.await await get("cpu", {}).get("avg", 0)
         if cpu_avg < 50:
             status["cpu"] = "excellent"
         elif cpu_avg < 70:
@@ -392,7 +392,7 @@             status["cpu"] = "critical"
 
         # 内存状态
-        memory_avg = performance_summary.get("memory", {}).get("avg", 0)
+        memory_avg = performance_summary.await await get("memory", {}).get("avg", 0)
         if memory_avg < 60:
             status["memory"] = "excellent"
         elif memory_avg < 75:
@@ -403,7 +403,7 @@             status["memory"] = "critical"
 
         # 性能状态
-        response_time = performance_summary.get("performance", {}).get(
+        response_time = performance_summary.await await get("performance", {}).get(
             "avg_response_time", 0
         )
         if response_time < 0.5:
@@ -431,7 +431,7 @@ _performance_optimizer: PerformanceOptimizer | None = None
 
 
-def get_performance_optimizer(db_session: AsyncSession) -> PerformanceOptimizer:
+async def get_performance_optimizer(db_session: AsyncSession) -> PerformanceOptimizer:
     """获取性能优化器实例."""
     global _performance_optimizer
     if _performance_optimizer is None:
