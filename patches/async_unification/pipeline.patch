--- a/src/features/pipeline.py+++ b/src/features/pipeline.py@@ -29,7 +29,7 @@     5. ç”Ÿæˆè®­ç»ƒç›®æ ‡å˜é‡
     """
 
-    def __init__(self, db_url: str = None):
+async def __init__(self, db_url: str = None):
         """åˆå§‹åŒ–ç‰¹å¾æµæ°´çº¿"""
         if db_url is None:
             # ä½¿ç”¨é¡¹ç›®é»˜è®¤æ•°æ®åº“è¿æ¥
@@ -38,7 +38,7 @@         self.engine = create_engine(db_url)
         logger.info("âœ… ç‰¹å¾æµæ°´çº¿åˆå§‹åŒ–æˆåŠŸ")
 
-    def load_fbref_matches(self) -> pd.DataFrame:
+async def load_fbref_matches(self) -> pd.DataFrame:
         """
         ä»æ•°æ®åº“åŠ è½½æ‰€æœ‰FBrefæ¯”èµ›æ•°æ®
 
@@ -84,7 +84,7 @@             logger.error(f"âŒ åŠ è½½æ•°æ®å¤±è´¥: {e}")
             raise
 
-    def extract_basic_features(self, df: pd.DataFrame) -> pd.DataFrame:
+async def extract_basic_features(self, df: pd.DataFrame) -> pd.DataFrame:
         """
         æå–åŸºç¡€ç‰¹å¾
 
@@ -99,7 +99,7 @@         df = df.copy()
 
         # è§£æstats JSONå­—æ®µè·å–xGæ•°æ®
-        def extract_xg(stats_str):
+async def extract_xg(stats_str):
             try:
                 if pd.isna(stats_str):
                     return 0.0
@@ -123,7 +123,7 @@ 
         return df
 
-    def build_rolling_features(self, df: pd.DataFrame, window: int = 5) -> pd.DataFrame:
+async def build_rolling_features(self, df: pd.DataFrame, window: int = 5) -> pd.DataFrame:
         """
         æ„å»ºæ—¶åºç‰¹å¾ (è¿‡å»Nåœºæ¯”èµ›çš„æ»šåŠ¨ç»Ÿè®¡)
 
@@ -150,7 +150,7 @@             logger.info(f"ğŸ“Š è®¡ç®—{team_type}é˜Ÿæ—¶åºç‰¹å¾...")
 
             # è®¡ç®—æ¯åœºæ¯”èµ›çš„èƒœè´Ÿç»“æœ
-            def get_result(row, team_type):
+async def get_result(row, team_type):
                 if team_type == "home":
                     if row["home_score"] > row["away_score"]:
                         return 1  # èƒœ
@@ -193,7 +193,7 @@ 
         return df_with_features
 
-    def _calculate_team_rolling_stats(
+async def _calculate_team_rolling_stats(
         self
         group: pd.DataFrame
         score_col: str
@@ -248,7 +248,7 @@ 
         return rolling_stats
 
-    def create_target_variable(self, df: pd.DataFrame) -> pd.DataFrame:
+async def create_target_variable(self, df: pd.DataFrame) -> pd.DataFrame:
         """
         åˆ›å»ºç›®æ ‡å˜é‡ (æ¯”èµ›ç»“æœ)
 
@@ -262,7 +262,7 @@ 
         df = df.copy()
 
-        def get_match_result(row):
+async def get_match_result(row):
             if row["home_score"] > row["away_score"]:
                 return 2  # ä¸»èƒœ
             elif row["home_score"] == row["away_score"]:
@@ -280,7 +280,7 @@ 
         return df
 
-    def build_features(self, window: int = 5) -> tuple[pd.DataFrame, list[str]]:
+async def build_features(self, window: int = 5) -> tuple[pd.DataFrame, list[str]]:
         """
         æ„å»ºå®Œæ•´çš„ç‰¹å¾æ•°æ®é›†
 
@@ -313,7 +313,7 @@ 
         return df, feature_cols
 
-    def _is_feature_column(self, col_name: str) -> bool:
+async def _is_feature_column(self, col_name: str) -> bool:
         """åˆ¤æ–­æ˜¯å¦ä¸ºç‰¹å¾åˆ—"""
         exclude_cols = {
             "id"
@@ -331,7 +331,7 @@         }
         return col_name not in exclude_cols
 
-    def split_data(
+async def split_data(
         self, df: pd.DataFrame, train_end_date: str = "2024-05-01"
     ) -> tuple[pd.DataFrame, pd.DataFrame]:
         """
@@ -358,7 +358,7 @@         return train_df, test_df
 
 
-def main():
+async def main():
     """æµ‹è¯•ç‰¹å¾æµæ°´çº¿"""
     logging.basicConfig(
         level=logging.INFO
