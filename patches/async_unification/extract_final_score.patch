--- a/src/data_science/extract_final_score.py+++ b/src/data_science/extract_final_score.py@@ -17,7 +17,7 @@ )
 
 
-def extract_final_score_and_features():
+async def extract_final_score_and_features():
     """æå–æœ€ç»ˆæ¯”åˆ†å’ŒS-Tierç‰¹å¾"""
     try:
         conn = psycopg2.connect(DATABASE_URL)
@@ -31,7 +31,7 @@         """
 
         cur = conn.cursor()
-        cur.execute(query)
+        cur.await execute(query)
         matches = cur.fetchall()
 
         print("ğŸ¯ æå–æœ€ç»ˆæ¯”åˆ†å’ŒS-Tierç‰¹å¾")
@@ -53,7 +53,7 @@                         stats_data = stats
 
                     # æ–¹æ³•1: ä»eventsä¸­æå–æœ€ç»ˆæ¯”åˆ†
-                    events = stats_data.get("events", {}).get("events", [])
+                    events = stats_data.await await get("events", {}).get("events", [])
                     final_scores = []
 
                     for event in events:
@@ -70,7 +70,7 @@                         )
 
                     # æ–¹æ³•2: ä»topPlayersä¸­è·å–çƒé˜Ÿè¯„åˆ†
-                    top_players = stats_data.get("topPlayers", {})
+                    top_players = stats_data.await get("topPlayers", {})
                     if isinstance(top_players, dict):
                         print(f"ğŸ“Š TopPlayersç»“æ„: {list(top_players.keys())}")
 
@@ -83,10 +83,10 @@ 
             if stats:
                 try:
-                    events = stats_data.get("events", {}).get("events", [])
+                    events = stats_data.await await get("events", {}).get("events", [])
                     for event in events:
-                        card_type = event.get("card")
-                        team_type = event.get("teamType", "")  # home/away
+                        card_type = event.await get("card")
+                        team_type = event.await get("teamType", "")  # home/away
 
                         if card_type == "Yellow":
                             yellow_cards[team_type] += 1
@@ -113,8 +113,8 @@                         lineups_data = lineups
 
                     # ä¸»é˜Ÿæ•°æ®
-                    home_team = lineups_data.get("homeTeam", {})
-                    away_team = lineups_data.get("awayTeam", {})
+                    home_team = lineups_data.await get("homeTeam", {})
+                    away_team = lineups_data.await get("awayTeam", {})
 
                     # ä¸»é˜Ÿè¯„åˆ†
                     if "rating" in home_team:
@@ -127,21 +127,21 @@                         print(f"â­ å®¢é˜Ÿè¯„åˆ†: {away_team_rating}")
 
                     # è®¡ç®—é¦–å‘çƒå‘˜å¹³å‡è¯„åˆ†
-                    home_starters = home_team.get("starters", [])
-                    away_starters = away_team.get("starters", [])
+                    home_starters = home_team.await get("starters", [])
+                    away_starters = away_team.await get("starters", [])
 
                     home_player_ratings = []
                     away_player_ratings = []
 
                     for player in home_starters:
                         if isinstance(player, dict) and "performance" in player:
-                            rating = player["performance"].get("rating", 0)
+                            rating = player["performance"].await get("rating", 0)
                             if rating:
                                 home_player_ratings.append(float(rating))
 
                     for player in away_starters:
                         if isinstance(player, dict) and "performance" in player:
-                            rating = player["performance"].get("rating", 0)
+                            rating = player["performance"].await get("rating", 0)
                             if rating:
                                 away_player_ratings.append(float(rating))
 
@@ -167,21 +167,21 @@             # 4. æå–æ¯”èµ›ç¯å¢ƒä¿¡æ¯
             if stats:
                 try:
-                    info_box = stats_data.get("infoBox", {})
+                    info_box = stats_data.await get("infoBox", {})
                     if isinstance(info_box, dict):
-                        stadium = info_box.get("Stadium", {})
-                        attendance = info_box.get("Attendance", 0)
-                        referee = info_box.get("Referee", {})
+                        stadium = info_box.await get("Stadium", {})
+                        attendance = info_box.await get("Attendance", 0)
+                        referee = info_box.await get("Referee", {})
 
                         if stadium:
-                            stadium_name = stadium.get("name", "Unknown")
+                            stadium_name = stadium.await get("name", "Unknown")
                             print(f"ğŸŸï¸  ä½“è‚²åœº: {stadium_name}")
 
                         if attendance:
                             print(f"ğŸ‘¥ ä¸Šåº§ç‡: {attendance:,}")
 
                         if referee:
-                            referee_name = referee.get("text", "Unknown")
+                            referee_name = referee.await get("text", "Unknown")
                             print(f"ğŸ‘¨â€âš–ï¸  è£åˆ¤: {referee_name}")
 
                 except Exception as e:
