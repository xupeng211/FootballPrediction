# Repository Guidelines

## Project Structure & Module Organization
- `src/` contains runtime modules: `api` for FastAPI endpoints, `core` for domain logic, `services` and `tasks` for orchestration, `database` for SQLAlchemy models, plus `utils` for shared helpers.
- `tests/` mirrors the runtime layout with `unit/`, `integration/`, `e2e/`, and monitoring suites; reusable fixtures live under `tests/fixtures`.
- Supporting assets include `scripts/` for automation, `docs/` for deep-dives, `data/` and `models/` for sample datasets and trained artefacts, and environment templates in `env.template`/`env.example`.

## Build, Test, and Development Commands
- `make venv` then `make install` bootstraps dependencies inside `.venv`.
- `make fmt` applies Black and isort; `make lint` runs flake8 plus mypy checks.
- `make test` executes the full pytest suite; `make coverage` enforces 80% coverage with pytest-cov.
- Use `make coverage-fast` for unit-only feedback or `make context` when you need an autogenerated project summary.

## Coding Style & Naming Conventions
- Target Python 3.10+, four-space indents, and 88-character lines (per `setup.cfg`).
- Modules and functions stay `snake_case`, classes `PascalCase`, constants `UPPER_SNAKE_CASE`.
- Add type hints and docstrings for APIs, services, and tasks; align Pydantic schemas with responses defined in `src/api`.
- Run `make fmt` and resolve lint warnings locally before opening a pull request.

## Testing Guidelines
- Pytest is configured via `pytest.ini`; store tests as `test_*.py` and apply markers such as `@pytest.mark.unit`, `integration`, or `e2e`.
- Cover new logic with unit tests and extend integration suites when touching database, streaming, or monitoring flows.
- Maintain ≥80% coverage (`make coverage`) and record regression cases in `tests/monitoring` for alert lifecycles.
- Reuse fixtures in `tests/fixtures` and synthetic data in `data/`—avoid production snapshots.

## Commit & Pull Request Guidelines
- Follow Conventional Commit prefixes observed here (`feat:`, `fix:`, `style:`); keep subjects ≤72 characters and explain rationale plus tests in the body.
- Reference Jira/GitHub items in the footer when relevant (e.g., `Refs: FP-123`).
- Pull requests should summarise the change, list executed commands, attach screenshots or logs for API/monitoring updates, and flag schema migrations.
- Ensure CI pipelines finish cleanly before requesting review or merge.

## Security & Configuration Notes
- Never commit secrets; base configuration on `env.template` or `env.example` and inject sensitive values via deployment tooling.
- Review `docker-compose*.yml` before running services locally; when ports or hosts change, update `nginx/` and monitoring scripts under `monitoring/` accordingly.
