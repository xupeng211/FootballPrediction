# 安全风险接受与豁免依赖管理

## 📅 文档版本
- 版本: 1.0
- 创建日期: 2025-10-02
- 最后更新: 2025-10-02
- 审核人: 安全团队
- 批准人: 项目负责人

## 📋 概述

本文档记录项目中已知的安全风险、已接受的风险以及相关的缓解措施。所有豁免的依赖都必须经过严格的风险评估并获得适当级别的批准。

## ⚠️ 已知漏洞与风险评估

### 1. MLflow 反序列化漏洞 (CVE-2024-37059)

#### 漏洞详情
- **包名**: mlflow
- **当前版本**: 3.4.0
- **漏洞ID**: GHSA-wf7f-8fxf-xfxc / CVE-2024-37059
- **严重性**: 高危 (CVSS: 9.8)
- **漏洞描述**: Deserialization of untrusted data can occur in versions of the MLflow platform running version 0.5.0 or newer, enabling a maliciously uploaded PyTorch model to run arbitrary code on an end user's system when interacted with.

#### 风险评估
- **影响范围**: 远程代码执行 (RCE)
- **攻击向量**: 恶意模型上传
- **利用难度**: 中等
- **影响**: 系统完全妥协

#### 接受理由
1. **业务必要性**: MLflow 是核心 MLOps 平台，用于模型版本管理和实验跟踪
2. **暂无替代**: 目前没有合适的替代方案可以直接替换
3. **使用场景受限**: 仅在内部环境使用，不直接暴露于公网
4. **访问控制**: 实施了严格的访问控制和审计日志

#### 缓解措施
1. **访问控制**:
   - 仅授权用户可以上传模型
   - 实施模型审核流程
   - 定期审查访问权限

2. **网络安全**:
   - MLflow 服务器部署在内部网络
   - 通过 VPN 访问
   - 网络隔离和防火墙规则

3. **监控与审计**:
   - 启用详细的操作日志
   - 实时监控异常行为
   - 定期安全审计

4. **模型验证**:
   - 实施模型沙箱化
   - 模型上传前进行静态分析
   - 限制模型来源

#### 监控指标
- 模型上传次数和来源
- 异常访问尝试
- 系统资源使用情况
- 潜在的代码执行迹象

#### 计划行动
1. **短期** (1-3个月):
   - 评估 MLflow 替代方案 (DVC, Weights & Biases)
   - 增强模型验证机制
   - 实施更严格的访问控制

2. **中期** (3-6个月):
   - 开发模型沙箱环境
   - 实施零信任架构
   - 考虑自研模型管理系统

3. **长期** (6-12个月):
   - 迁移到更安全的 MLOps 平台
   - 实施完整的供应链安全
   - 建立漏洞管理流程

### 2. pip 提取路径漏洞 (CVE-2025-8869)

#### 漏洞详情
- **包名**: pip
- **当前版本**: 25.2
- **漏洞ID**: GHSA-4xh5-x5gv-qwph / CVE-2025-8869
- **严重性**: 中危 (CVSS: 6.5)
- **漏洞描述**: In the fallback extraction path for source distributions, pip used Python's tarfile module without verifying that symbolic/hard link targets resolve inside the intended extraction directory

#### 风险评估
- **影响**: 任意文件覆盖
- **攻击向量**: 恶意源码包
- **利用难度**: 高
- **状态**: 已在当前版本修复

#### 接受理由
- 漏洞已在 pip 25.2 中修复
- 当前版本包含修复补丁
- 无需额外行动

## 🔄 豁免依赖管理流程

### 新依赖豁免流程

1. **风险评估**:
   - 识别安全漏洞
   - 评估业务影响
   - 确定风险等级

2. **缓解措施**:
   - 制定安全控制措施
   - 实施监控方案
   - 建立应急响应计划

3. **审批流程**:
   - 技术负责人审核
   - 安全团队评估
   - 项目负责人批准

4. **文档记录**:
   - 更新本文档
   - 记录决策过程
   - 设置复查日期

### 定期复查机制

1. **每月**:
   - 检查新的安全漏洞
   - 更新漏洞信息
   - 评估缓解措施有效性

2. **每季度**:
   - 全面风险评估
   - 更新缓解措施
   - 审查豁免必要性

3. **每年**:
   - 重新评估所有豁免
   - 更新安全策略
   - 制定长期计划

## 📊 风险矩阵

| 依赖 | 漏洞严重性 | 业务影响 | 风险等级 | 状态 |
|------|------------|----------|----------|------|
| mlflow | 高 | 关键 | 高 | 监控中 |
| pip | 中 | 低 | 低 | 已修复 |

## 🚀 应急响应计划

### 漏洞被利用时的响应

1. **立即行动**:
   - 隔离受影响系统
   - 停止相关服务
   - 通知安全团队

2. **调查与分析**:
   - 确定影响范围
   - 收集证据
   - 分析攻击路径

3. **恢复**:
   - 应用补丁
   - 恢复服务
   - 加强监控

4. **事后分析**:
   - 编写事件报告
   - 更新安全策略
   - 改进防护措施

## 📞 联系信息

- **安全团队**: security@company.com
- **项目负责人**: project-owner@company.com
- **紧急联系**: +86-xxx-xxxx-xxxx

## 📚 相关文档

- [依赖漏洞报告](docs/_reports/DEPENDENCY_VULNERABILITY_REPORT.md)
- [安全策略](docs/ops/SECURITY_POLICY.md)
- [CI/CD 安全指南](docs/ops/CI_CD_SECURITY.md)
- [事件响应计划](docs/ops/INCIDENT_RESPONSE.md)

## 📝 变更记录

| 日期 | 版本 | 变更内容 | 作者 |
|------|------|----------|------|
| 2025-10-02 | 1.0 | 初始版本，记录 mlflow 和 pip 漏洞 | Claude |

---

**注意**: 本文档需要定期更新以反映最新的安全状况。任何安全相关变更都应立即更新本文档。