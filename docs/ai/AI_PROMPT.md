# 🤖 FootballPrediction AI工作提示

## 📋 项目概览

**FootballPrediction** 是一个基于现代Python技术栈的企业级足球预测系统。本项目采用FastAPI作为Web框架，遵循现代Python开发最佳实践。

### 🎯 **核心目标**

- 提供高质量的AI文化分析工具
- 维护清晰的项目架构和代码规范
- 确保所有组件具备完整的测试覆盖
- 支持持续集成和自动化部署

---

## 🔧 **开发环境**

### 技术栈

- **Python 3.11+** - 核心开发语言
- **FastAPI** - Web应用框架
- **Pydantic** - 数据验证和序列化
- **Pytest** - 单元测试框架
- **Black + Flake8** - 代码格式化和检查
- **MyPy** - 静态类型检查

### 项目结构

```
src/                    # 源代码目录
├── core/              # 核心业务逻辑
├── services/          # 服务层
├── utils/             # 工具函数
└── main.py            # 应用入口

tests/                 # 测试代码
scripts/               # 辅助脚本
docs/                  # 项目文档
rules/                 # 开发规范 ⭐
```

---

## 🎯 **AI工作指南**

### 1. **环境准备**

在开始任何代码生成或修改前，**必须先启动虚拟环境**：

#### 🌐 **虚拟环境启动（必须步骤）**

```bash
# Linux/Mac环境
source venv/bin/activate

# Windows环境
venv\Scripts\activate

# 验证虚拟环境已启动
which python    # 应该显示项目venv目录下的python路径
python --version # 应该显示Python 3.11+
```

#### 📋 **环境检查清单**

在开始开发工作前，请确认：

- 📖 **阅读开发规则** - 查看 [`rules/README.md`](rules/README.md) 了解完整开发规范
- 🌐 **激活虚拟环境** - 确保使用项目专用的Python环境
- 🔍 **理解项目结构** - 分析现有代码组织方式
- 🧪 **运行环境验证** - 执行 `make env-check` 确保环境状态正常

### 2. **代码生成规范**

生成的所有代码必须遵循：

- ✅ **包含完整的类型注解和文档字符串**
- ✅ **遵循现有项目的模块结构**
- ✅ **所有生成的代码必须带简明的中文注释，注释应解释模块/函数的用途与核心逻辑，而不是逐行翻译语法**

### 3. **质量保证**

每次代码修改后必须：

- 🔧 **代码格式化** - 使用Black自动格式化
- 🔍 **静态检查** - 通过Flake8和MyPy检查
- 🧪 **单元测试** - 新功能必须包含测试用例
- 📊 **覆盖率检查** - 确保测试覆盖率≥80%

### 4. **文档同步**

代码变更时同步更新：

- 📝 **函数文档字符串** - 使用Google风格
- 📋 **README和API文档** - 保持信息准确性
- 🔄 **版本变更日志** - 记录重要修改

---

## ⚡ **AI工作流程（工具优先模式）**

### 🚀 **标准AI开发启动序列**

```bash
# 🎯 AI工作必须严格按此顺序执行：

# 第1步：环境检查
make env-check          # 验证开发环境完整性

# 第2步：加载项目上下文（⭐ 关键步骤）
make context            # AI必须运行此命令获取项目上下文

# 第3步：根据任务选择适当工具
make quality            # 代码质量全面检查
make test              # 运行单元测试
make ci                # 本地CI完整模拟
make prepush           # 提交前完整验证

# ⚠️ 禁止直接运行python脚本，必须通过Makefile工具链
```

### 📋 **AI任务执行原则**

1. **工具优先**：任何操作必须通过`make`命令执行
2. **上下文优先**：每次开始工作前运行`make context`
3. **质量优先**：代码变更必须通过`make ci`验证
4. **完整流程**：提交前使用`make prepush`完整检查

```

### 🔧 **常用Makefile命令速览**
```bash
make help              # 查看所有可用命令和说明
make env-check         # 环境健康检查
make context           # 加载项目上下文（AI必须使用）
make quality           # 完整代码质量检查
make test              # 运行单元测试
make coverage          # 测试覆盖率检查
make ci                # 本地CI完整模拟
make prepush           # 提交前完整验证流程
make clean             # 清理临时文件和缓存
```

### ⚡ **AI专用工作模式**

- **启动前**：必须运行`make context`获取项目上下文
- **开发中**：使用`make quality`持续检查代码质量
- **测试时**：使用`make test`验证功能正确性
- **提交前**：使用`make prepush`进行完整验证

---

## 🚨 **重要约束**

### 必须遵守的规则

1. **🌐 虚拟环境** - 所有开发工作必须在激活的虚拟环境中进行
2. **📁 目录结构** - 严格遵循既定的项目结构
3. **🧪 测试要求** - 所有新功能必须包含单元测试
4. **📝 代码注释** - 复杂逻辑必须有中文解释注释
5. **🔧 工具链** - 使用Makefile统一执行所有操作
6. **🔒 质量门禁** - 所有检查必须通过才能提交

### 严格禁止的行为

- ❌ **环境混用** - 不允许在全局Python环境中开发，必须使用虚拟环境
- ❌ **跳过测试** - 不允许提交未测试的代码
- ❌ **硬编码** - 不允许硬编码敏感信息或配置
- ❌ **格式混乱** - 不允许提交未格式化的代码
- ❌ **结构破坏** - 不允许破坏既定的目录结构
- ❌ **工具绕过** - 不允许绕过预设的检查工具

---

## 🎨 **代码风格示例**

### 函数定义标准

```python
def process_user_data(
    user_id: int,
    data: Dict[str, Any],
    validate: bool = True
) -> Optional[Dict[str, Any]]:
    """
    处理用户数据 - 验证、清洗和转换用户输入的数据

    这个函数负责对用户提交的数据进行全面处理，包括格式验证、
    数据清洗和必要的类型转换，确保数据质量符合业务要求。

    Args:
        user_id: 用户标识符，用于日志记录和权限验证
        data: 待处理的原始数据字典，包含用户输入的所有字段
        validate: 是否启用数据验证，默认启用以保障数据质量

    Returns:
        处理成功返回清洗后的数据字典，失败返回None

    Raises:
        ValidationError: 当数据验证失败时
        ProcessingError: 当数据处理过程出错时
    """
    if validate:
        # 数据验证逻辑 - 检查必填字段和数据类型
        _validate_user_data(data)

    # 数据清洗逻辑 - 移除空值，标准化格式
    cleaned_data = _clean_data(data)

    return cleaned_data
```

### 类定义标准

```python
class UserService:
    """
    用户服务类 - 封装用户相关的核心业务逻辑

    负责用户信息的管理、验证和业务规则的实施，
    提供统一的用户操作接口供上层应用调用。
    """

    def __init__(self, config: Config, logger: Logger):
        """
        初始化用户服务 - 设置配置参数和日志记录器

        Args:
            config: 应用配置对象，包含数据库和缓存设置
            logger: 日志记录器，用于记录服务运行状态
        """
        self.config = config
        self.logger = logger
        self._cache = {}  # 用户信息缓存，提升查询性能
```

---

## 📚 **参考资源**

### 项目文档

- 📋 **[开发规范总览](rules/README.md)** - 完整的开发规则和检查清单
- 🎨 **[代码风格指南](rules/coding.md)** - 详细的代码规范和示例
- 🔄 **[Git工作流程](rules/git.md)** - 版本控制和提交规范
- 🧪 **[测试规范](rules/testing.md)** - 测试编写和覆盖率要求
- 📝 **[文档规范](rules/documentation.md)** - 文档编写和维护标准

### 质量工具

- **Black** - Python代码自动格式化
- **Flake8** - 代码风格和错误检查
- **MyPy** - 静态类型检查
- **Pytest** - 单元测试框架
- **Coverage** - 测试覆盖率分析

---

## 🔄 **持续改进**

本提示文档会根据项目发展持续更新。如发现规范冲突或需要澄清的地方，请：

1. 🔍 **查阅详细规范** - 参考rules目录下的具体文档
2. 🧪 **验证实际行为** - 运行相关的检查工具确认
3. 📝 **更新文档** - 及时同步修改相关文档
4. 🤝 **团队讨论** - 重大变更需要团队评审

---

*遵循这些指南能确保代码质量和项目的长期可维护性。记住：质量优于速度，规范胜过灵活。*
