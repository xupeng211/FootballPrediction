name: Docs Guard

on:
  pull_request:
    paths:
      - 'docs/**'
  push:
    paths:
      - 'docs/**'

jobs:
  guard:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      - name: Run Docs Guard
        run: |
          echo "ğŸ›¡ï¸ Running Docs Guard checks..."
          set +e
          python scripts/docs_guard.py
          STATUS=$?
          set -e

          if [ $STATUS -ne 0 ]; then
            echo ""
            echo -e "\033[31mâŒ Docs Guard æ£€æŸ¥å¤±è´¥ï¼\033[0m"
            echo -e "\033[33mè¯·åœ¨æœ¬åœ°è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥ä¿®å¤é—®é¢˜ï¼š\033[0m"
            echo ""
            echo "   make docs.check"
            echo ""
            echo -e "\033[33må¦‚æœå­˜åœ¨å­¤å„¿æ–‡æ¡£ï¼Œå¯å°è¯•è‡ªåŠ¨ä¿®å¤ï¼š\033[0m"
            echo ""
            echo "   make docs.fix"
            echo ""
            echo -e "\033[36mæç¤ºï¼šæ‰€æœ‰æ–‡æ¡£å¿…é¡»æ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š\033[0m"
            echo "- æ²¡æœ‰åé“¾ (broken links)"
            echo "- æ²¡æœ‰å­¤å„¿æ–‡æ¡£ (orphan docs)"
            echo "- æ²¡æœ‰è¿è§„ç›®å½• (invalid directories)"
            echo "- æ‰€æœ‰æ–°å¢æ–‡æ¡£å¿…é¡»åŠ å…¥ INDEX.md"
            echo ""
            exit 1
          else
            echo -e "\033[32mâœ… Docs Guard æ£€æŸ¥é€šè¿‡ï¼\033[0m"
          fi
