# MLOps每日数据管道 - Crontab配置
# 每天凌晨4点自动执行完整的ML数据处理管道

# 设置环境变量
SHELL=/bin/bash
PATH=/usr/local/bin:/usr/bin:/bin
PYTHONPATH=/home/user/projects/FootballPrediction:/home/user/miniconda3/bin
PROJECT_DIR=/home/user/projects/FootballPrediction

# 每天凌晨4点执行管道
0 4 * * * cd $PROJECT_DIR && /usr/bin/python3 scripts/run_daily_pipeline.py >> logs/cron_pipeline.log 2>&1

# 每周一凌晨5点进行模型重训练（可选）
0 5 * * 1 cd $PROJECT_DIR && /usr/bin/python3 src/models/train_v1_xgboost.py >> logs/cron_training.log 2>&1

# 每天凌晨6点清理旧日志（保留最近7天）
0 6 * * * find $PROJECT_DIR/logs -name "*.log" -mtime +7 -delete

# 每月1号清理旧训练集（保留最近3个月）
0 7 1 * * find $PROJECT_DIR/data/training_sets -name "training_set_v1_*.csv" -mtime +90 -delete
