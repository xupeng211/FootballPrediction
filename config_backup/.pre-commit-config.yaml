# ðŸš€ Pre-commit hooks configuration for Football Prediction project
# Shift-left strategy: Catch issues before they reach CI

repos:
  # Basic code quality checks
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      # Remove trailing whitespace
      - id: trailing-whitespace
        description: Remove trailing whitespace from all files
        exclude_types: [svg]

      # Ensure files end with newline
      - id: end-of-file-fixer
        description: Ensure files end with a newline character

      # Check YAML syntax
      - id: check-yaml
        description: Check YAML files for syntax errors
        args: ['--unsafe']  # Allows custom tags

      # Check for large files (>1MB)
      - id: check-added-large-files
        description: Prevent large files from being committed
        args: ['--maxkb=1024']  # 1MB limit

      # Check for merge conflict markers
      - id: check-merge-conflict
        description: Check for merge conflict markers

      # Check JSON syntax
      - id: check-json
        description: Check JSON files for syntax errors

      # Check TOML syntax
      - id: check-toml
        description: Check TOML files for syntax errors

      # Prevent committing to main branch directly
      - id: no-commit-to-branch
        description: Prevent direct commits to main branch
        args: [--branch, main, --branch, master]

  # Python code formatting and linting with Ruff
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.1.8
    hooks:
      # Run Ruff formatter (like black)
      - id: ruff-format
        description: Format Python code with Ruff formatter
        args: [--line-length=88]

      # Run Ruff linter (like flake8, isort, etc.)
      - id: ruff
        description: Lint Python code with Ruff
        args:
          - --fix  # Auto-fix fixable issues
          - --extend-select=E,F,W,I,UP,B,A,C4,T20  # Common rule sets
          - --extend-ignore=E501,F841  # Line length and unused variable (temporary)

# Pre-commit configuration
default_stages: [commit]  # Run on commit (can also add pre-push)
fail_fast: false  # Continue running hooks even if one fails
default_language_version:
  python: python3  # Use Python 3 for all Python hooks

# Additional configuration for specific file types
exclude: |
  (?x)^(
    .*\.min\.(js|css)$          # Minified files
    | vendor/.*                  # Vendor dependencies
    | \.git/.*                   # Git files
    | \.venv/.*                  # Virtual environment
    | \.tox/.*                   # Tox environment
    | __pycache__/.*             # Python cache
    | \.pytest_cache/.*          # Pytest cache
    | htmlcov/.*                 # Coverage reports
    | build/.*                   # Build artifacts
    | dist/.*                    # Distribution files
    | .*\.egg-info/.*            # Egg metadata
  )$
