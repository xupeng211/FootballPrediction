# ğŸ—ï¸ CIä¸“ç”¨Dockerfile - å®Œå…¨éš”ç¦»çš„æµ‹è¯•ç¯å¢ƒ
FROM python:3.11-slim

# è®¾ç½®ç¯å¢ƒå˜é‡
ENV PYTHONUNBUFFERED=1 \
    PYTHONDONTWRITEBYTECODE=1 \
    PIP_NO_CACHE_DIR=1

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# å¤åˆ¶requirementsæ–‡ä»¶
COPY requirements.txt requirements-ci.txt ./

# å®‰è£…æ ¸å¿ƒä¾èµ–
RUN pip install --upgrade pip && \
    pip install -r requirements-ci.txt

# å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=10s --start-period=30s --retries=3 \
    CMD python -c "import sys; exit(0)" || exit 1

# è®¾ç½®é»˜è®¤å‘½ä»¤ï¼ˆå°†è¢«docker-compose.ymlè¦†ç›–ï¼‰
CMD ["/bin/bash"]