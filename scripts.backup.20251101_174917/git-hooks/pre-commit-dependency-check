#!/bin/bash
# Pre-commit hook: æ£€æŸ¥ä¾èµ–å˜æ›´å¹¶æé†’AIå·¥å…·

echo "ğŸ” æ£€æŸ¥ä¾èµ–å˜æ›´..."

# è¿è¡Œä¾èµ–æ£€æŸ¥è„šæœ¬
python scripts/dependency/check_changes.py

# æ£€æŸ¥æ˜¯å¦æœ‰æœªé”å®šçš„ä¾èµ–å˜æ›´
if git diff --cached --name-only | grep -q "requirements.*\.in$"; then
    # æ£€æŸ¥æ˜¯å¦æœ‰å¯¹åº”çš„lockæ–‡ä»¶
    if ! git diff --cached --name-only | grep -q "requirements.*\.lock$"; then
        echo ""
        echo "âš ï¸  è­¦å‘Šï¼šæ£€æµ‹åˆ°.inæ–‡ä»¶å˜æ›´ä½†æœªç”Ÿæˆå¯¹åº”çš„.lockæ–‡ä»¶"
        echo "   è¯·è¿è¡Œ 'make lock-deps' å¹¶æäº¤ç”Ÿæˆçš„lockæ–‡ä»¶"
        echo ""
        echo "ğŸ’¡ æç¤ºï¼šé˜…è¯» CLAUDE.md äº†è§£æ­£ç¡®çš„ä¾èµ–ç®¡ç†æµç¨‹"
    fi
fi
