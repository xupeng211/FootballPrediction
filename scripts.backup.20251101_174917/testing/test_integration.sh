#!/usr/bin/env bash
# è¶³çƒé¢„æµ‹é¡¹ç›® - ä»…è¿è¡Œé›†æˆæµ‹è¯•
# è¯¥è„šæœ¬åªè¿è¡Œæ ‡è®°ä¸º integration çš„æµ‹è¯•

set -e  # é‡åˆ°é”™è¯¯æ—¶ç«‹å³é€€å‡º

echo "ğŸ”— å¼€å§‹è¿è¡Œè¶³çƒé¢„æµ‹é¡¹ç›®é›†æˆæµ‹è¯•..."
echo "========================================"

# ä»…è¿è¡Œé›†æˆæµ‹è¯•
echo "ğŸ“Š è¿è¡Œé›†æˆæµ‹è¯•ï¼ˆæœ‰å¤–éƒ¨ä¾èµ–ï¼‰..."
pytest tests/ \
    -m integration \
    --cov=src \
    --cov-report=term-missing:skip-covered \
    --cov-report=html:htmlcov_integration \
    -v

echo "========================================"
echo "âœ… é›†æˆæµ‹è¯•å®Œæˆï¼"
echo "ğŸ“ˆ è¦†ç›–ç‡æŠ¥å‘Šå·²ç”Ÿæˆåœ¨ htmlcov_integration/ ç›®å½•ä¸­"
