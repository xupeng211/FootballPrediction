
<!doctype html>
<html lang="zh" class="no-js">
  <head>

      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">

        <meta name="description" content="åŸºäºç°ä»£PythonæŠ€æœ¯æ ˆçš„è¶³çƒé¢„æµ‹ç³»ç»Ÿå®Œæ•´æ–‡æ¡£">


        <meta name="author" content="Football Prediction Team">


        <link rel="canonical" href="https://football-prediction-docs.example.com/architecture/architecture/">




      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">



        <title>è¶³çƒæ¯”èµ›ç»“æœé¢„æµ‹ç³»ç»Ÿ - ç³»ç»Ÿæ¶æ„æ–‡æ¡£ - è¶³çƒé¢„æµ‹ç³»ç»Ÿæ–‡æ¡£</title>



      <link rel="stylesheet" href="../../assets/stylesheets/main.6f8fc17f.min.css">


        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">












        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>



    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>






  <meta property="og:type" content="website">
  <meta property="og:title" content="è¶³çƒé¢„æµ‹ç³»ç»Ÿæ–‡æ¡£">
  <meta property="og:description" content="åŸºäºç°ä»£PythonæŠ€æœ¯æ ˆçš„è¶³çƒé¢„æµ‹ç³»ç»Ÿå®Œæ•´æ–‡æ¡£">
  <meta property="og:url" content="https://football-prediction-docs.example.com/architecture/architecture/">
  <meta property="og:image" content="../../assets/logo.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@football_pred">
  <meta name="twitter:creator" content="@football_pred">

  <!-- è‡ªå®šä¹‰CSSå’ŒJS -->
  <link rel="stylesheet" href="../../assets/extra.css">
  <script src="../../assets/extra.js"></script>

  <!-- æ·»åŠ ä¸­æ–‡å­—ä½“æ”¯æŒ -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">



  </head>









    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">


    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">


        <a href="#-" class="md-skip">
          è·³è½¬è‡³
        </a>

    </div>
    <div data-md-component="announce">

    </div>







<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="é¡µçœ‰">
    <a href="../.." title="è¶³çƒé¢„æµ‹ç³»ç»Ÿæ–‡æ¡£" class="md-header__button md-logo" aria-label="è¶³çƒé¢„æµ‹ç³»ç»Ÿæ–‡æ¡£" data-md-component="logo">

  <img src="../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">

      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            è¶³çƒé¢„æµ‹ç³»ç»Ÿæ–‡æ¡£
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">

              è¶³çƒæ¯”èµ›ç»“æœé¢„æµ‹ç³»ç»Ÿ - ç³»ç»Ÿæ¶æ„æ–‡æ¡£

          </span>
        </div>
      </div>
    </div>


        <form class="md-header__option" data-md-component="palette">




    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="åˆ‡æ¢è‡³æ·±è‰²æ¨¡å¼"  type="radio" name="__palette" id="__palette_0">

      <label class="md-header__button md-icon" title="åˆ‡æ¢è‡³æ·±è‰²æ¨¡å¼" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>





    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="åˆ‡æ¢è‡³æ·±è‰²æ¨¡å¼"  type="radio" name="__palette" id="__palette_1">

      <label class="md-header__button md-icon" title="åˆ‡æ¢è‡³æ·±è‰²æ¨¡å¼" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>





    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="åˆ‡æ¢è‡³æµ…è‰²æ¨¡å¼"  type="radio" name="__palette" id="__palette_2">

      <label class="md-header__button md-icon" title="åˆ‡æ¢è‡³æµ…è‰²æ¨¡å¼" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>


</form>



      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>



      <label class="md-header__button md-icon" for="__search">

        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="æœç´¢" placeholder="æœç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">

        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>

        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="æŸ¥æ‰¾">

          <a href="javascript:void(0)" class="md-search__icon md-icon" title="åˆ†äº«" aria-label="åˆ†äº«" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">

            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>

        <button type="reset" class="md-search__icon md-icon" title="æ¸…ç©ºå½“å‰å†…å®¹" aria-label="æ¸…ç©ºå½“å‰å†…å®¹" tabindex="-1">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>

        <div class="md-search__suggest" data-md-component="search-suggest"></div>

    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            æ­£åœ¨åˆå§‹åŒ–æœç´¢å¼•æ“
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>


      <div class="md-header__source">
        <a href="https://github.com/your-org/football-prediction" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">

    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    football-prediction/docs
  </div>
</a>
      </div>

  </nav>



<nav class="md-tabs" aria-label="æ ‡ç­¾" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">





    <li class="md-tabs__item">
      <a href="../../index.md" class="md-tabs__link">




  é¦–é¡µ

      </a>
    </li>









      <li class="md-tabs__item">
        <a href="../../how-to/QUICKSTART_TOOLS/" class="md-tabs__link">




  å¿«é€Ÿå¼€å§‹

        </a>
      </li>










      <li class="md-tabs__item">
        <a href="../ARCHITECTURE/" class="md-tabs__link">




  æ¶æ„è®¾è®¡

        </a>
      </li>










      <li class="md-tabs__item">
        <a href="../../reference/API_REFERENCE/" class="md-tabs__link">




  APIå‚è€ƒ

        </a>
      </li>










      <li class="md-tabs__item">
        <a href="../../testing/TEST_IMPROVEMENT_GUIDE/" class="md-tabs__link">




  æµ‹è¯•æŒ‡å—

        </a>
      </li>










      <li class="md-tabs__item">
        <a href="../../ops/PRODUCTION_READINESS_PLAN/" class="md-tabs__link">




  è¿ç»´éƒ¨ç½²

        </a>
      </li>










      <li class="md-tabs__item">
        <a href="../../ml/ML_MODEL_GUIDE/" class="md-tabs__link">




  æœºå™¨å­¦ä¹ 

        </a>
      </li>










      <li class="md-tabs__item">
        <a href="../../security/SECURITY_POLICY.md" class="md-tabs__link">




  å®‰å…¨é…ç½®

        </a>
      </li>










      <li class="md-tabs__item">
        <a href="../../project/CONTRIBUTING.md" class="md-tabs__link">




  é¡¹ç›®ç®¡ç†

        </a>
      </li>










      <li class="md-tabs__item">
        <a href="../../AI_DEVELOPMENT_DOCUMENTATION_RULES.md" class="md-tabs__link">




  å‚è€ƒèµ„æ–™

        </a>
      </li>




    </ul>
  </div>
</nav>


</header>


  <!-- å…¬å‘Šæ é…ç½® (æš‚æ—¶æ³¨é‡Šæ‰) -->
  <!--

  -->

    <div class="md-container" data-md-component="container">




      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">



              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">








<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="å¯¼èˆªæ " data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="è¶³çƒé¢„æµ‹ç³»ç»Ÿæ–‡æ¡£" class="md-nav__button md-logo" aria-label="è¶³çƒé¢„æµ‹ç³»ç»Ÿæ–‡æ¡£" data-md-component="logo">

  <img src="../../assets/logo.png" alt="logo">

    </a>
    è¶³çƒé¢„æµ‹ç³»ç»Ÿæ–‡æ¡£
  </label>

    <div class="md-nav__source">
      <a href="https://github.com/your-org/football-prediction" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">

    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    football-prediction/docs
  </div>
</a>
    </div>

  <ul class="md-nav__list" data-md-scrollfix>







    <li class="md-nav__item">
      <a href="../../index.md" class="md-nav__link">


  <span class="md-ellipsis">
    é¦–é¡µ
  </span>


      </a>
    </li>



































    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">




    <a href="../../how-to/QUICKSTART_TOOLS/" class="md-nav__link">


  <span class="md-ellipsis">
    å¿«é€Ÿå¼€å§‹
  </span>



        <span class="md-nav__icon md-icon"></span>

    </a>



    </li>



































    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">




    <a href="../ARCHITECTURE/" class="md-nav__link">


  <span class="md-ellipsis">
    æ¶æ„è®¾è®¡
  </span>



        <span class="md-nav__icon md-icon"></span>

    </a>



    </li>





































    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">




    <a href="../../reference/API_REFERENCE/" class="md-nav__link">


  <span class="md-ellipsis">
    APIå‚è€ƒ
  </span>



        <span class="md-nav__icon md-icon"></span>

    </a>



    </li>







































    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">




    <a href="../../testing/TEST_IMPROVEMENT_GUIDE/" class="md-nav__link">


  <span class="md-ellipsis">
    æµ‹è¯•æŒ‡å—
  </span>



        <span class="md-nav__icon md-icon"></span>

    </a>



    </li>





































    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">




    <a href="../../ops/PRODUCTION_READINESS_PLAN/" class="md-nav__link">


  <span class="md-ellipsis">
    è¿ç»´éƒ¨ç½²
  </span>



        <span class="md-nav__icon md-icon"></span>

    </a>



    </li>

































    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">




    <a href="../../ml/ML_MODEL_GUIDE/" class="md-nav__link">


  <span class="md-ellipsis">
    æœºå™¨å­¦ä¹ 
  </span>



        <span class="md-nav__icon md-icon"></span>

    </a>



    </li>

































    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">




    <a href="../../security/SECURITY_POLICY.md" class="md-nav__link">


  <span class="md-ellipsis">
    å®‰å…¨é…ç½®
  </span>



        <span class="md-nav__icon md-icon"></span>

    </a>



    </li>

































    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">




    <a href="../../project/CONTRIBUTING.md" class="md-nav__link">


  <span class="md-ellipsis">
    é¡¹ç›®ç®¡ç†
  </span>



        <span class="md-nav__icon md-icon"></span>

    </a>



    </li>

































    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">




    <a href="../../AI_DEVELOPMENT_DOCUMENTATION_RULES.md" class="md-nav__link">


  <span class="md-ellipsis">
    å‚è€ƒèµ„æ–™
  </span>



        <span class="md-nav__icon md-icon"></span>

    </a>



    </li>



  </ul>
</nav>
                  </div>
                </div>
              </div>




            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">





    <a href="https://github.com/your-org/football-prediction/edit/main/docs/architecture/architecture.md" title="ç¼–è¾‘æ­¤é¡µ" class="md-content__button md-icon">

      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>





    <a href="https://github.com/your-org/football-prediction/raw/main/docs/architecture/architecture.md" title="æŸ¥çœ‹æœ¬é¡µçš„æºä»£ç " class="md-content__button md-icon">

      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>



<h1 id="-">è¶³çƒæ¯”èµ›ç»“æœé¢„æµ‹ç³»ç»Ÿ - ç³»ç»Ÿæ¶æ„æ–‡æ¡£<a class="headerlink" href="#-" title="Permanent link">&para;</a></h1>
<h2 id="_1">ğŸ“‹ ç›®å½•<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ">ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ</a></li>
<li><a href="#2-æ¨¡å—è®¾è®¡è¯´æ˜">æ¨¡å—è®¾è®¡è¯´æ˜</a></li>
<li><a href="#3-æ•°æ®åº“è®¾è®¡è‰æ¡ˆ">æ•°æ®åº“è®¾è®¡è‰æ¡ˆ</a></li>
<li><a href="#4-å¼€å‘é˜¶æ®µè§„åˆ’">å¼€å‘é˜¶æ®µè§„åˆ’</a></li>
<li><a href="#5-éƒ¨ç½²ä¸è¿ç»´æ¶æ„">éƒ¨ç½²ä¸è¿ç»´æ¶æ„</a></li>
<li><a href="#6-æœªæ¥æ‰©å±•å»ºè®®">æœªæ¥æ‰©å±•å»ºè®®</a></li>
</ol>
<hr />
<h2 id="1">1. ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 æ•´ä½“æ¶æ„å›¾<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>graph TB
    subgraph &quot;æ•°æ®æºå±‚&quot;
        A1[API-Football]
        A2[OddsPortal API]
        A3[å®˜æ–¹èµ›äº‹æ•°æ®]
        A4[ç¬¬ä¸‰æ–¹ä½“è‚²æ•°æ®]
    end

    subgraph &quot;æ•°æ®é‡‡é›†å±‚&quot;
        B1[Scrapyçˆ¬è™«å¼•æ“]
        B2[APIæ•°æ®é‡‡é›†å™¨]
        B3[å®æ—¶æ•°æ®åŒæ­¥]
        B4[æ•°æ®é‡‡é›†è°ƒåº¦å™¨]
    end

    subgraph &quot;æ•°æ®å¤„ç†å±‚&quot;
        C1[æ•°æ®æ¸…æ´—æ¨¡å—]
        C2[æ•°æ®éªŒè¯æ¨¡å—]
        C3[ç‰¹å¾å·¥ç¨‹å¼•æ“]
        C4[æ•°æ®å­˜å‚¨ç®¡ç†]
    end

    subgraph &quot;å­˜å‚¨å±‚&quot;
        D1[(MySQL/PostgreSQL&lt;br/&gt;ä¸»æ•°æ®åº“)]
        D2[(Redis&lt;br/&gt;ç¼“å­˜å±‚)]
        D3[(æ–‡ä»¶å­˜å‚¨&lt;br/&gt;æ¨¡å‹&amp;æ—¥å¿—)]
    end

    subgraph &quot;æœºå™¨å­¦ä¹ å±‚&quot;
        E1[XGBoostæ¨¡å‹]
        E2[LightGBMæ¨¡å‹]
        E3[æ¨¡å‹è®­ç»ƒå¼•æ“]
        E4[æ¨¡å‹è¯„ä¼°ç³»ç»Ÿ]
        E5[é¢„æµ‹æœåŠ¡å¼•æ“]
    end

    subgraph &quot;æœåŠ¡å±‚&quot;
        F1[FastAPIæœåŠ¡]
        F2[RESTful APIæ¥å£]
        F3[è®¤è¯æˆæƒæ¨¡å—]
        F4[ç›‘æ§å‘Šè­¦ç³»ç»Ÿ]
    end

    subgraph &quot;å‰ç«¯å±•ç¤ºå±‚&quot;
        G1[Vue.js/Reactå‰ç«¯]
        G2[EChartså¯è§†åŒ–]
        G3[å“åº”å¼UIç»„ä»¶]
        G4[å®æ—¶æ•°æ®å±•ç¤º]
    end

    subgraph &quot;éƒ¨ç½²å±‚&quot;
        H1[Dockerå®¹å™¨]
        H2[Kubernetesç¼–æ’]
        H3[è´Ÿè½½å‡è¡¡å™¨]
        H4[CI/CDæµæ°´çº¿]
    end

    A1 &amp; A2 &amp; A3 &amp; A4 --&gt; B1 &amp; B2 &amp; B3
    B1 &amp; B2 &amp; B3 --&gt; B4
    B4 --&gt; C1 &amp; C2
    C1 &amp; C2 --&gt; C3
    C3 --&gt; C4
    C4 --&gt; D1 &amp; D2 &amp; D3
    D1 --&gt; E1 &amp; E2 &amp; E3
    E3 --&gt; E4
    E1 &amp; E2 --&gt; E5
    E5 --&gt; F1
    F1 --&gt; F2 &amp; F3
    F2 --&gt; G1
    G1 --&gt; G2 &amp; G3 &amp; G4
    F1 --&gt; H1
    H1 --&gt; H2
    H2 --&gt; H3
    H4 --&gt; H1
</code></pre></div>
<h3 id="12">1.2 æ•°æ®æµè¯´æ˜<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<p>ç³»ç»Ÿé‡‡ç”¨ç»å…¸çš„æ•°æ®æµæ°´çº¿æ¶æ„ï¼Œæ•°æ®ä»é‡‡é›†åˆ°é¢„æµ‹å±•ç¤ºçš„å®Œæ•´é“¾è·¯å¦‚ä¸‹ï¼š</p>
<h4 id="_2">è¾“å…¥é˜¶æ®µ<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>å¤šæºæ•°æ®é‡‡é›†</strong>ï¼šé€šè¿‡APIå’Œçˆ¬è™«ä»å¤šä¸ªæ•°æ®æºï¼ˆAPI-Footballã€OddsPortalç­‰ï¼‰é‡‡é›†æ¯”èµ›æ•°æ®ã€çƒé˜Ÿä¿¡æ¯ã€å†å²æˆ˜ç»©ã€å®æ—¶èµ”ç‡ç­‰</li>
<li><strong>æ•°æ®æ ‡å‡†åŒ–</strong>ï¼šå°†ä¸åŒæ ¼å¼çš„æ•°æ®ç»Ÿä¸€è½¬æ¢ä¸ºæ ‡å‡†æ ¼å¼</li>
</ul>
<h4 id="_3">å¤„ç†é˜¶æ®µ<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>æ•°æ®æ¸…æ´—</strong>ï¼šå»é‡ã€è¡¥ç¼ºå¤±å€¼ã€å¼‚å¸¸å€¼æ£€æµ‹å’Œå¤„ç†</li>
<li><strong>ç‰¹å¾å·¥ç¨‹</strong>ï¼šæå–çƒé˜Ÿå®åŠ›æŒ‡æ ‡ã€ä¸»å®¢åœºä¼˜åŠ¿ã€å†å²äº¤é”‹è®°å½•ã€ä¼¤ç—…æƒ…å†µç­‰ç‰¹å¾</li>
<li><strong>æ•°æ®å­˜å‚¨</strong>ï¼šç»“æ„åŒ–æ•°æ®å­˜å…¥å…³ç³»æ•°æ®åº“ï¼Œç¼“å­˜çƒ­ç‚¹æ•°æ®åˆ°Redis</li>
</ul>
<h4 id="_4">å»ºæ¨¡é˜¶æ®µ<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>æ¨¡å‹è®­ç»ƒ</strong>ï¼šä½¿ç”¨XGBoost/LightGBMå¯¹å†å²æ•°æ®è¿›è¡Œè®­ç»ƒ</li>
<li><strong>æ¨¡å‹è¯„ä¼°</strong>ï¼šé€šè¿‡äº¤å‰éªŒè¯ã€å›æµ‹ç­‰æ–¹å¼è¯„ä¼°æ¨¡å‹æ€§èƒ½</li>
<li><strong>é¢„æµ‹ç”Ÿæˆ</strong>ï¼šå¯¹å³å°†è¿›è¡Œçš„æ¯”èµ›ç”Ÿæˆé¢„æµ‹ç»“æœå’Œç½®ä¿¡åº¦</li>
</ul>
<h4 id="_5">è¾“å‡ºé˜¶æ®µ<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>APIæœåŠ¡</strong>ï¼šé€šè¿‡FastAPIæä¾›RESTfulæ¥å£</li>
<li><strong>å‰ç«¯å±•ç¤º</strong>ï¼šä½¿ç”¨Vue.js/Reactæ„å»ºç”¨æˆ·ç•Œé¢ï¼Œé€šè¿‡EChartså±•ç¤ºé¢„æµ‹ç»“æœå’Œç»Ÿè®¡åˆ†æ</li>
<li><strong>å®æ—¶æ›´æ–°</strong>ï¼šæ”¯æŒå®æ—¶æ•°æ®æ›´æ–°å’Œé¢„æµ‹ç»“æœåˆ·æ–°</li>
</ul>
<hr />
<h2 id="2">2. æ¨¡å—è®¾è®¡è¯´æ˜<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 æ•°æ®é‡‡é›†æ¨¡å—<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<h4 id="_6">èŒè´£<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<ul>
<li>ä»å¤šä¸ªæ•°æ®æºé‡‡é›†è¶³çƒæ¯”èµ›ç›¸å…³æ•°æ®</li>
<li>å®ç°å¢é‡é‡‡é›†å’Œå…¨é‡åŒæ­¥æœºåˆ¶</li>
<li>å¤„ç†APIé™æµå’Œåçˆ¬è™«ç­–ç•¥</li>
<li>ä¿è¯æ•°æ®é‡‡é›†çš„ç¨³å®šæ€§å’Œå®æ—¶æ€§</li>
</ul>
<h4 id="_7">è¾“å…¥/è¾“å‡º<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>è¾“å…¥</strong>ï¼šAPIç«¯ç‚¹é…ç½®ã€çˆ¬è™«ç›®æ ‡ç½‘ç«™ã€é‡‡é›†ä»»åŠ¡è°ƒåº¦é…ç½®</li>
<li><strong>è¾“å‡º</strong>ï¼šæ ‡å‡†åŒ–çš„æ¯”èµ›æ•°æ®ã€çƒé˜Ÿæ•°æ®ã€èµ”ç‡æ•°æ®ã€çƒå‘˜æ•°æ®</li>
</ul>
<h4 id="_8">æ ¸å¿ƒç»„ä»¶<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>src/data_collection/
â”œâ”€â”€ collectors/
â”‚   â”œâ”€â”€ api_collector.py      # APIæ•°æ®é‡‡é›†å™¨
â”‚   â”œâ”€â”€ web_scraper.py        # ç½‘é¡µçˆ¬è™«
â”‚   â””â”€â”€ odds_collector.py     # èµ”ç‡æ•°æ®é‡‡é›†
â”œâ”€â”€ schedulers/
â”‚   â”œâ”€â”€ task_scheduler.py     # ä»»åŠ¡è°ƒåº¦å™¨
â”‚   â””â”€â”€ incremental_sync.py   # å¢é‡åŒæ­¥
â””â”€â”€ utils/
    â”œâ”€â”€ rate_limiter.py       # è®¿é—®é¢‘ç‡æ§åˆ¶
    â””â”€â”€ proxy_manager.py      # ä»£ç†IPç®¡ç†
</code></pre></div>
<h4 id="_9">ä¾èµ–å…³ç³»<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<ul>
<li>ä¾èµ–ï¼šå¤–éƒ¨æ•°æ®APIã€ä»£ç†æœåŠ¡ã€ä»»åŠ¡è°ƒåº¦æ¡†æ¶</li>
<li>è¢«ä¾èµ–ï¼šæ•°æ®å­˜å‚¨æ¨¡å—ã€æ•°æ®æ¸…æ´—æ¨¡å—</li>
</ul>
<h4 id="_10">æ‰©å±•æ–¹å‘<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<ul>
<li>æ”¯æŒæ›´å¤šæ•°æ®æºæ¥å…¥</li>
<li>å®ç°åˆ†å¸ƒå¼é‡‡é›†æ¶æ„</li>
<li>å¢åŠ å®æ—¶æµæ•°æ®é‡‡é›†èƒ½åŠ›</li>
</ul>
<h3 id="22">2.2 æ•°æ®å­˜å‚¨ä¸æ¸…æ´—æ¨¡å—<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<h4 id="_11">èŒè´£<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h4>
<ul>
<li>æ•°æ®è´¨é‡æ£€æŸ¥å’Œæ¸…æ´—å¤„ç†</li>
<li>å»ºç«‹ç»Ÿä¸€çš„æ•°æ®å­˜å‚¨è§„èŒƒ</li>
<li>å®ç°æ•°æ®å¤‡ä»½å’Œæ¢å¤æœºåˆ¶</li>
<li>æä¾›æ•°æ®è®¿é—®æ¥å£</li>
</ul>
<h4 id="_12">è¾“å…¥/è¾“å‡º<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>è¾“å…¥</strong>ï¼šåŸå§‹é‡‡é›†æ•°æ®ã€æ•°æ®è´¨é‡è§„åˆ™ã€æ¸…æ´—é…ç½®å‚æ•°</li>
<li><strong>è¾“å‡º</strong>ï¼šæ¸…æ´—åçš„ç»“æ„åŒ–æ•°æ®ã€æ•°æ®è´¨é‡æŠ¥å‘Šã€å¼‚å¸¸æ•°æ®è®°å½•</li>
</ul>
<h4 id="_13">æ ¸å¿ƒç»„ä»¶<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>src/data_processing/
â”œâ”€â”€ cleaners/
â”‚   â”œâ”€â”€ data_validator.py     # æ•°æ®éªŒè¯å™¨
â”‚   â”œâ”€â”€ duplicate_remover.py  # å»é‡å¤„ç†
â”‚   â””â”€â”€ missing_handler.py    # ç¼ºå¤±å€¼å¤„ç†
â”œâ”€â”€ storage/
â”‚   â”œâ”€â”€ database_manager.py   # æ•°æ®åº“ç®¡ç†
â”‚   â”œâ”€â”€ cache_manager.py      # ç¼“å­˜ç®¡ç†
â”‚   â””â”€â”€ backup_manager.py     # å¤‡ä»½ç®¡ç†
â””â”€â”€ transformers/
    â”œâ”€â”€ data_normalizer.py    # æ•°æ®æ ‡å‡†åŒ–
    â””â”€â”€ schema_mapper.py      # æ¨¡å¼æ˜ å°„
</code></pre></div>
<h4 id="_14">ä¾èµ–å…³ç³»<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<ul>
<li>ä¾èµ–ï¼šæ•°æ®é‡‡é›†æ¨¡å—ã€æ•°æ®åº“ç³»ç»Ÿã€ç¼“å­˜ç³»ç»Ÿ</li>
<li>è¢«ä¾èµ–ï¼šç‰¹å¾å·¥ç¨‹æ¨¡å—ã€æ¨¡å‹è®­ç»ƒæ¨¡å—</li>
</ul>
<h4 id="_15">æ‰©å±•æ–¹å‘<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h4>
<ul>
<li>å®ç°æµå¼æ•°æ®å¤„ç†</li>
<li>å¢åŠ æ•°æ®è¡€ç¼˜è·Ÿè¸ªåŠŸèƒ½</li>
<li>æ”¯æŒå¤šç§æ•°æ®æ ¼å¼è½¬æ¢</li>
</ul>
<h3 id="23">2.3 ç‰¹å¾å·¥ç¨‹ä¸æ¨¡å‹è®­ç»ƒæ¨¡å—<a class="headerlink" href="#23" title="Permanent link">&para;</a></h3>
<h4 id="_16">èŒè´£<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h4>
<ul>
<li>è®¾è®¡å’Œæå–é¢„æµ‹ç›¸å…³çš„ç‰¹å¾</li>
<li>è®­ç»ƒå’Œä¼˜åŒ–æœºå™¨å­¦ä¹ æ¨¡å‹</li>
<li>å®ç°æ¨¡å‹ç‰ˆæœ¬ç®¡ç†å’ŒA/Bæµ‹è¯•</li>
<li>æä¾›æ¨¡å‹æ€§èƒ½ç›‘æ§</li>
</ul>
<h4 id="_17">è¾“å…¥/è¾“å‡º<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>è¾“å…¥</strong>ï¼šæ¸…æ´—åçš„æ¯”èµ›æ•°æ®ã€çƒé˜Ÿæ•°æ®ã€å†å²ç»Ÿè®¡æ•°æ®</li>
<li><strong>è¾“å‡º</strong>ï¼šè®­ç»ƒå¥½çš„é¢„æµ‹æ¨¡å‹ã€ç‰¹å¾é‡è¦æ€§åˆ†æã€æ¨¡å‹è¯„ä¼°æŠ¥å‘Š</li>
</ul>
<h4 id="_18">æ ¸å¿ƒç»„ä»¶<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>src/ml/
â”œâ”€â”€ features/
â”‚   â”œâ”€â”€ team_features.py      # çƒé˜Ÿç‰¹å¾å·¥ç¨‹
â”‚   â”œâ”€â”€ match_features.py     # æ¯”èµ›ç‰¹å¾å·¥ç¨‹
â”‚   â””â”€â”€ historical_features.py # å†å²æ•°æ®ç‰¹å¾
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ xgboost_model.py      # XGBoostæ¨¡å‹
â”‚   â”œâ”€â”€ lightgbm_model.py     # LightGBMæ¨¡å‹
â”‚   â””â”€â”€ ensemble_model.py     # é›†æˆæ¨¡å‹
â”œâ”€â”€ training/
â”‚   â”œâ”€â”€ model_trainer.py      # æ¨¡å‹è®­ç»ƒå™¨
â”‚   â”œâ”€â”€ hyperparameter_tuner.py # è¶…å‚æ•°è°ƒä¼˜
â”‚   â””â”€â”€ cross_validator.py    # äº¤å‰éªŒè¯
â””â”€â”€ evaluation/
    â”œâ”€â”€ model_evaluator.py    # æ¨¡å‹è¯„ä¼°
    â””â”€â”€ performance_monitor.py # æ€§èƒ½ç›‘æ§
</code></pre></div>
<h4 id="_19">ä¾èµ–å…³ç³»<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h4>
<ul>
<li>ä¾èµ–ï¼šæ•°æ®å¤„ç†æ¨¡å—ã€æœºå™¨å­¦ä¹ åº“ï¼ˆXGBoostã€LightGBMï¼‰</li>
<li>è¢«ä¾èµ–ï¼šé¢„æµ‹æœåŠ¡æ¨¡å—</li>
</ul>
<h4 id="_20">æ‰©å±•æ–¹å‘<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h4>
<ul>
<li>å¼•å…¥æ·±åº¦å­¦ä¹ æ¨¡å‹</li>
<li>å®ç°åœ¨çº¿å­¦ä¹ èƒ½åŠ›</li>
<li>å¢åŠ ç‰¹å¾è‡ªåŠ¨å‘ç°åŠŸèƒ½</li>
</ul>
<h3 id="24">2.4 é¢„æµ‹æœåŠ¡æ¨¡å—<a class="headerlink" href="#24" title="Permanent link">&para;</a></h3>
<h4 id="_21">èŒè´£<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h4>
<ul>
<li>åŸºäºè®­ç»ƒæ¨¡å‹æä¾›é¢„æµ‹æœåŠ¡</li>
<li>å®ç°å®æ—¶é¢„æµ‹APIæ¥å£</li>
<li>ç®¡ç†é¢„æµ‹ç»“æœç¼“å­˜å’Œå†å²è®°å½•</li>
<li>æä¾›é¢„æµ‹ç½®ä¿¡åº¦å’Œè§£é‡Šæ€§ä¿¡æ¯</li>
</ul>
<h4 id="_22">è¾“å…¥/è¾“å‡º<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>è¾“å…¥</strong>ï¼šé¢„æµ‹è¯·æ±‚ã€æ¯”èµ›ä¿¡æ¯ã€å®æ—¶æ•°æ®æ›´æ–°</li>
<li><strong>è¾“å‡º</strong>ï¼šé¢„æµ‹ç»“æœã€ç½®ä¿¡åº¦è¯„åˆ†ã€é¢„æµ‹è§£é‡Šä¿¡æ¯</li>
</ul>
<h4 id="_23">æ ¸å¿ƒç»„ä»¶<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>src/prediction/
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ prediction_service.py  # é¢„æµ‹æœåŠ¡æ ¸å¿ƒ
â”‚   â”œâ”€â”€ model_loader.py       # æ¨¡å‹åŠ è½½å™¨
â”‚   â””â”€â”€ result_formatter.py   # ç»“æœæ ¼å¼åŒ–
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ prediction_api.py     # é¢„æµ‹APIæ¥å£
â”‚   â”œâ”€â”€ batch_predictor.py    # æ‰¹é‡é¢„æµ‹
â”‚   â””â”€â”€ real_time_predictor.py # å®æ—¶é¢„æµ‹
â””â”€â”€ utils/
    â”œâ”€â”€ confidence_calculator.py # ç½®ä¿¡åº¦è®¡ç®—
    â””â”€â”€ explanation_generator.py # é¢„æµ‹è§£é‡Š
</code></pre></div>
<h4 id="_24">ä¾èµ–å…³ç³»<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h4>
<ul>
<li>ä¾èµ–ï¼šæœºå™¨å­¦ä¹ æ¨¡å—ã€ç¼“å­˜ç³»ç»Ÿã€æ•°æ®åº“ç³»ç»Ÿ</li>
<li>è¢«ä¾èµ–ï¼šAPIæœåŠ¡å±‚ã€å‰ç«¯å±•ç¤ºæ¨¡å—</li>
</ul>
<h4 id="_25">æ‰©å±•æ–¹å‘<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h4>
<ul>
<li>æ”¯æŒå¤šæ¨¡å‹èåˆé¢„æµ‹</li>
<li>å®ç°é¢„æµ‹ç»“æœçš„å®æ—¶æ ¡å‡†</li>
<li>å¢åŠ ç”¨æˆ·ä¸ªæ€§åŒ–é¢„æµ‹åŠŸèƒ½</li>
</ul>
<h3 id="25">2.5 å‰ç«¯å±•ç¤ºæ¨¡å—<a class="headerlink" href="#25" title="Permanent link">&para;</a></h3>
<h4 id="_26">èŒè´£<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h4>
<ul>
<li>æä¾›ç”¨æˆ·å‹å¥½çš„Webç•Œé¢</li>
<li>å±•ç¤ºé¢„æµ‹ç»“æœå’Œæ•°æ®å¯è§†åŒ–</li>
<li>å®ç°å“åº”å¼è®¾è®¡æ”¯æŒå¤šè®¾å¤‡è®¿é—®</li>
<li>æä¾›å®æ—¶æ•°æ®æ›´æ–°å’Œäº¤äº’åŠŸèƒ½</li>
</ul>
<h4 id="_27">è¾“å…¥/è¾“å‡º<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>è¾“å…¥</strong>ï¼šAPIæ•°æ®ã€ç”¨æˆ·äº¤äº’äº‹ä»¶ã€å®æ—¶æ•°æ®æ¨é€</li>
<li><strong>è¾“å‡º</strong>ï¼šå¯è§†åŒ–å›¾è¡¨ã€ç”¨æˆ·ç•Œé¢ã€äº¤äº’åé¦ˆ</li>
</ul>
<h4 id="_28">æ ¸å¿ƒç»„ä»¶<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ PredictionCard.vue    # é¢„æµ‹ç»“æœå¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ MatchList.vue         # æ¯”èµ›åˆ—è¡¨
â”‚   â”‚   â””â”€â”€ StatisticsChart.vue   # ç»Ÿè®¡å›¾è¡¨
â”‚   â”œâ”€â”€ views/
â”‚   â”‚   â”œâ”€â”€ Dashboard.vue         # ä»ªè¡¨æ¿
â”‚   â”‚   â”œâ”€â”€ MatchDetail.vue       # æ¯”èµ›è¯¦æƒ…
â”‚   â”‚   â””â”€â”€ Analytics.vue         # æ•°æ®åˆ†æ
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ api.js                # APIæœåŠ¡
â”‚   â”‚   â””â”€â”€ websocket.js          # WebSocketè¿æ¥
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ chart-config.js       # å›¾è¡¨é…ç½®
â”‚       â””â”€â”€ data-formatter.js     # æ•°æ®æ ¼å¼åŒ–
</code></pre></div>
<h4 id="_29">ä¾èµ–å…³ç³»<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h4>
<ul>
<li>ä¾èµ–ï¼šVue.js/Reactæ¡†æ¶ã€ECharts/Plotlyã€APIæœåŠ¡</li>
<li>è¢«ä¾èµ–ï¼šæœ€ç»ˆç”¨æˆ·</li>
</ul>
<h4 id="_30">æ‰©å±•æ–¹å‘<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h4>
<ul>
<li>æ”¯æŒç§»åŠ¨ç«¯APPå¼€å‘</li>
<li>å®ç°ä¸ªæ€§åŒ–ç”¨æˆ·ç•Œé¢</li>
<li>å¢åŠ ç¤¾äº¤åˆ†äº«åŠŸèƒ½</li>
</ul>
<h3 id="26">2.6 å®¹å™¨åŒ–ä¸éƒ¨ç½²æ¨¡å—<a class="headerlink" href="#26" title="Permanent link">&para;</a></h3>
<h4 id="_31">èŒè´£<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h4>
<ul>
<li>å®ç°åº”ç”¨çš„å®¹å™¨åŒ–éƒ¨ç½²</li>
<li>ç®¡ç†æœåŠ¡ç¼–æ’å’Œè´Ÿè½½å‡è¡¡</li>
<li>æä¾›CI/CDæµæ°´çº¿æ”¯æŒ</li>
<li>ç›‘æ§ç³»ç»Ÿè¿è¡ŒçŠ¶æ€å’Œæ€§èƒ½æŒ‡æ ‡</li>
</ul>
<h4 id="_32">è¾“å…¥/è¾“å‡º<a class="headerlink" href="#_32" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>è¾“å…¥</strong>ï¼šåº”ç”¨ä»£ç ã€éƒ¨ç½²é…ç½®ã€ç¯å¢ƒå˜é‡</li>
<li><strong>è¾“å‡º</strong>ï¼šè¿è¡Œä¸­çš„æœåŠ¡å®ä¾‹ã€ç›‘æ§æ•°æ®ã€éƒ¨ç½²æ—¥å¿—</li>
</ul>
<h4 id="_33">æ ¸å¿ƒç»„ä»¶<a class="headerlink" href="#_33" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>deployment/
â”œâ”€â”€ docker/
â”‚   â”œâ”€â”€ Dockerfile.api        # APIæœåŠ¡é•œåƒ
â”‚   â”œâ”€â”€ Dockerfile.worker     # åå°ä»»åŠ¡é•œåƒ
â”‚   â””â”€â”€ Dockerfile.frontend   # å‰ç«¯åº”ç”¨é•œåƒ
â”œâ”€â”€ kubernetes/
â”‚   â”œâ”€â”€ api-deployment.yaml   # APIæœåŠ¡éƒ¨ç½²
â”‚   â”œâ”€â”€ database-config.yaml  # æ•°æ®åº“é…ç½®
â”‚   â””â”€â”€ ingress.yaml          # è´Ÿè½½å‡è¡¡é…ç½®
â”œâ”€â”€ ci-cd/
â”‚   â”œâ”€â”€ github-actions.yml    # CI/CDæµæ°´çº¿
â”‚   â””â”€â”€ deployment-script.sh  # éƒ¨ç½²è„šæœ¬
â””â”€â”€ monitoring/
    â”œâ”€â”€ prometheus-config.yml  # ç›‘æ§é…ç½®
    â””â”€â”€ grafana-dashboard.json # ä»ªè¡¨æ¿é…ç½®
</code></pre></div>
<h4 id="_34">ä¾èµ–å…³ç³»<a class="headerlink" href="#_34" title="Permanent link">&para;</a></h4>
<ul>
<li>ä¾èµ–ï¼šDockerã€Kubernetesã€CI/CDå¹³å°</li>
<li>è¢«ä¾èµ–ï¼šæ‰€æœ‰å…¶ä»–æ¨¡å—ï¼ˆæä¾›è¿è¡Œç¯å¢ƒï¼‰</li>
</ul>
<h4 id="_35">æ‰©å±•æ–¹å‘<a class="headerlink" href="#_35" title="Permanent link">&para;</a></h4>
<ul>
<li>å®ç°å¤šäº‘éƒ¨ç½²æ”¯æŒ</li>
<li>å¢åŠ è‡ªåŠ¨æ‰©ç¼©å®¹åŠŸèƒ½</li>
<li>æä¾›è“ç»¿éƒ¨ç½²èƒ½åŠ›</li>
</ul>
<hr />
<h2 id="3">3. æ•°æ®åº“è®¾è®¡è‰æ¡ˆ<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 æ ¸å¿ƒè¡¨ç»“æ„<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<h4 id="311-teams">3.1.1 çƒé˜Ÿè¡¨ (teams)<a class="headerlink" href="#311-teams" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">teams</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">team_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">team_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">team_code</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<span class="w">    </span><span class="n">country</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="n">league_id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">founded_year</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">stadium</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
<span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
<span class="w">    </span><span class="n">updated_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>

<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_league</span><span class="w"> </span><span class="p">(</span><span class="n">league_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_country</span><span class="w"> </span><span class="p">(</span><span class="n">country</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>
<h4 id="312-matches">3.1.2 æ¯”èµ›è¡¨ (matches)<a class="headerlink" href="#312-matches" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">match_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">home_team_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">away_team_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">league_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">season</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="w">    </span><span class="n">match_date</span><span class="w"> </span><span class="n">DATETIME</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">match_status</span><span class="w"> </span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;scheduled&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;live&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;finished&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;cancelled&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;scheduled&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="n">home_score</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">away_score</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">home_goals_ht</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- åŠåœºæ¯”åˆ†</span>
<span class="w">    </span><span class="n">away_goals_ht</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">attendance</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">referee</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
<span class="w">    </span><span class="n">venue</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
<span class="w">    </span><span class="n">weather_condition</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
<span class="w">    </span><span class="n">updated_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>

<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">home_team_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">teams</span><span class="p">(</span><span class="n">team_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">away_team_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">teams</span><span class="p">(</span><span class="n">team_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_date</span><span class="w"> </span><span class="p">(</span><span class="n">match_date</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_teams</span><span class="w"> </span><span class="p">(</span><span class="n">home_team_id</span><span class="p">,</span><span class="w"> </span><span class="n">away_team_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_league_season</span><span class="w"> </span><span class="p">(</span><span class="n">league_id</span><span class="p">,</span><span class="w"> </span><span class="n">season</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_status</span><span class="w"> </span><span class="p">(</span><span class="n">match_status</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>
<h4 id="313-odds">3.1.3 èµ”ç‡è¡¨ (odds)<a class="headerlink" href="#313-odds" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">odds</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">odds_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">match_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">bookmaker</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">market_type</span><span class="w"> </span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;1x2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;over_under&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;asian_handicap&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;both_teams_score&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">home_odds</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">draw_odds</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">away_odds</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">over_odds</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">under_odds</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">line_value</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="c1">-- ç›˜å£å€¼</span>
<span class="w">    </span><span class="n">collected_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>

<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">match_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">matches</span><span class="p">(</span><span class="n">match_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_match_bookmaker</span><span class="w"> </span><span class="p">(</span><span class="n">match_id</span><span class="p">,</span><span class="w"> </span><span class="n">bookmaker</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_collected_at</span><span class="w"> </span><span class="p">(</span><span class="n">collected_at</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_market_type</span><span class="w"> </span><span class="p">(</span><span class="n">market_type</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>
<h4 id="314-features">3.1.4 ç‰¹å¾è¡¨ (features)<a class="headerlink" href="#314-features" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">feature_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">match_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">team_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">team_type</span><span class="w"> </span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;away&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>

<span class="w">    </span><span class="c1">-- åŸºç¡€ç»Ÿè®¡ç‰¹å¾</span>
<span class="w">    </span><span class="n">recent_5_wins</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">recent_5_draws</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">recent_5_losses</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">recent_5_goals_for</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">recent_5_goals_against</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>

<span class="w">    </span><span class="c1">-- ä¸»å®¢åœºç‰¹å¾</span>
<span class="w">    </span><span class="n">home_wins</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">home_draws</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">home_losses</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">away_wins</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">away_draws</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">away_losses</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>

<span class="w">    </span><span class="c1">-- å¯¹æˆ˜å†å²ç‰¹å¾</span>
<span class="w">    </span><span class="n">h2h_wins</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">h2h_draws</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">h2h_losses</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">h2h_goals_for</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">h2h_goals_against</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>

<span class="w">    </span><span class="c1">-- è”èµ›æ’åç‰¹å¾</span>
<span class="w">    </span><span class="n">league_position</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">points</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">goal_difference</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>

<span class="w">    </span><span class="c1">-- å…¶ä»–ç‰¹å¾</span>
<span class="w">    </span><span class="n">days_since_last_match</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">is_derby</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">FALSE</span><span class="p">,</span>
<span class="w">    </span><span class="n">avg_possession</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="w">    </span><span class="n">avg_shots_per_game</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>

<span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>

<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">match_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">matches</span><span class="p">(</span><span class="n">match_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">team_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">teams</span><span class="p">(</span><span class="n">team_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_match</span><span class="w"> </span><span class="p">(</span><span class="n">match_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_team</span><span class="w"> </span><span class="p">(</span><span class="n">team_id</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>
<h4 id="315-predictions">3.1.5 é¢„æµ‹è¡¨ (predictions)<a class="headerlink" href="#315-predictions" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">predictions</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">prediction_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">match_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">model_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">model_version</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>

<span class="w">    </span><span class="c1">-- é¢„æµ‹ç»“æœ</span>
<span class="w">    </span><span class="n">predicted_result</span><span class="w"> </span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;home_win&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;draw&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;away_win&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">home_win_probability</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">draw_probability</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">away_win_probability</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>

<span class="w">    </span><span class="c1">-- æ¯”åˆ†é¢„æµ‹</span>
<span class="w">    </span><span class="n">predicted_home_score</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="w">    </span><span class="n">predicted_away_score</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>

<span class="w">    </span><span class="c1">-- å…¶ä»–é¢„æµ‹</span>
<span class="w">    </span><span class="n">over_2_5_probability</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">both_teams_score_probability</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>

<span class="w">    </span><span class="c1">-- ç½®ä¿¡åº¦å’Œç‰¹å¾é‡è¦æ€§</span>
<span class="w">    </span><span class="n">confidence_score</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">feature_importance</span><span class="w"> </span><span class="n">JSON</span><span class="p">,</span><span class="w"> </span><span class="c1">-- å­˜å‚¨ç‰¹å¾é‡è¦æ€§æ•°æ®</span>

<span class="w">    </span><span class="n">predicted_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>

<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">match_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">matches</span><span class="p">(</span><span class="n">match_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_match_model</span><span class="w"> </span><span class="p">(</span><span class="n">match_id</span><span class="p">,</span><span class="w"> </span><span class="n">model_name</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_predicted_at</span><span class="w"> </span><span class="p">(</span><span class="n">predicted_at</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>
<h4 id="316-leagues">3.1.6 è”èµ›è¡¨ (leagues)<a class="headerlink" href="#316-leagues" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">leagues</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">league_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">league_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">league_code</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<span class="w">    </span><span class="n">country</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="k">level</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- è”èµ›çº§åˆ«</span>
<span class="w">    </span><span class="n">season_start_month</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">season_end_month</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">is_active</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">TRUE</span><span class="p">,</span>
<span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>

<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_country</span><span class="w"> </span><span class="p">(</span><span class="n">country</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_active</span><span class="w"> </span><span class="p">(</span><span class="n">is_active</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>
<h3 id="32">3.2 æ•°æ®ä¸€è‡´æ€§çº¦æŸ<a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<h4 id="321">3.2.1 æ•°æ®å®Œæ•´æ€§çº¦æŸ<a class="headerlink" href="#321" title="Permanent link">&para;</a></h4>
<ul>
<li>æ‰€æœ‰æ¯”èµ›å¿…é¡»æœ‰æœ‰æ•ˆçš„ä¸»å®¢åœºçƒé˜Ÿ</li>
<li>å·²å®Œæˆçš„æ¯”èµ›å¿…é¡»æœ‰æ¯”åˆ†</li>
<li>é¢„æµ‹å¿…é¡»åŸºäºæœªå®Œæˆçš„æ¯”èµ›</li>
<li>èµ”ç‡æ•°æ®å¿…é¡»åœ¨æ¯”èµ›å¼€å§‹å‰æ”¶é›†</li>
</ul>
<h4 id="322">3.2.2 ä¸šåŠ¡é€»è¾‘çº¦æŸ<a class="headerlink" href="#322" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">-- ç¡®ä¿æ¯”èµ›æ—¥æœŸä¸åœ¨è¿‡å»ï¼ˆå¯¹äºæ–°å»ºæ¯”èµ›ï¼‰</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">check_future_date</span>
<span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">match_date</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">DATE_SUB</span><span class="p">(</span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">DAY</span><span class="p">));</span>

<span class="c1">-- ç¡®ä¿æ¦‚ç‡ä¹‹å’Œç­‰äº1</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">predictions</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">check_probability_sum</span>
<span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="k">ABS</span><span class="p">((</span><span class="n">home_win_probability</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">draw_probability</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">away_win_probability</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">001</span><span class="p">);</span>

<span class="c1">-- ç¡®ä¿èµ”ç‡ä¸ºæ­£æ•°</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">odds</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">check_positive_odds</span>
<span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">home_odds</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">draw_odds</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">away_odds</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</code></pre></div>
<h3 id="33">3.3 ç´¢å¼•ä¼˜åŒ–ç­–ç•¥<a class="headerlink" href="#33" title="Permanent link">&para;</a></h3>
<h4 id="331">3.3.1 æŸ¥è¯¢ä¼˜åŒ–ç´¢å¼•<a class="headerlink" href="#331" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">-- æœ€è¿‘æ¯”èµ›æŸ¥è¯¢ä¼˜åŒ–</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_recent_matches</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">matches</span><span class="p">(</span><span class="n">match_date</span><span class="w"> </span><span class="k">DESC</span><span class="p">,</span><span class="w"> </span><span class="n">league_id</span><span class="p">);</span>

<span class="c1">-- çƒé˜Ÿå†å²æˆ˜ç»©æŸ¥è¯¢ä¼˜åŒ–</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_team_matches</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">matches</span><span class="p">(</span><span class="n">home_team_id</span><span class="p">,</span><span class="w"> </span><span class="n">away_team_id</span><span class="p">,</span><span class="w"> </span><span class="n">match_date</span><span class="p">);</span>

<span class="c1">-- é¢„æµ‹ç»“æœæŸ¥è¯¢ä¼˜åŒ–</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_predictions_lookup</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">predictions</span><span class="p">(</span><span class="n">match_id</span><span class="p">,</span><span class="w"> </span><span class="n">model_name</span><span class="p">,</span><span class="w"> </span><span class="n">predicted_at</span><span class="w"> </span><span class="k">DESC</span><span class="p">);</span>

<span class="c1">-- ç‰¹å¾å·¥ç¨‹æŸ¥è¯¢ä¼˜åŒ–</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_features_team_date</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">matches</span><span class="p">(</span><span class="n">home_team_id</span><span class="p">,</span><span class="w"> </span><span class="n">match_date</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_features_away_date</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">matches</span><span class="p">(</span><span class="n">away_team_id</span><span class="p">,</span><span class="w"> </span><span class="n">match_date</span><span class="p">);</span>
</code></pre></div>
<h3 id="34">3.4 æ•°æ®åˆ†åŒºç­–ç•¥<a class="headerlink" href="#34" title="Permanent link">&para;</a></h3>
<h4 id="341">3.4.1 æŒ‰æ—¶é—´åˆ†åŒº<a class="headerlink" href="#341" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">-- æ¯”èµ›è¡¨æŒ‰å¹´ä»½åˆ†åŒº</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">RANGE</span><span class="w"> </span><span class="p">(</span><span class="k">YEAR</span><span class="p">(</span><span class="n">match_date</span><span class="p">))</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">PARTITION</span><span class="w"> </span><span class="n">p2020</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">LESS</span><span class="w"> </span><span class="k">THAN</span><span class="w"> </span><span class="p">(</span><span class="mi">2021</span><span class="p">),</span>
<span class="w">    </span><span class="n">PARTITION</span><span class="w"> </span><span class="n">p2021</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">LESS</span><span class="w"> </span><span class="k">THAN</span><span class="w"> </span><span class="p">(</span><span class="mi">2022</span><span class="p">),</span>
<span class="w">    </span><span class="n">PARTITION</span><span class="w"> </span><span class="n">p2022</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">LESS</span><span class="w"> </span><span class="k">THAN</span><span class="w"> </span><span class="p">(</span><span class="mi">2023</span><span class="p">),</span>
<span class="w">    </span><span class="n">PARTITION</span><span class="w"> </span><span class="n">p2023</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">LESS</span><span class="w"> </span><span class="k">THAN</span><span class="w"> </span><span class="p">(</span><span class="mi">2024</span><span class="p">),</span>
<span class="w">    </span><span class="n">PARTITION</span><span class="w"> </span><span class="n">p2024</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">LESS</span><span class="w"> </span><span class="k">THAN</span><span class="w"> </span><span class="p">(</span><span class="mi">2025</span><span class="p">),</span>
<span class="w">    </span><span class="n">PARTITION</span><span class="w"> </span><span class="n">p_future</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">LESS</span><span class="w"> </span><span class="k">THAN</span><span class="w"> </span><span class="k">MAXVALUE</span>
<span class="p">);</span>

<span class="c1">-- é¢„æµ‹è¡¨æŒ‰æœˆåˆ†åŒº</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">predictions</span><span class="w"> </span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">RANGE</span><span class="w"> </span><span class="p">(</span><span class="k">YEAR</span><span class="p">(</span><span class="n">predicted_at</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">MONTH</span><span class="p">(</span><span class="n">predicted_at</span><span class="p">))</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">PARTITION</span><span class="w"> </span><span class="n">p202401</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">LESS</span><span class="w"> </span><span class="k">THAN</span><span class="w"> </span><span class="p">(</span><span class="mi">202402</span><span class="p">),</span>
<span class="w">    </span><span class="n">PARTITION</span><span class="w"> </span><span class="n">p202402</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">LESS</span><span class="w"> </span><span class="k">THAN</span><span class="w"> </span><span class="p">(</span><span class="mi">202403</span><span class="p">),</span>
<span class="w">    </span><span class="c1">-- ... æ›´å¤šåˆ†åŒº</span>
<span class="w">    </span><span class="n">PARTITION</span><span class="w"> </span><span class="n">p_current</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">LESS</span><span class="w"> </span><span class="k">THAN</span><span class="w"> </span><span class="k">MAXVALUE</span>
<span class="p">);</span>
</code></pre></div>
<h3 id="35">3.5 æ‰©å±•æ€§è€ƒè™‘<a class="headerlink" href="#35" title="Permanent link">&para;</a></h3>
<h4 id="351">3.5.1 è¯»å†™åˆ†ç¦»<a class="headerlink" href="#351" title="Permanent link">&para;</a></h4>
<ul>
<li>ä¸»åº“å¤„ç†å†™æ“ä½œå’Œå®æ—¶æŸ¥è¯¢</li>
<li>ä»åº“å¤„ç†å†å²æ•°æ®åˆ†æå’ŒæŠ¥è¡¨æŸ¥è¯¢</li>
<li>é¢„æµ‹æœåŠ¡ä¼˜å…ˆä½¿ç”¨ä»åº“å‡å°‘ä¸»åº“å‹åŠ›</li>
</ul>
<h4 id="352">3.5.2 ç¼“å­˜ç­–ç•¥<a class="headerlink" href="#352" title="Permanent link">&para;</a></h4>
<ul>
<li>Redisç¼“å­˜çƒ­ç‚¹æŸ¥è¯¢æ•°æ®ï¼ˆè¿‘æœŸæ¯”èµ›ã€å®æ—¶é¢„æµ‹ç»“æœï¼‰</li>
<li>ç¼“å­˜çƒé˜ŸåŸºç¡€ä¿¡æ¯å’Œè”èµ›ä¿¡æ¯</li>
<li>ç¼“å­˜é¢„æµ‹æ¨¡å‹è¾“å‡ºç»“æœï¼ˆ1å°æ—¶æœ‰æ•ˆæœŸï¼‰</li>
</ul>
<h4 id="353">3.5.3 å½’æ¡£ç­–ç•¥<a class="headerlink" href="#353" title="Permanent link">&para;</a></h4>
<ul>
<li>å†å²æ¯”èµ›æ•°æ®ï¼ˆ3å¹´ä»¥ä¸Šï¼‰å½’æ¡£åˆ°å•ç‹¬çš„å½’æ¡£åº“</li>
<li>å†å²é¢„æµ‹æ•°æ®ä¿ç•™ç”¨äºæ¨¡å‹æ•ˆæœå›æµ‹</li>
<li>èµ”ç‡å†å²æ•°æ®å®šæœŸæ¸…ç†ï¼Œä¿ç•™ä»£è¡¨æ€§æ ·æœ¬</li>
</ul>
<hr />
<h2 id="4">4. å¼€å‘é˜¶æ®µè§„åˆ’<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 é˜¶æ®µä¸€ï¼šç¯å¢ƒæ­å»º + æ•°æ®é‡‡é›† + æ•°æ®å­˜å‚¨æ¸…æ´—<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<h4 id="4-6">æ—¶é—´è§„åˆ’ï¼š4-6å‘¨<a class="headerlink" href="#4-6" title="Permanent link">&para;</a></h4>
<h4 id="_36">ä¸»è¦ä»»åŠ¡<a class="headerlink" href="#_36" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>å¼€å‘ç¯å¢ƒæ­å»º</strong>ï¼ˆ1å‘¨ï¼‰</li>
<li>æ­å»ºPythonå¼€å‘ç¯å¢ƒå’Œä¾èµ–ç®¡ç†</li>
<li>é…ç½®æ•°æ®åº“ï¼ˆMySQL/PostgreSQLï¼‰å’ŒRedis</li>
<li>å»ºç«‹Gitç‰ˆæœ¬æ§åˆ¶å’Œä»£ç è§„èŒƒ</li>
<li>
<p>é…ç½®æ—¥å¿—ç³»ç»Ÿå’Œç›‘æ§åŸºç¡€è®¾æ–½</p>
</li>
<li>
<p><strong>æ•°æ®é‡‡é›†ç³»ç»Ÿå¼€å‘</strong>ï¼ˆ2-3å‘¨ï¼‰</p>
</li>
<li>å®ç°APIæ•°æ®é‡‡é›†å™¨ï¼ˆAPI-Footballç­‰ï¼‰</li>
<li>å¼€å‘Webçˆ¬è™«ç³»ç»Ÿï¼ˆå¤„ç†åçˆ¬æœºåˆ¶ï¼‰</li>
<li>å»ºç«‹æ•°æ®é‡‡é›†ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ</li>
<li>å®ç°å¢é‡æ•°æ®åŒæ­¥æœºåˆ¶</li>
<li>
<p>å»ºç«‹æ•°æ®é‡‡é›†ç›‘æ§å’Œå‘Šè­¦</p>
</li>
<li>
<p><strong>æ•°æ®å­˜å‚¨å’Œæ¸…æ´—ç³»ç»Ÿ</strong>ï¼ˆ1-2å‘¨ï¼‰</p>
</li>
<li>å®ç°æ•°æ®åº“è¡¨ç»“æ„åˆ›å»ºå’Œè¿ç§»</li>
<li>å¼€å‘æ•°æ®æ¸…æ´—å’ŒéªŒè¯æ¨¡å—</li>
<li>å»ºç«‹æ•°æ®è´¨é‡ç›‘æ§ç³»ç»Ÿ</li>
<li>å®ç°æ•°æ®å¤‡ä»½å’Œæ¢å¤æœºåˆ¶</li>
</ol>
<h4 id="_37">äº¤ä»˜ç‰©<a class="headerlink" href="#_37" title="Permanent link">&para;</a></h4>
<ul>
<li>å®Œæ•´çš„æ•°æ®é‡‡é›†ç³»ç»Ÿï¼Œèƒ½å¤Ÿç¨³å®šè·å–ä¸»è¦è”èµ›æ•°æ®</li>
<li>æ•°æ®åº“schemaå’Œæ•°æ®æ¸…æ´—æµæ°´çº¿</li>
<li>æ•°æ®è´¨é‡æŠ¥å‘Šå’Œç›‘æ§ä»ªè¡¨æ¿</li>
<li>æŠ€æœ¯æ–‡æ¡£å’Œæ“ä½œæ‰‹å†Œ</li>
</ul>
<h4 id="_38">é‡Œç¨‹ç¢‘æ£€æŸ¥<a class="headerlink" href="#_38" title="Permanent link">&para;</a></h4>
<ul>
<li>èƒ½å¤Ÿé‡‡é›†è‡³å°‘3ä¸ªä¸»è¦è”èµ›çš„å†å²æ•°æ®ï¼ˆæœ€è¿‘2ä¸ªèµ›å­£ï¼‰</li>
<li>æ•°æ®è´¨é‡è¾¾æ ‡ï¼ˆå®Œæ•´æ€§&gt;95%ï¼Œå‡†ç¡®æ€§&gt;98%ï¼‰</li>
<li>ç³»ç»Ÿç¨³å®šè¿è¡Œ72å°æ—¶æ— ä¸­æ–­</li>
</ul>
<h4 id="_39">æµ‹è¯•é‡ç‚¹<a class="headerlink" href="#_39" title="Permanent link">&para;</a></h4>
<ul>
<li>æ•°æ®é‡‡é›†çš„ç¨³å®šæ€§å’Œå‡†ç¡®æ€§æµ‹è¯•</li>
<li>æ•°æ®æ¸…æ´—é€»è¾‘çš„æ­£ç¡®æ€§éªŒè¯</li>
<li>å¼‚å¸¸æƒ…å†µå¤„ç†ï¼ˆç½‘ç»œä¸­æ–­ã€APIé™æµç­‰ï¼‰</li>
</ul>
<h3 id="42">4.2 é˜¶æ®µäºŒï¼šç‰¹å¾å·¥ç¨‹ + æ¨¡å‹è®­ç»ƒ<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<h4 id="6-8">æ—¶é—´è§„åˆ’ï¼š6-8å‘¨<a class="headerlink" href="#6-8" title="Permanent link">&para;</a></h4>
<h4 id="_40">ä¸»è¦ä»»åŠ¡<a class="headerlink" href="#_40" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>ç‰¹å¾å·¥ç¨‹å¼€å‘</strong>ï¼ˆ3-4å‘¨ï¼‰</li>
<li>è®¾è®¡å’Œå®ç°åŸºç¡€ç»Ÿè®¡ç‰¹å¾ï¼ˆèƒœè´Ÿè®°å½•ã€è¿›çƒæ•°ç­‰ï¼‰</li>
<li>å¼€å‘é«˜çº§ç‰¹å¾ï¼ˆä¸»å®¢åœºä¼˜åŠ¿ã€å¯¹æˆ˜å†å²ã€çƒé˜Ÿå®åŠ›ç­‰ï¼‰</li>
<li>å®ç°æ—¶åºç‰¹å¾ï¼ˆæœ€è¿‘çŠ¶æ€ã€è¶‹åŠ¿åˆ†æï¼‰</li>
<li>å»ºç«‹ç‰¹å¾å­˜å‚¨å’Œç®¡ç†ç³»ç»Ÿ</li>
<li>
<p>ç‰¹å¾æœ‰æ•ˆæ€§åˆ†æå’Œç­›é€‰</p>
</li>
<li>
<p><strong>æ¨¡å‹è®­ç»ƒç³»ç»Ÿ</strong>ï¼ˆ2-3å‘¨ï¼‰</p>
</li>
<li>å®ç°XGBoostå’ŒLightGBMæ¨¡å‹è®­ç»ƒæµæ°´çº¿</li>
<li>å¼€å‘è¶…å‚æ•°è°ƒä¼˜ç³»ç»Ÿ</li>
<li>å»ºç«‹äº¤å‰éªŒè¯å’Œæ¨¡å‹è¯„ä¼°ä½“ç³»</li>
<li>å®ç°æ¨¡å‹ç‰ˆæœ¬ç®¡ç†å’Œå¯¹æ¯”ç³»ç»Ÿ</li>
<li>
<p>å¼€å‘æ¨¡å‹è§£é‡Šæ€§åˆ†æå·¥å…·</p>
</li>
<li>
<p><strong>æ¨¡å‹ä¼˜åŒ–å’Œé›†æˆ</strong>ï¼ˆ1å‘¨ï¼‰</p>
</li>
<li>æ¨¡å‹æ€§èƒ½ä¼˜åŒ–å’Œè°ƒå‚</li>
<li>å®ç°å¤šæ¨¡å‹é›†æˆç­–ç•¥</li>
<li>å»ºç«‹æ¨¡å‹æ€§èƒ½ç›‘æ§ç³»ç»Ÿ</li>
</ol>
<h4 id="_41">äº¤ä»˜ç‰©<a class="headerlink" href="#_41" title="Permanent link">&para;</a></h4>
<ul>
<li>å®Œæ•´çš„ç‰¹å¾å·¥ç¨‹ç³»ç»Ÿï¼ŒåŒ…å«100+ä¸ªé¢„æµ‹ç‰¹å¾</li>
<li>è®­ç»ƒå¥½çš„é¢„æµ‹æ¨¡å‹ï¼Œé¢„æµ‹å‡†ç¡®ç‡&gt;55%</li>
<li>æ¨¡å‹è¯„ä¼°æŠ¥å‘Šå’Œæ€§èƒ½åŸºå‡†</li>
<li>ç‰¹å¾é‡è¦æ€§åˆ†æå’Œæ¨¡å‹è§£é‡Šæ–‡æ¡£</li>
</ul>
<h4 id="_42">é‡Œç¨‹ç¢‘æ£€æŸ¥<a class="headerlink" href="#_42" title="Permanent link">&para;</a></h4>
<ul>
<li>ç‰¹å¾å·¥ç¨‹ç³»ç»Ÿèƒ½å¤Ÿä¸ºæ‰€æœ‰æ¯”èµ›ç”Ÿæˆå®Œæ•´ç‰¹å¾å‘é‡</li>
<li>æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šè¾¾åˆ°é¢„æœŸæ€§èƒ½æŒ‡æ ‡</li>
<li>èƒ½å¤Ÿä¸ºæœªæ¥æ¯”èµ›ç”Ÿæˆå¯ä¿¡çš„é¢„æµ‹ç»“æœ</li>
</ul>
<h4 id="_43">æµ‹è¯•é‡ç‚¹<a class="headerlink" href="#_43" title="Permanent link">&para;</a></h4>
<ul>
<li>ç‰¹å¾è®¡ç®—çš„æ­£ç¡®æ€§å’Œä¸€è‡´æ€§</li>
<li>æ¨¡å‹é¢„æµ‹çš„å‡†ç¡®æ€§å’Œç¨³å®šæ€§</li>
<li>ä¸åŒè”èµ›å’Œæ—¶é—´æ®µçš„æ³›åŒ–èƒ½åŠ›æµ‹è¯•</li>
</ul>
<h3 id="43-api">4.3 é˜¶æ®µä¸‰ï¼šé¢„æµ‹æœåŠ¡API + å‰ç«¯å±•ç¤º<a class="headerlink" href="#43-api" title="Permanent link">&para;</a></h3>
<h4 id="6-8_1">æ—¶é—´è§„åˆ’ï¼š6-8å‘¨<a class="headerlink" href="#6-8_1" title="Permanent link">&para;</a></h4>
<h4 id="_44">ä¸»è¦ä»»åŠ¡<a class="headerlink" href="#_44" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>é¢„æµ‹æœåŠ¡å¼€å‘</strong>ï¼ˆ3-4å‘¨ï¼‰</li>
<li>ä½¿ç”¨FastAPIæ„å»ºRESTful APIæœåŠ¡</li>
<li>å®ç°å®æ—¶é¢„æµ‹å’Œæ‰¹é‡é¢„æµ‹æ¥å£</li>
<li>å¼€å‘é¢„æµ‹ç»“æœç¼“å­˜å’Œå­˜å‚¨ç³»ç»Ÿ</li>
<li>å»ºç«‹APIè®¤è¯å’Œé™æµæœºåˆ¶</li>
<li>
<p>å®ç°é¢„æµ‹ç½®ä¿¡åº¦è®¡ç®—å’Œç»“æœè§£é‡Š</p>
</li>
<li>
<p><strong>å‰ç«¯åº”ç”¨å¼€å‘</strong>ï¼ˆ2-3å‘¨ï¼‰</p>
</li>
<li>ä½¿ç”¨Vue.js/Reactå¼€å‘å“åº”å¼Webç•Œé¢</li>
<li>å®ç°æ¯”èµ›åˆ—è¡¨ã€é¢„æµ‹ç»“æœå±•ç¤ºç»„ä»¶</li>
<li>å¼€å‘æ•°æ®å¯è§†åŒ–å›¾è¡¨ï¼ˆEChartsï¼‰</li>
<li>å»ºç«‹å®æ—¶æ•°æ®æ›´æ–°æœºåˆ¶ï¼ˆWebSocketï¼‰</li>
<li>
<p>å®ç°ç§»åŠ¨ç«¯é€‚é…</p>
</li>
<li>
<p><strong>ç³»ç»Ÿé›†æˆå’Œæµ‹è¯•</strong>ï¼ˆ1å‘¨ï¼‰</p>
</li>
<li>å‰åç«¯é›†æˆå’Œè”è°ƒ</li>
<li>æ€§èƒ½ä¼˜åŒ–å’Œç”¨æˆ·ä½“éªŒæ”¹è¿›</li>
<li>å…¨é“¾è·¯åŠŸèƒ½æµ‹è¯•</li>
</ol>
<h4 id="_45">äº¤ä»˜ç‰©<a class="headerlink" href="#_45" title="Permanent link">&para;</a></h4>
<ul>
<li>å®Œæ•´çš„é¢„æµ‹APIæœåŠ¡ï¼Œæ”¯æŒå¤šç§é¢„æµ‹ç±»å‹</li>
<li>ç”¨æˆ·å‹å¥½çš„Webå‰ç«¯åº”ç”¨</li>
<li>APIæ–‡æ¡£å’Œç”¨æˆ·ä½¿ç”¨æŒ‡å—</li>
<li>ç³»ç»Ÿæ€§èƒ½æµ‹è¯•æŠ¥å‘Š</li>
</ul>
<h4 id="_46">é‡Œç¨‹ç¢‘æ£€æŸ¥<a class="headerlink" href="#_46" title="Permanent link">&para;</a></h4>
<ul>
<li>APIæœåŠ¡èƒ½å¤Ÿç¨³å®šæä¾›é¢„æµ‹ç»“æœï¼Œå“åº”æ—¶é—´&lt;500ms</li>
<li>å‰ç«¯åº”ç”¨åŠŸèƒ½å®Œæ•´ï¼Œç”¨æˆ·ä½“éªŒè‰¯å¥½</li>
<li>ç³»ç»Ÿèƒ½å¤ŸåŒæ—¶æ”¯æŒ100ä¸ªå¹¶å‘ç”¨æˆ·</li>
</ul>
<h4 id="_47">æµ‹è¯•é‡ç‚¹<a class="headerlink" href="#_47" title="Permanent link">&para;</a></h4>
<ul>
<li>APIæ¥å£çš„åŠŸèƒ½æ€§å’Œæ€§èƒ½æµ‹è¯•</li>
<li>å‰ç«¯ç•Œé¢çš„å…¼å®¹æ€§å’Œæ˜“ç”¨æ€§æµ‹è¯•</li>
<li>ç³»ç»Ÿè´Ÿè½½å’Œå‹åŠ›æµ‹è¯•</li>
</ul>
<h3 id="44-cicd">4.4 é˜¶æ®µå››ï¼šå®¹å™¨åŒ–éƒ¨ç½² + CI/CDæµç¨‹<a class="headerlink" href="#44-cicd" title="Permanent link">&para;</a></h3>
<h4 id="4-6_1">æ—¶é—´è§„åˆ’ï¼š4-6å‘¨<a class="headerlink" href="#4-6_1" title="Permanent link">&para;</a></h4>
<h4 id="_48">ä¸»è¦ä»»åŠ¡<a class="headerlink" href="#_48" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>å®¹å™¨åŒ–æ”¹é€ </strong>ï¼ˆ2-3å‘¨ï¼‰</li>
<li>ç¼–å†™Dockerfileæ„å»ºåº”ç”¨é•œåƒ</li>
<li>é…ç½®Docker Composeæœ¬åœ°éƒ¨ç½²</li>
<li>å®ç°é…ç½®ç®¡ç†å’Œç¯å¢ƒå˜é‡æ³¨å…¥</li>
<li>
<p>å»ºç«‹é•œåƒç‰ˆæœ¬ç®¡ç†å’Œä»“åº“</p>
</li>
<li>
<p><strong>äº‘ç«¯éƒ¨ç½²</strong>ï¼ˆ1-2å‘¨ï¼‰</p>
</li>
<li>é€‰æ‹©å’Œé…ç½®äº‘æœåŠ¡æä¾›å•†ï¼ˆä¼˜å…ˆé¦™æ¸¯èŠ‚ç‚¹ï¼‰</li>
<li>å®ç°Kubernetesé›†ç¾¤éƒ¨ç½²ï¼ˆå¯é€‰ï¼‰</li>
<li>é…ç½®è´Ÿè½½å‡è¡¡å’ŒåŸŸåè§£æ</li>
<li>
<p>å»ºç«‹ç”Ÿäº§ç¯å¢ƒç›‘æ§å’Œå‘Šè­¦</p>
</li>
<li>
<p><strong>CI/CDæµç¨‹å»ºè®¾</strong>ï¼ˆ1å‘¨ï¼‰</p>
</li>
<li>é…ç½®GitHub Actionsè‡ªåŠ¨åŒ–æµæ°´çº¿</li>
<li>å®ç°è‡ªåŠ¨åŒ–æµ‹è¯•å’Œä»£ç è´¨é‡æ£€æŸ¥</li>
<li>å»ºç«‹è‡ªåŠ¨éƒ¨ç½²å’Œå›æ»šæœºåˆ¶</li>
<li>å»ºç«‹å‘å¸ƒæµç¨‹å’Œç‰ˆæœ¬ç®¡ç†</li>
</ol>
<h4 id="_49">äº¤ä»˜ç‰©<a class="headerlink" href="#_49" title="Permanent link">&para;</a></h4>
<ul>
<li>å®Œæ•´çš„DockeråŒ–åº”ç”¨ï¼Œæ”¯æŒä¸€é”®éƒ¨ç½²</li>
<li>ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ–¹æ¡ˆå’Œè¿ç»´æ–‡æ¡£</li>
<li>CI/CDè‡ªåŠ¨åŒ–æµæ°´çº¿</li>
<li>ç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿ</li>
</ul>
<h4 id="_50">é‡Œç¨‹ç¢‘æ£€æŸ¥<a class="headerlink" href="#_50" title="Permanent link">&para;</a></h4>
<ul>
<li>åº”ç”¨èƒ½å¤Ÿåœ¨äº‘ç«¯ç¨³å®šè¿è¡Œï¼Œå¯ç”¨æ€§&gt;99%</li>
<li>CI/CDæµæ°´çº¿è¿è¡Œæ­£å¸¸ï¼Œéƒ¨ç½²æ—¶é—´&lt;10åˆ†é’Ÿ</li>
<li>ç›‘æ§ç³»ç»Ÿèƒ½å¤ŸåŠæ—¶å‘ç°å’ŒæŠ¥å‘Šé—®é¢˜</li>
</ul>
<h4 id="_51">æµ‹è¯•é‡ç‚¹<a class="headerlink" href="#_51" title="Permanent link">&para;</a></h4>
<ul>
<li>å®¹å™¨åŒ–åº”ç”¨çš„ç¨³å®šæ€§å’Œæ€§èƒ½æµ‹è¯•</li>
<li>éƒ¨ç½²æµç¨‹çš„å¯é æ€§éªŒè¯</li>
<li>ç”Ÿäº§ç¯å¢ƒçš„å‹åŠ›å’Œç¾å¤‡æµ‹è¯•</li>
</ul>
<h3 id="45">4.5 æ•´ä½“é¡¹ç›®æ—¶é—´çº¿<a class="headerlink" href="#45" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>gantt
    title è¶³çƒé¢„æµ‹ç³»ç»Ÿå¼€å‘æ—¶é—´çº¿
    dateFormat  YYYY-MM-DD
    section é˜¶æ®µä¸€
    ç¯å¢ƒæ­å»º           :done, env, 2024-01-01, 1w
    æ•°æ®é‡‡é›†å¼€å‘       :done, collect, after env, 3w
    æ•°æ®æ¸…æ´—ç³»ç»Ÿ       :done, clean, after collect, 2w
    section é˜¶æ®µäºŒ
    ç‰¹å¾å·¥ç¨‹å¼€å‘       :active, feature, after clean, 4w
    æ¨¡å‹è®­ç»ƒç³»ç»Ÿ       :model, after feature, 3w
    æ¨¡å‹ä¼˜åŒ–é›†æˆ       :optimize, after model, 1w
    section é˜¶æ®µä¸‰
    é¢„æµ‹æœåŠ¡å¼€å‘       :api, after optimize, 4w
    å‰ç«¯åº”ç”¨å¼€å‘       :frontend, after api, 3w
    ç³»ç»Ÿé›†æˆæµ‹è¯•       :integration, after frontend, 1w
    section é˜¶æ®µå››
    å®¹å™¨åŒ–æ”¹é€          :docker, after integration, 3w
    äº‘ç«¯éƒ¨ç½²           :deploy, after docker, 2w
    CI/CDæµç¨‹         :cicd, after deploy, 1w
</code></pre></div>
<h3 id="46">4.6 é£é™©æ§åˆ¶å’Œåº”å¯¹ç­–ç•¥<a class="headerlink" href="#46" title="Permanent link">&para;</a></h3>
<h4 id="_52">ä¸»è¦é£é™©ç‚¹<a class="headerlink" href="#_52" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>æ•°æ®é‡‡é›†é£é™©</strong></li>
<li>é£é™©ï¼šAPIé™æµã€åçˆ¬è™«ã€æ•°æ®æºå˜æ›´</li>
<li>
<p>åº”å¯¹ï¼šå¤šæ•°æ®æºå¤‡ä»½ã€ä»£ç†IPæ± ã€æ¸è¿›å¼é‡‡é›†ç­–ç•¥</p>
</li>
<li>
<p><strong>æ¨¡å‹æ€§èƒ½é£é™©</strong></p>
</li>
<li>é£é™©ï¼šé¢„æµ‹å‡†ç¡®ç‡ä¸è¾¾æ ‡ã€è¿‡æ‹Ÿåˆé—®é¢˜</li>
<li>
<p>åº”å¯¹ï¼šå¤šæ¨¡å‹å¯¹æ¯”ã€äº¤å‰éªŒè¯ã€å®šæœŸé‡è®­ç»ƒ</p>
</li>
<li>
<p><strong>æŠ€æœ¯å®ç°é£é™©</strong></p>
</li>
<li>é£é™©ï¼šæŠ€æœ¯é€‰å‹ä¸å½“ã€æ€§èƒ½ç“¶é¢ˆã€æ‰©å±•æ€§é—®é¢˜</li>
<li>
<p>åº”å¯¹ï¼šåŸå‹éªŒè¯ã€å‹åŠ›æµ‹è¯•ã€æ¶æ„è¯„å®¡</p>
</li>
<li>
<p><strong>éƒ¨ç½²è¿ç»´é£é™©</strong></p>
</li>
<li>é£é™©ï¼šæœåŠ¡ä¸ç¨³å®šã€å®‰å…¨æ¼æ´ã€è¿ç»´æˆæœ¬</li>
<li>åº”å¯¹ï¼šç°åº¦éƒ¨ç½²ã€å®‰å…¨å®¡è®¡ã€æˆæœ¬ç›‘æ§</li>
</ol>
<h4 id="_53">è´¨é‡ä¿è¯æªæ–½<a class="headerlink" href="#_53" title="Permanent link">&para;</a></h4>
<ul>
<li>æ¯ä¸ªé˜¶æ®µè®¾ç½®è´¨é‡å…³å£ï¼Œä¸è¾¾æ ‡ä¸è¿›å…¥ä¸‹ä¸€é˜¶æ®µ</li>
<li>å»ºç«‹ä»£ç è¯„å®¡å’Œè‡ªåŠ¨åŒ–æµ‹è¯•æœºåˆ¶</li>
<li>å®šæœŸè¿›è¡Œæ¶æ„è¯„å®¡å’Œæ€§èƒ½åˆ†æ</li>
<li>å»ºç«‹å®Œå–„çš„æ–‡æ¡£å’ŒçŸ¥è¯†ç®¡ç†ä½“ç³»</li>
</ul>
<hr />
<h2 id="5">5. éƒ¨ç½²ä¸è¿ç»´æ¶æ„<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 æ•´ä½“éƒ¨ç½²æ¶æ„å›¾<a class="headerlink" href="#51" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>graph TB
    subgraph &quot;ç”¨æˆ·å±‚&quot;
        U1[Webç”¨æˆ·]
        U2[ç§»åŠ¨ç”¨æˆ·]
        U3[APIç”¨æˆ·]
    end

    subgraph &quot;CDN &amp; è´Ÿè½½å‡è¡¡å±‚&quot;
        CDN[CloudFlare CDN]
        ALB[Application Load Balancer]
    end

    subgraph &quot;å®¹å™¨ç¼–æ’å±‚&quot;
        K8S[Kubernetesé›†ç¾¤]
        subgraph &quot;åº”ç”¨æœåŠ¡Pod&quot;
            API1[FastAPIå®ä¾‹1]
            API2[FastAPIå®ä¾‹2]
            API3[FastAPIå®ä¾‹3]
        end
        subgraph &quot;å‰ç«¯æœåŠ¡Pod&quot;
            WEB1[Nginx + Vue.js]
            WEB2[Nginx + Vue.js]
        end
        subgraph &quot;æ•°æ®æœåŠ¡Pod&quot;
            WORKER1[æ•°æ®é‡‡é›†Worker]
            WORKER2[æ¨¡å‹è®­ç»ƒWorker]
            SCHEDULER[ä»»åŠ¡è°ƒåº¦å™¨]
        end
    end

    subgraph &quot;æ•°æ®å±‚&quot;
        subgraph &quot;æ•°æ®åº“é›†ç¾¤&quot;
            DB_MASTER[(MySQLä¸»åº“)]
            DB_SLAVE1[(MySQLä»åº“1)]
            DB_SLAVE2[(MySQLä»åº“2)]
        end
        subgraph &quot;ç¼“å­˜å±‚&quot;
            REDIS_M[(Redisä¸»)]
            REDIS_S[(Redisä»)]
        end
        subgraph &quot;å­˜å‚¨å±‚&quot;
            S3[å¯¹è±¡å­˜å‚¨&lt;br/&gt;æ¨¡å‹æ–‡ä»¶&amp;æ—¥å¿—]
        end
    end

    subgraph &quot;ç›‘æ§å±‚&quot;
        PROMETHEUS[Prometheus]
        GRAFANA[Grafana]
        ALERTMANAGER[AlertManager]
        ELK[ELK Stack]
    end

    U1 &amp; U2 &amp; U3 --&gt; CDN
    CDN --&gt; ALB
    ALB --&gt; K8S
    K8S --&gt; API1 &amp; API2 &amp; API3
    K8S --&gt; WEB1 &amp; WEB2
    K8S --&gt; WORKER1 &amp; WORKER2 &amp; SCHEDULER

    API1 &amp; API2 &amp; API3 --&gt; DB_SLAVE1 &amp; DB_SLAVE2
    API1 &amp; API2 &amp; API3 --&gt; REDIS_M
    WORKER1 &amp; WORKER2 --&gt; DB_MASTER
    SCHEDULER --&gt; REDIS_M

    DB_MASTER --&gt; DB_SLAVE1 &amp; DB_SLAVE2
    REDIS_M --&gt; REDIS_S

    K8S --&gt; S3
    K8S --&gt; PROMETHEUS
    PROMETHEUS --&gt; GRAFANA
    PROMETHEUS --&gt; ALERTMANAGER
    K8S --&gt; ELK
</code></pre></div>
<h3 id="52-docker">5.2 Dockeré•œåƒè®¾è®¡<a class="headerlink" href="#52-docker" title="Permanent link">&para;</a></h3>
<h4 id="521-api">5.2.1 APIæœåŠ¡å®¹å™¨<a class="headerlink" href="#521-api" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c"># Dockerfile.api</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">python:3.11-slim</span>

<span class="c"># è®¾ç½®å·¥ä½œç›®å½•</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>

<span class="c"># å®‰è£…ç³»ç»Ÿä¾èµ–</span>
<span class="k">RUN</span><span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>gcc<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>g++<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>curl<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>/var/lib/apt/lists/*

<span class="c"># å¤åˆ¶ä¾èµ–æ–‡ä»¶</span>
<span class="k">COPY</span><span class="w"> </span>requirements.txt<span class="w"> </span>.

<span class="c"># å®‰è£…Pythonä¾èµ–</span>
<span class="k">RUN</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--no-cache-dir<span class="w"> </span>-r<span class="w"> </span>requirements.txt

<span class="c"># å¤åˆ¶åº”ç”¨ä»£ç </span>
<span class="k">COPY</span><span class="w"> </span>src/<span class="w"> </span>./src/
<span class="k">COPY</span><span class="w"> </span>config/<span class="w"> </span>./config/

<span class="c"># è®¾ç½®ç¯å¢ƒå˜é‡</span>
<span class="k">ENV</span><span class="w"> </span><span class="nv">PYTHONPATH</span><span class="o">=</span>/app
<span class="k">ENV</span><span class="w"> </span><span class="nv">API_HOST</span><span class="o">=</span><span class="m">0</span>.0.0.0
<span class="k">ENV</span><span class="w"> </span><span class="nv">API_PORT</span><span class="o">=</span><span class="m">8000</span>

<span class="c"># å¥åº·æ£€æŸ¥</span>
<span class="k">HEALTHCHECK</span><span class="w"> </span>--interval<span class="o">=</span>30s<span class="w"> </span>--timeout<span class="o">=</span>10s<span class="w"> </span>--start-period<span class="o">=</span>60s<span class="w"> </span>--retries<span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>CMD<span class="w"> </span>curl<span class="w"> </span>-f<span class="w"> </span>http://localhost:8000/health<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>

<span class="c"># æš´éœ²ç«¯å£</span>
<span class="k">EXPOSE</span><span class="w"> </span><span class="s">8000</span>

<span class="c"># å¯åŠ¨å‘½ä»¤</span>
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;uvicorn&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;src.api.main:app&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--host&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--port&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;8000&quot;</span><span class="p">]</span>
</code></pre></div>
<h4 id="522">5.2.2 æ•°æ®é‡‡é›†å®¹å™¨<a class="headerlink" href="#522" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c"># Dockerfile.worker</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">python:3.11-slim</span>

<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>

<span class="c"># å®‰è£…Chromeå’ŒChrome Driverï¼ˆç”¨äºSeleniumï¼‰</span>
<span class="k">RUN</span><span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>wget<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>gnupg<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>unzip<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>curl<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>wget<span class="w"> </span>-q<span class="w"> </span>-O<span class="w"> </span>-<span class="w"> </span>https://dl.google.com/linux/linux_signing_key.pub<span class="w"> </span><span class="p">|</span><span class="w"> </span>apt-key<span class="w"> </span>add<span class="w"> </span>-<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/etc/apt/sources.list.d/google-chrome.list<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>google-chrome-stable<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>/var/lib/apt/lists/*

<span class="c"># å®‰è£…ChromeDriver</span>
<span class="k">RUN</span><span class="w"> </span><span class="nv">CHROME_DRIVER_VERSION</span><span class="o">=</span><span class="sb">`</span>curl<span class="w"> </span>-sS<span class="w"> </span>chromedriver.storage.googleapis.com/LATEST_RELEASE<span class="sb">`</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>wget<span class="w"> </span>-O<span class="w"> </span>/tmp/chromedriver.zip<span class="w"> </span>http://chromedriver.storage.googleapis.com/<span class="nv">$CHROME_DRIVER_VERSION</span>/chromedriver_linux64.zip<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>unzip<span class="w"> </span>/tmp/chromedriver.zip<span class="w"> </span>chromedriver<span class="w"> </span>-d<span class="w"> </span>/usr/local/bin/<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>/tmp/chromedriver.zip

<span class="k">COPY</span><span class="w"> </span>requirements.txt<span class="w"> </span>.
<span class="k">RUN</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--no-cache-dir<span class="w"> </span>-r<span class="w"> </span>requirements.txt

<span class="k">COPY</span><span class="w"> </span>src/<span class="w"> </span>./src/
<span class="k">COPY</span><span class="w"> </span>config/<span class="w"> </span>./config/

<span class="k">ENV</span><span class="w"> </span><span class="nv">PYTHONPATH</span><span class="o">=</span>/app

<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;python&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;src/workers/data_collector.py&quot;</span><span class="p">]</span>
</code></pre></div>
<h4 id="523">5.2.3 å‰ç«¯åº”ç”¨å®¹å™¨<a class="headerlink" href="#523" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c"># Dockerfile.frontend</span>
<span class="c"># æ„å»ºé˜¶æ®µ</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">node:18-alpine</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">builder</span>

<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>

<span class="k">COPY</span><span class="w"> </span>frontend/package*.json<span class="w"> </span>./
<span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>ci<span class="w"> </span>--only<span class="o">=</span>production

<span class="k">COPY</span><span class="w"> </span>frontend/<span class="w"> </span>.
<span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>run<span class="w"> </span>build

<span class="c"># ç”Ÿäº§é˜¶æ®µ</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">nginx:alpine</span>

<span class="c"># å¤åˆ¶æ„å»ºæ–‡ä»¶</span>
<span class="k">COPY</span><span class="w"> </span>--from<span class="o">=</span>builder<span class="w"> </span>/app/dist<span class="w"> </span>/usr/share/nginx/html

<span class="c"># å¤åˆ¶Nginxé…ç½®</span>
<span class="k">COPY</span><span class="w"> </span>nginx.conf<span class="w"> </span>/etc/nginx/nginx.conf

<span class="c"># å¥åº·æ£€æŸ¥</span>
<span class="k">HEALTHCHECK</span><span class="w"> </span>--interval<span class="o">=</span>30s<span class="w"> </span>--timeout<span class="o">=</span>3s<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="k">CMD</span><span class="w"> </span>curl<span class="w"> </span>-f<span class="w"> </span>http://localhost:80/<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>

<span class="k">EXPOSE</span><span class="w"> </span><span class="s">80</span>

<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;nginx&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-g&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;daemon off;&quot;</span><span class="p">]</span>
</code></pre></div>
<h3 id="53-kubernetes">5.3 Kuberneteséƒ¨ç½²é…ç½®<a class="headerlink" href="#53-kubernetes" title="Permanent link">&para;</a></h3>
<h4 id="531-api">5.3.1 APIæœåŠ¡éƒ¨ç½²<a class="headerlink" href="#531-api" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># k8s/api-deployment.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction/api:latest</span>
<span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DATABASE_URL</span>
<span class="w">          </span><span class="nt">valueFrom</span><span class="p">:</span>
<span class="w">            </span><span class="nt">secretKeyRef</span><span class="p">:</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">db-secret</span>
<span class="w">              </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">url</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REDIS_URL</span>
<span class="w">          </span><span class="nt">valueFrom</span><span class="p">:</span>
<span class="w">            </span><span class="nt">configMapKeyRef</span><span class="p">:</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-config</span>
<span class="w">              </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis-url</span>
<span class="w">        </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">          </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;512Mi&quot;</span>
<span class="w">            </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;250m&quot;</span>
<span class="w">          </span><span class="nt">limits</span><span class="p">:</span>
<span class="w">            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1Gi&quot;</span>
<span class="w">            </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;500m&quot;</span>
<span class="w">        </span><span class="nt">livenessProbe</span><span class="p">:</span>
<span class="w">          </span><span class="nt">httpGet</span><span class="p">:</span>
<span class="w">            </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/health</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<span class="w">          </span><span class="nt">initialDelaySeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<span class="w">          </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">        </span><span class="nt">readinessProbe</span><span class="p">:</span>
<span class="w">          </span><span class="nt">httpGet</span><span class="p">:</span>
<span class="w">            </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/ready</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<span class="w">          </span><span class="nt">initialDelaySeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">          </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>

<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api-service</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api</span>
<span class="w">  </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterIP</span>
</code></pre></div>
<h4 id="532">5.3.2 æ•°æ®åº“é…ç½®<a class="headerlink" href="#532" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># k8s/database-config.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-config</span>
<span class="nt">data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">my.cnf</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">[mysqld]</span>
<span class="w">    </span><span class="no">innodb_buffer_pool_size = 2G</span>
<span class="w">    </span><span class="no">innodb_log_file_size = 256M</span>
<span class="w">    </span><span class="no">max_connections = 500</span>
<span class="w">    </span><span class="no">query_cache_size = 128M</span>
<span class="w">    </span><span class="no">slow_query_log = 1</span>
<span class="w">    </span><span class="no">long_query_time = 2</span>

<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">StatefulSet</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-master</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">serviceName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-master</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-master</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-master</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql:8.0</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MYSQL_ROOT_PASSWORD</span>
<span class="w">          </span><span class="nt">valueFrom</span><span class="p">:</span>
<span class="w">            </span><span class="nt">secretKeyRef</span><span class="p">:</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-secret</span>
<span class="w">              </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">root-password</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MYSQL_DATABASE</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football_prediction</span>
<span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3306</span>
<span class="w">        </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-data</span>
<span class="w">          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/lib/mysql</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-config</span>
<span class="w">          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/mysql/conf.d</span>
<span class="w">        </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">          </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2Gi&quot;</span>
<span class="w">            </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000m&quot;</span>
<span class="w">          </span><span class="nt">limits</span><span class="p">:</span>
<span class="w">            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4Gi&quot;</span>
<span class="w">            </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2000m&quot;</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-config</span>
<span class="w">        </span><span class="nt">configMap</span><span class="p">:</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-config</span>
<span class="w">  </span><span class="nt">volumeClaimTemplates</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-data</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">accessModes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;ReadWriteOnce&quot;</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">        </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">          </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100Gi</span>
</code></pre></div>
<h4 id="533">5.3.3 è´Ÿè½½å‡è¡¡é…ç½®<a class="headerlink" href="#533" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># k8s/ingress.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-ingress</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">kubernetes.io/ingress.class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">    </span><span class="nt">cert-manager.io/cluster-issuer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">letsencrypt-prod</span>
<span class="w">    </span><span class="nt">nginx.ingress.kubernetes.io/rate-limit</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;100&quot;</span>
<span class="w">    </span><span class="nt">nginx.ingress.kubernetes.io/rate-limit-window</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1m&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tls</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api.football-prediction.com</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction.com</span>
<span class="w">    </span><span class="nt">secretName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-tls</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction.com</span>
<span class="w">    </span><span class="nt">http</span><span class="p">:</span>
<span class="w">      </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">        </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">        </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">          </span><span class="nt">service</span><span class="p">:</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-frontend-service</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span>
<span class="w">              </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api.football-prediction.com</span>
<span class="w">    </span><span class="nt">http</span><span class="p">:</span>
<span class="w">      </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">        </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">        </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">          </span><span class="nt">service</span><span class="p">:</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api-service</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span>
<span class="w">              </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div>
<h3 id="54">5.4 äº‘ç«¯ä¸æœ¬åœ°éƒ¨ç½²æ–¹æ¡ˆå¯¹æ¯”<a class="headerlink" href="#54" title="Permanent link">&para;</a></h3>
<h4 id="541">5.4.1 æœ¬åœ°éƒ¨ç½²æ–¹æ¡ˆ<a class="headerlink" href="#541" title="Permanent link">&para;</a></h4>
<p><strong>ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>å®Œå…¨å¯æ§çš„ç¯å¢ƒå’Œæ•°æ®</li>
<li>æ— éœ€æ‹…å¿ƒäº‘æœåŠ¡å•†é™åˆ¶å’Œè´¹ç”¨</li>
<li>é€‚åˆå¼€å‘æµ‹è¯•å’Œå°è§„æ¨¡ä½¿ç”¨</li>
</ul>
<p><strong>åŠ£åŠ¿ï¼š</strong></p>
<ul>
<li>éœ€è¦è‡ªå·±ç»´æŠ¤ç¡¬ä»¶å’Œç½‘ç»œ</li>
<li>æ‰©å±•æ€§æœ‰é™</li>
<li>éœ€è¦æ›´å¤šè¿ç»´å·¥ä½œ</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>å¼€å‘æµ‹è¯•ç¯å¢ƒ</li>
<li>é¢„ç®—æœ‰é™çš„ä¸ªäººé¡¹ç›®</li>
<li>å¯¹æ•°æ®å®‰å…¨è¦æ±‚æé«˜çš„åœºæ™¯</li>
</ul>
<p><strong>éƒ¨ç½²é…ç½®ï¼š</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># docker-compose.yml</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.8&#39;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">api</span><span class="p">:</span>
<span class="w">    </span><span class="nt">build</span><span class="p">:</span>
<span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.</span>
<span class="w">      </span><span class="nt">dockerfile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Dockerfile.api</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;8000:8000&quot;</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DATABASE_URL=mysql://user:pass@mysql:3306/football</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REDIS_URL=redis://redis:6379</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>

<span class="w">  </span><span class="nt">frontend</span><span class="p">:</span>
<span class="w">    </span><span class="nt">build</span><span class="p">:</span>
<span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.</span>
<span class="w">      </span><span class="nt">dockerfile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Dockerfile.frontend</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:80&quot;</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>

<span class="w">  </span><span class="nt">mysql</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql:8.0</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MYSQL_ROOT_PASSWORD=rootpassword</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MYSQL_DATABASE=football</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql_data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>

<span class="w">  </span><span class="nt">redis</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:7-alpine</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis_data:/data</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>

<span class="w">  </span><span class="nt">data_collector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">build</span><span class="p">:</span>
<span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.</span>
<span class="w">      </span><span class="nt">dockerfile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Dockerfile.worker</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DATABASE_URL=mysql://user:pass@mysql:3306/football</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">mysql_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">redis_data</span><span class="p">:</span>
</code></pre></div>
<h4 id="542">5.4.2 äº‘ç«¯éƒ¨ç½²æ–¹æ¡ˆ<a class="headerlink" href="#542" title="Permanent link">&para;</a></h4>
<p><strong>ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>é«˜å¯ç”¨æ€§å’Œè‡ªåŠ¨æ‰©å±•</li>
<li>ä¸“ä¸šçš„è¿ç»´å’Œå®‰å…¨ä¿éšœ</li>
<li>å…¨çƒCDNåŠ é€Ÿ</li>
<li>ä¸°å¯Œçš„äº‘æœåŠ¡ç”Ÿæ€</li>
</ul>
<p><strong>åŠ£åŠ¿ï¼š</strong></p>
<ul>
<li>æŒç»­çš„è¿è¥æˆæœ¬</li>
<li>å¯èƒ½çš„å‚å•†é”å®š</li>
<li>æ•°æ®ä¼ è¾“å’Œå­˜å‚¨é™åˆ¶</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²</li>
<li>éœ€è¦é«˜å¯ç”¨æ€§çš„åº”ç”¨</li>
<li>å…¨çƒç”¨æˆ·è®¿é—®çš„æœåŠ¡</li>
</ul>
<p><strong>æ¨èäº‘æœåŠ¡å•†é€‰æ‹©ï¼ˆä¼˜å…ˆé¦™æ¸¯èŠ‚ç‚¹ï¼‰ï¼š</strong></p>
<ol>
<li><strong>é˜¿é‡Œäº‘ï¼ˆé¦™æ¸¯ï¼‰</strong></li>
<li>ä¼˜åŠ¿ï¼šå¯¹å¤§é™†è®¿é—®å‹å¥½ï¼ŒæœåŠ¡ç¨³å®š</li>
<li>é€‚åˆï¼šå›½å†…å¤–åŒé‡è¦†ç›–</li>
<li>
<p>æˆæœ¬ï¼šä¸­ç­‰</p>
</li>
<li>
<p><strong>è…¾è®¯äº‘ï¼ˆé¦™æ¸¯ï¼‰</strong></p>
</li>
<li>ä¼˜åŠ¿ï¼šç½‘ç»œå»¶è¿Ÿä½ï¼Œä»·æ ¼åˆç†</li>
<li>é€‚åˆï¼šå›½å†…ç”¨æˆ·ä¸ºä¸»çš„åº”ç”¨</li>
<li>
<p>æˆæœ¬ï¼šè¾ƒä½</p>
</li>
<li>
<p><strong>AWSï¼ˆäºšå¤ª-é¦™æ¸¯ï¼‰</strong></p>
</li>
<li>ä¼˜åŠ¿ï¼šå…¨çƒåŒ–æœåŠ¡ï¼Œç”Ÿæ€ä¸°å¯Œ</li>
<li>é€‚åˆï¼šéœ€è¦å…¨çƒéƒ¨ç½²çš„åº”ç”¨</li>
<li>
<p>æˆæœ¬ï¼šè¾ƒé«˜</p>
</li>
<li>
<p><strong>Google Cloudï¼ˆé¦™æ¸¯ï¼‰</strong></p>
</li>
<li>ä¼˜åŠ¿ï¼šAI/MLæœåŠ¡å¼ºå¤§</li>
<li>é€‚åˆï¼šæœºå™¨å­¦ä¹ é‡åº¦åº”ç”¨</li>
<li>æˆæœ¬ï¼šä¸­ç­‰</li>
</ol>
<h3 id="55-kubernetes">5.5 Kubernetesæ‰©å±•é…ç½®<a class="headerlink" href="#55-kubernetes" title="Permanent link">&para;</a></h3>
<h4 id="551">5.5.1 è‡ªåŠ¨ä¼¸ç¼©é…ç½®<a class="headerlink" href="#551" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># k8s/hpa.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">autoscaling/v2</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HorizontalPodAutoscaler</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api-hpa</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">scaleTargetRef</span><span class="p">:</span>
<span class="w">    </span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api</span>
<span class="w">  </span><span class="nt">minReplicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="nt">maxReplicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">  </span><span class="nt">metrics</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Resource</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cpu</span>
<span class="w">      </span><span class="nt">target</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Utilization</span>
<span class="w">        </span><span class="nt">averageUtilization</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">70</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Resource</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">memory</span>
<span class="w">      </span><span class="nt">target</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Utilization</span>
<span class="w">        </span><span class="nt">averageUtilization</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">  </span><span class="nt">behavior</span><span class="p">:</span>
<span class="w">    </span><span class="nt">scaleUp</span><span class="p">:</span>
<span class="w">      </span><span class="nt">stabilizationWindowSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">      </span><span class="nt">policies</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pods</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">        </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">    </span><span class="nt">scaleDown</span><span class="p">:</span>
<span class="w">      </span><span class="nt">stabilizationWindowSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">300</span>
<span class="w">      </span><span class="nt">policies</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pods</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">        </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
</code></pre></div>
<h4 id="552">5.5.2 èµ„æºé…é¢ç®¡ç†<a class="headerlink" href="#552" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># k8s/resource-quota.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ResourceQuota</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-quota</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hard</span><span class="p">:</span>
<span class="w">    </span><span class="nt">requests.cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span>
<span class="w">    </span><span class="nt">requests.memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8Gi</span>
<span class="w">    </span><span class="nt">limits.cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;8&quot;</span>
<span class="w">    </span><span class="nt">limits.memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16Gi</span>
<span class="w">    </span><span class="nt">count/pods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<span class="w">    </span><span class="nt">count/services</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">    </span><span class="nt">count/secrets</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">    </span><span class="nt">count/configmaps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>

<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LimitRange</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-limits</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">limits</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">default</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500m</span>
<span class="w">      </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1Gi</span>
<span class="w">    </span><span class="nt">defaultRequest</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100m</span>
<span class="w">      </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">256Mi</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Container</span>
</code></pre></div>
<h3 id="56">5.6 ç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿ<a class="headerlink" href="#56" title="Permanent link">&para;</a></h3>
<h4 id="561-prometheus">5.6.1 Prometheusç›‘æ§é…ç½®<a class="headerlink" href="#561-prometheus" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># monitoring/prometheus-config.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prometheus-config</span>
<span class="nt">data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prometheus.yml</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">global:</span>
<span class="w">      </span><span class="no">scrape_interval: 15s</span>
<span class="w">      </span><span class="no">evaluation_interval: 15s</span>

<span class="w">    </span><span class="no">rule_files:</span>
<span class="w">      </span><span class="no">- &quot;/etc/prometheus/rules/*.yml&quot;</span>

<span class="w">    </span><span class="no">alerting:</span>
<span class="w">      </span><span class="no">alertmanagers:</span>
<span class="w">      </span><span class="no">- static_configs:</span>
<span class="w">        </span><span class="no">- targets:</span>
<span class="w">          </span><span class="no">- alertmanager:9093</span>

<span class="w">    </span><span class="no">scrape_configs:</span>
<span class="w">    </span><span class="no">- job_name: &#39;kubernetes-pods&#39;</span>
<span class="w">      </span><span class="no">kubernetes_sd_configs:</span>
<span class="w">      </span><span class="no">- role: pod</span>
<span class="w">      </span><span class="no">relabel_configs:</span>
<span class="w">      </span><span class="no">- source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_scrape]</span>
<span class="w">        </span><span class="no">action: keep</span>
<span class="w">        </span><span class="no">regex: true</span>
<span class="w">      </span><span class="no">- source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_path]</span>
<span class="w">        </span><span class="no">action: replace</span>
<span class="w">        </span><span class="no">target_label: __metrics_path__</span>
<span class="w">        </span><span class="no">regex: (.+)</span>

<span class="w">    </span><span class="no">- job_name: &#39;football-prediction-api&#39;</span>
<span class="w">      </span><span class="no">static_configs:</span>
<span class="w">      </span><span class="no">- targets: [&#39;football-prediction-api-service:80&#39;]</span>
<span class="w">      </span><span class="no">metrics_path: /metrics</span>
<span class="w">      </span><span class="no">scrape_interval: 10s</span>
</code></pre></div>
<h4 id="562">5.6.2 å‘Šè­¦è§„åˆ™é…ç½®<a class="headerlink" href="#562" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># monitoring/alert-rules.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prometheus-rules</span>
<span class="nt">data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">football-prediction.yml</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">groups:</span>
<span class="w">    </span><span class="no">- name: football-prediction</span>
<span class="w">      </span><span class="no">rules:</span>
<span class="w">      </span><span class="no">- alert: HighErrorRate</span>
<span class="w">        </span><span class="no">expr: rate(http_requests_total{status=~&quot;5..&quot;}[5m]) &gt; 0.1</span>
<span class="w">        </span><span class="no">for: 5m</span>
<span class="w">        </span><span class="no">labels:</span>
<span class="w">          </span><span class="no">severity: warning</span>
<span class="w">        </span><span class="no">annotations:</span>
<span class="w">          </span><span class="no">summary: &quot;High error rate detected&quot;</span>
<span class="w">          </span><span class="no">description: &quot;Error rate is {{ $value }} for {{ $labels.instance }}&quot;</span>

<span class="w">      </span><span class="no">- alert: HighResponseTime</span>
<span class="w">        </span><span class="no">expr: histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m])) &gt; 1</span>
<span class="w">        </span><span class="no">for: 2m</span>
<span class="w">        </span><span class="no">labels:</span>
<span class="w">          </span><span class="no">severity: warning</span>
<span class="w">        </span><span class="no">annotations:</span>
<span class="w">          </span><span class="no">summary: &quot;High response time detected&quot;</span>
<span class="w">          </span><span class="no">description: &quot;95th percentile response time is {{ $value }}s&quot;</span>

<span class="w">      </span><span class="no">- alert: DatabaseConnectionFailure</span>
<span class="w">        </span><span class="no">expr: mysql_up == 0</span>
<span class="w">        </span><span class="no">for: 1m</span>
<span class="w">        </span><span class="no">labels:</span>
<span class="w">          </span><span class="no">severity: critical</span>
<span class="w">        </span><span class="no">annotations:</span>
<span class="w">          </span><span class="no">summary: &quot;Database connection failure&quot;</span>
<span class="w">          </span><span class="no">description: &quot;MySQL database is down&quot;</span>

<span class="w">      </span><span class="no">- alert: PredictionServiceDown</span>
<span class="w">        </span><span class="no">expr: up{job=&quot;football-prediction-api&quot;} == 0</span>
<span class="w">        </span><span class="no">for: 2m</span>
<span class="w">        </span><span class="no">labels:</span>
<span class="w">          </span><span class="no">severity: critical</span>
<span class="w">        </span><span class="no">annotations:</span>
<span class="w">          </span><span class="no">summary: &quot;Prediction service is down&quot;</span>
<span class="w">          </span><span class="no">description: &quot;Football prediction API is not responding&quot;</span>
</code></pre></div>
<h4 id="563-grafana">5.6.3 Grafanaä»ªè¡¨æ¿é…ç½®<a class="headerlink" href="#563-grafana" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;dashboard&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;è¶³çƒé¢„æµ‹ç³»ç»Ÿç›‘æ§&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;panels&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;APIè¯·æ±‚QPS&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;graph&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;expr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;rate(http_requests_total[5m])&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;legendFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{method}} {{status}}&quot;</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;å“åº”æ—¶é—´åˆ†å¸ƒ&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;graph&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;expr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;histogram_quantile(0.50, rate(http_request_duration_seconds_bucket[5m]))&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;legendFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;50th percentile&quot;</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;expr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m]))&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;legendFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;95th percentile&quot;</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;æ•°æ®åº“è¿æ¥æ± çŠ¶æ€&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;stat&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;expr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mysql_global_status_threads_connected&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;legendFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Active Connections&quot;</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;é¢„æµ‹å‡†ç¡®ç‡è¶‹åŠ¿&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;graph&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;expr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;prediction_accuracy_rate&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;legendFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Accuracy Rate&quot;</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="57">5.7 å®‰å…¨é…ç½®<a class="headerlink" href="#57" title="Permanent link">&para;</a></h3>
<h4 id="571">5.7.1 ç½‘ç»œå®‰å…¨ç­–ç•¥<a class="headerlink" href="#571" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># k8s/network-policy.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetworkPolicy</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-network-policy</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">podSelector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api</span>
<span class="w">  </span><span class="nt">policyTypes</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Egress</span>
<span class="w">  </span><span class="nt">ingress</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">from</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">podSelector</span><span class="p">:</span>
<span class="w">        </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">          </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-ingress</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<span class="w">  </span><span class="nt">egress</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">to</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">podSelector</span><span class="p">:</span>
<span class="w">        </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">          </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-master</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3306</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">to</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">podSelector</span><span class="p">:</span>
<span class="w">        </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">          </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6379</span>
</code></pre></div>
<h4 id="572">5.7.2 å¯†é’¥ç®¡ç†<a class="headerlink" href="#572" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># k8s/secrets.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Secret</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">db-secret</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Opaque</span>
<span class="nt">stringData</span><span class="p">:</span>
<span class="w">  </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql://username:password@mysql-master:3306/football_prediction</span>
<span class="w">  </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app_user</span>
<span class="w">  </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secure_password_here</span>

<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Secret</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api-secret</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Opaque</span>
<span class="nt">stringData</span><span class="p">:</span>
<span class="w">  </span><span class="nt">jwt-secret</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">your_jwt_secret_key_here</span>
<span class="w">  </span><span class="nt">api-key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">your_api_key_here</span>
</code></pre></div>
<hr />
<h2 id="6">6. æœªæ¥æ‰©å±•å»ºè®®<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 æ¨¡å‹è‡ªåŠ¨æ›´æ–°æœºåˆ¶<a class="headerlink" href="#61" title="Permanent link">&para;</a></h3>
<h4 id="611">6.1.1 è‡ªåŠ¨é‡è®­ç»ƒæµæ°´çº¿<a class="headerlink" href="#611" title="Permanent link">&para;</a></h4>
<p><strong>è®¾è®¡ç›®æ ‡ï¼š</strong></p>
<ul>
<li>å®ç°æ¨¡å‹æ€§èƒ½çš„æŒç»­ç›‘æ§å’Œè‡ªåŠ¨ä¼˜åŒ–</li>
<li>åŸºäºæ–°æ•°æ®å’Œåé¦ˆå»ºç«‹è‡ªé€‚åº”å­¦ä¹ ç³»ç»Ÿ</li>
<li>ç¡®ä¿é¢„æµ‹è´¨é‡éšæ—¶é—´æ¨ç§»ä¸æ–­æå‡</li>
</ul>
<p><strong>æ ¸å¿ƒç»„ä»¶æ¶æ„ï¼š</strong></p>
<div class="highlight"><pre><span></span><code>graph TD
    A[æ•°æ®å˜åŒ–ç›‘æµ‹] --&gt; B{æ˜¯å¦éœ€è¦é‡è®­ç»ƒ}
    B --&gt;|æ˜¯| C[è‡ªåŠ¨æ•°æ®å‡†å¤‡]
    B --&gt;|å¦| D[ç»§ç»­ç›‘æ§]
    C --&gt; E[ç‰¹å¾å·¥ç¨‹æ›´æ–°]
    E --&gt; F[æ¨¡å‹è®­ç»ƒ]
    F --&gt; G[æ¨¡å‹éªŒè¯]
    G --&gt; H{æ€§èƒ½æ˜¯å¦æå‡}
    H --&gt;|æ˜¯| I[æ¨¡å‹éƒ¨ç½²]
    H --&gt;|å¦| J[å›æ»šåˆ°ä¸Šä¸€ç‰ˆæœ¬]
    I --&gt; K[A/Bæµ‹è¯•]
    K --&gt; L[æ€§èƒ½ç›‘æ§]
    L --&gt; A
    J --&gt; A
</code></pre></div>
<p><strong>å®ç°æ–¹æ¡ˆï¼š</strong></p>
<ol>
<li><strong>æ•°æ®è´¨é‡ç›‘æ§</strong></li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1"># src/ml/monitoring/data_monitor.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DataQualityMonitor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;completeness&#39;</span><span class="p">:</span> <span class="mf">0.95</span><span class="p">,</span>
            <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="mf">0.98</span><span class="p">,</span>
            <span class="s1">&#39;consistency&#39;</span><span class="p">:</span> <span class="mf">0.99</span><span class="p">,</span>
            <span class="s1">&#39;freshness&#39;</span><span class="p">:</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">3600</span>  <span class="c1"># 24å°æ—¶</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_retrain_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;æ£€æŸ¥æ˜¯å¦éœ€è¦é‡æ–°è®­ç»ƒ&quot;&quot;&quot;</span>
        <span class="n">conditions</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;data_volume&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_new_data_volume</span><span class="p">(),</span>
            <span class="s1">&#39;performance_degradation&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_model_performance</span><span class="p">(),</span>
            <span class="s1">&#39;concept_drift&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_detect_concept_drift</span><span class="p">(),</span>
            <span class="s1">&#39;scheduled&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_schedule</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">conditions</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">conditions</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_detect_concept_drift</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;æ£€æµ‹æ¦‚å¿µæ¼‚ç§»&quot;&quot;&quot;</span>
        <span class="n">recent_accuracy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_recent_accuracy</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
        <span class="n">historical_accuracy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_historical_accuracy</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">historical_accuracy</span> <span class="o">-</span> <span class="n">recent_accuracy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.05</span>
</code></pre></div>
<ol>
<li><strong>è‡ªåŠ¨è®­ç»ƒè°ƒåº¦å™¨</strong></li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1"># src/ml/training/auto_trainer.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AutoTrainer</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_registry</span> <span class="o">=</span> <span class="n">ModelRegistry</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">training_pipeline</span> <span class="o">=</span> <span class="n">TrainingPipeline</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute_retrain_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;æ‰§è¡Œè‡ªåŠ¨é‡è®­ç»ƒæµæ°´çº¿&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># 1. æ•°æ®å‡†å¤‡</span>
            <span class="n">training_data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_training_data</span><span class="p">()</span>

            <span class="c1"># 2. ç‰¹å¾å·¥ç¨‹</span>
            <span class="n">features</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_features</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>

            <span class="c1"># 3. æ¨¡å‹è®­ç»ƒ</span>
            <span class="n">new_model</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_train_model</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

            <span class="c1"># 4. æ¨¡å‹éªŒè¯</span>
            <span class="n">validation_results</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_model</span><span class="p">(</span><span class="n">new_model</span><span class="p">)</span>

            <span class="c1"># 5. æ€§èƒ½æ¯”è¾ƒ</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_model_better</span><span class="p">(</span><span class="n">validation_results</span><span class="p">):</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_deploy_model</span><span class="p">(</span><span class="n">new_model</span><span class="p">)</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_ab_test</span><span class="p">(</span><span class="n">new_model</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;æ–°æ¨¡å‹æ€§èƒ½ä¸å¦‚ç°æœ‰æ¨¡å‹ï¼Œè·³è¿‡éƒ¨ç½²&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;è‡ªåŠ¨é‡è®­ç»ƒå¤±è´¥: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_notify_failure</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
<ol>
<li><strong>æ¨¡å‹ç‰ˆæœ¬ç®¡ç†</strong></li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1"># src/ml/registry/model_registry.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ModelRegistry</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storage_backend</span> <span class="o">=</span> <span class="n">S3Backend</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata_store</span> <span class="o">=</span> <span class="n">PostgreSQLStore</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">register_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">metadata</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;æ³¨å†Œæ–°æ¨¡å‹ç‰ˆæœ¬&quot;&quot;&quot;</span>
        <span class="n">version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_version</span><span class="p">()</span>
        <span class="n">model_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;models/football_prediction/v</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># ä¿å­˜æ¨¡å‹æ–‡ä»¶</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storage_backend</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">model_path</span><span class="p">)</span>

        <span class="c1"># ä¿å­˜å…ƒæ•°æ®</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata_store</span><span class="o">.</span><span class="n">save</span><span class="p">({</span>
            <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="n">version</span><span class="p">,</span>
            <span class="s1">&#39;created_at&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
            <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;metrics&#39;</span><span class="p">],</span>
            <span class="s1">&#39;features&#39;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">],</span>
            <span class="s1">&#39;training_data_hash&#39;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;data_hash&#39;</span><span class="p">]</span>
        <span class="p">})</span>

        <span class="k">return</span> <span class="n">version</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rollback_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_version</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬&quot;&quot;&quot;</span>
        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_backend</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;models/football_prediction/v</span><span class="si">{</span><span class="n">target_version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_deploy_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;å·²å›æ»šåˆ°æ¨¡å‹ç‰ˆæœ¬ </span><span class="si">{</span><span class="n">target_version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h4 id="612-ab">6.1.2 A/Bæµ‹è¯•æ¡†æ¶<a class="headerlink" href="#612-ab" title="Permanent link">&para;</a></h4>
<p><strong>å®ç°å¤šç‰ˆæœ¬æ¨¡å‹å¹¶è¡Œæµ‹è¯•ï¼š</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># src/prediction/ab_testing/experiment.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ABTestManager</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiments</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">traffic_splitter</span> <span class="o">=</span> <span class="n">TrafficSplitter</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_experiment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">control_model</span><span class="p">,</span> <span class="n">treatment_model</span><span class="p">,</span> <span class="n">traffic_split</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;åˆ›å»ºA/Bæµ‹è¯•å®éªŒ&quot;&quot;&quot;</span>
        <span class="n">experiment</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;control_model&#39;</span><span class="p">:</span> <span class="n">control_model</span><span class="p">,</span>
            <span class="s1">&#39;treatment_model&#39;</span><span class="p">:</span> <span class="n">treatment_model</span><span class="p">,</span>
            <span class="s1">&#39;traffic_split&#39;</span><span class="p">:</span> <span class="n">traffic_split</span><span class="p">,</span>
            <span class="s1">&#39;start_time&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
            <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiments</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">experiment</span>
        <span class="k">return</span> <span class="n">experiment</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">route_prediction_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;æ ¹æ®A/Bæµ‹è¯•ç­–ç•¥è·¯ç”±é¢„æµ‹è¯·æ±‚&quot;&quot;&quot;</span>
        <span class="n">active_experiment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_active_experiment</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">active_experiment</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_should_use_treatment</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">active_experiment</span><span class="p">[</span><span class="s1">&#39;treatment_model&#39;</span><span class="p">]</span>
            <span class="n">variant</span> <span class="o">=</span> <span class="s1">&#39;treatment&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">active_experiment</span><span class="p">[</span><span class="s1">&#39;control_model&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">active_experiment</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_model</span>
            <span class="n">variant</span> <span class="o">=</span> <span class="s1">&#39;control&#39;</span>

        <span class="c1"># æ‰§è¡Œé¢„æµ‹</span>
        <span class="n">prediction</span> <span class="o">=</span> <span class="k">await</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

        <span class="c1"># è®°å½•å®éªŒæ•°æ®</span>
        <span class="k">if</span> <span class="n">active_experiment</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_experiment_data</span><span class="p">(</span><span class="n">active_experiment</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">variant</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">prediction</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">prediction</span>
</code></pre></div>
<h3 id="62">6.2 å®æ—¶èµ”ç‡å’Œçƒé˜ŸåŠ¨æ€å¢é‡é‡‡é›†<a class="headerlink" href="#62" title="Permanent link">&para;</a></h3>
<h4 id="621">6.2.1 å®æ—¶æ•°æ®æµå¤„ç†æ¶æ„<a class="headerlink" href="#621" title="Permanent link">&para;</a></h4>
<p><strong>æŠ€æœ¯é€‰å‹ï¼š</strong></p>
<ul>
<li>Apache Kafkaä½œä¸ºæ¶ˆæ¯é˜Ÿåˆ—</li>
<li>Apache Flink/Spark Streamingè¿›è¡Œæµå¤„ç†</li>
<li>WebSocketè¿æ¥è·å–å®æ—¶èµ”ç‡å˜åŒ–</li>
</ul>
<p><strong>æ¶æ„è®¾è®¡ï¼š</strong></p>
<div class="highlight"><pre><span></span><code>graph LR
    subgraph &quot;æ•°æ®æº&quot;
        A1[åšå½©ç½‘ç«™WebSocket]
        A2[ä½“è‚²æ•°æ®API]
        A3[ç¤¾äº¤åª’ä½“ç›‘æ§]
        A4[æ–°é—»çˆ¬è™«]
    end

    subgraph &quot;æ¶ˆæ¯é˜Ÿåˆ—&quot;
        B[Apache Kafka]
    end

    subgraph &quot;æµå¤„ç†&quot;
        C1[Flink - èµ”ç‡å¤„ç†]
        C2[Flink - æ–°é—»åˆ†æ]
        C3[Flink - ç¤¾åª’æƒ…æ„Ÿ]
    end

    subgraph &quot;å®æ—¶å­˜å‚¨&quot;
        D1[(Redis Stream)]
        D2[(InfluxDB)]
    end

    subgraph &quot;é¢„æµ‹æœåŠ¡&quot;
        E[å®æ—¶é¢„æµ‹å¼•æ“]
    end

    A1 &amp; A2 &amp; A3 &amp; A4 --&gt; B
    B --&gt; C1 &amp; C2 &amp; C3
    C1 &amp; C2 &amp; C3 --&gt; D1 &amp; D2
    D1 &amp; D2 --&gt; E
</code></pre></div>
<p><strong>å®ç°æ–¹æ¡ˆï¼š</strong></p>
<ol>
<li><strong>å®æ—¶èµ”ç‡é‡‡é›†å™¨</strong></li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1"># src/real_time/collectors/odds_stream.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RealTimeOddsCollector</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kafka_producer</span> <span class="o">=</span> <span class="n">KafkaProducer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">websocket_connections</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">start_odds_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bookmakers</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;å¯åŠ¨å®æ—¶èµ”ç‡æµé‡‡é›†&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">bookmaker</span> <span class="ow">in</span> <span class="n">bookmakers</span><span class="p">:</span>
            <span class="n">connection</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_websocket_connection</span><span class="p">(</span><span class="n">bookmaker</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">websocket_connections</span><span class="p">[</span><span class="n">bookmaker</span><span class="p">]</span> <span class="o">=</span> <span class="n">connection</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle_odds_stream</span><span class="p">(</span><span class="n">bookmaker</span><span class="p">,</span> <span class="n">connection</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_handle_odds_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bookmaker</span><span class="p">,</span> <span class="n">connection</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;å¤„ç†èµ”ç‡æµæ•°æ®&quot;&quot;&quot;</span>
        <span class="k">async</span> <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">connection</span><span class="p">:</span>
            <span class="n">odds_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_odds_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">bookmaker</span><span class="p">)</span>

            <span class="c1"># å‘é€åˆ°Kafka</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">kafka_producer</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;odds_stream&#39;</span><span class="p">,</span> <span class="p">{</span>
                <span class="s1">&#39;bookmaker&#39;</span><span class="p">:</span> <span class="n">bookmaker</span><span class="p">,</span>
                <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">odds_data</span>
            <span class="p">})</span>

            <span class="c1"># æ£€æµ‹æ˜¾è‘—å˜åŒ–</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_detect_significant_change</span><span class="p">(</span><span class="n">odds_data</span><span class="p">):</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_prediction_update</span><span class="p">(</span><span class="n">odds_data</span><span class="p">)</span>
</code></pre></div>
<ol>
<li><strong>æµå¤„ç†å¼•æ“</strong></li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1"># src/real_time/processors/odds_processor.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">OddsStreamProcessor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flink_env</span> <span class="o">=</span> <span class="n">StreamExecutionEnvironment</span><span class="o">.</span><span class="n">get_execution_environment</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_processing_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;åˆ›å»ºèµ”ç‡æµå¤„ç†ç®¡é“&quot;&quot;&quot;</span>
        <span class="c1"># ä»Kafkaè¯»å–èµ”ç‡æµ</span>
        <span class="n">odds_stream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flink_env</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span>
            <span class="n">FlinkKafkaConsumer</span><span class="p">(</span><span class="s1">&#39;odds_stream&#39;</span><span class="p">,</span> <span class="n">SimpleStringSchema</span><span class="p">(),</span> <span class="n">kafka_props</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># æ•°æ®æ¸…æ´—å’Œæ ‡å‡†åŒ–</span>
        <span class="n">cleaned_stream</span> <span class="o">=</span> <span class="n">odds_stream</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_clean_odds_data</span><span class="p">)</span>

        <span class="c1"># è®¡ç®—ç§»åŠ¨å¹³å‡å’Œè¶‹åŠ¿</span>
        <span class="n">windowed_stream</span> <span class="o">=</span> <span class="n">cleaned_stream</span><span class="o">.</span><span class="n">key_by</span><span class="p">(</span><span class="s1">&#39;match_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">time_window</span><span class="p">(</span><span class="n">Time</span><span class="o">.</span><span class="n">minutes</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
        <span class="n">trend_stream</span> <span class="o">=</span> <span class="n">windowed_stream</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">OddsTrendCalculator</span><span class="p">())</span>

        <span class="c1"># æ£€æµ‹å¼‚å¸¸æ³¢åŠ¨</span>
        <span class="n">anomaly_stream</span> <span class="o">=</span> <span class="n">trend_stream</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">AnomalyDetector</span><span class="p">())</span>

        <span class="c1"># è¾“å‡ºåˆ°å­˜å‚¨ç³»ç»Ÿ</span>
        <span class="n">trend_stream</span><span class="o">.</span><span class="n">add_sink</span><span class="p">(</span><span class="n">RedisSink</span><span class="p">(</span><span class="s1">&#39;odds_trends&#39;</span><span class="p">))</span>
        <span class="n">anomaly_stream</span><span class="o">.</span><span class="n">add_sink</span><span class="p">(</span><span class="n">AlertingSink</span><span class="p">(</span><span class="s1">&#39;odds_anomalies&#39;</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flink_env</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;OddsProcessingJob&quot;</span><span class="p">)</span>
</code></pre></div>
<h4 id="622">6.2.2 çƒé˜ŸåŠ¨æ€ä¿¡æ¯é‡‡é›†<a class="headerlink" href="#622" title="Permanent link">&para;</a></h4>
<p><strong>ä¿¡æ¯æºæ•´åˆï¼š</strong></p>
<ul>
<li>å®˜æ–¹çƒé˜Ÿç½‘ç«™å’Œç¤¾äº¤åª’ä½“</li>
<li>ä½“è‚²æ–°é—»ç½‘ç«™</li>
<li>çƒå‘˜ä¼¤ç—…æŠ¥å‘Š</li>
<li>è½¬ä¼šå¸‚åœºä¿¡æ¯</li>
</ul>
<p><strong>å®ç°æ–¹æ¡ˆï¼š</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># src/real_time/collectors/team_news.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TeamNewsCollector</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">news_sources</span> <span class="o">=</span> <span class="n">NewsSourceRegistry</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nlp_processor</span> <span class="o">=</span> <span class="n">NLPProcessor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kafka_producer</span> <span class="o">=</span> <span class="n">KafkaProducer</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">collect_team_news</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">teams</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;é‡‡é›†çƒé˜ŸåŠ¨æ€æ–°é—»&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">teams</span><span class="p">:</span>
            <span class="n">news_items</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_team_news</span><span class="p">(</span><span class="n">team</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">news</span> <span class="ow">in</span> <span class="n">news_items</span><span class="p">:</span>
                <span class="c1"># NLPåˆ†ææ–°é—»å†…å®¹</span>
                <span class="n">analysis</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlp_processor</span><span class="o">.</span><span class="n">analyze_news</span><span class="p">(</span><span class="n">news</span><span class="p">)</span>

                <span class="c1"># æå–å…³é”®ä¿¡æ¯</span>
                <span class="n">extracted_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_key_info</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">extracted_info</span><span class="p">[</span><span class="s1">&#39;importance&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">:</span>  <span class="c1"># é«˜é‡è¦æ€§æ–°é—»</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_to_processing</span><span class="p">(</span><span class="n">team</span><span class="p">,</span> <span class="n">extracted_info</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_key_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analysis</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;æå–å…³é”®ä¿¡æ¯&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;player_injuries&#39;</span><span class="p">:</span> <span class="n">analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;injuries&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="s1">&#39;lineup_changes&#39;</span><span class="p">:</span> <span class="n">analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lineup_changes&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="s1">&#39;coaching_changes&#39;</span><span class="p">:</span> <span class="n">analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;coaching_news&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="s1">&#39;sentiment_score&#39;</span><span class="p">:</span> <span class="n">analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sentiment&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;importance&#39;</span><span class="p">:</span> <span class="n">analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;importance_score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">}</span>
</code></pre></div>
<h3 id="63">6.3 é«˜å¹¶å‘æ¶æ„ä¼˜åŒ–<a class="headerlink" href="#63" title="Permanent link">&para;</a></h3>
<h4 id="631">6.3.1 ç¼“å­˜ç­–ç•¥å‡çº§<a class="headerlink" href="#631" title="Permanent link">&para;</a></h4>
<p><strong>å¤šå±‚ç¼“å­˜æ¶æ„ï¼š</strong></p>
<div class="highlight"><pre><span></span><code>graph TD
    A[ç”¨æˆ·è¯·æ±‚] --&gt; B[CDNç¼“å­˜]
    B --&gt; C{ç¼“å­˜å‘½ä¸­?}
    C --&gt;|æ˜¯| D[è¿”å›ç»“æœ]
    C --&gt;|å¦| E[åº”ç”¨å±‚ç¼“å­˜ - Redis]
    E --&gt; F{ç¼“å­˜å‘½ä¸­?}
    F --&gt;|æ˜¯| G[è¿”å›ç»“æœ]
    F --&gt;|å¦| H[æ•°æ®åº“ç¼“å­˜ - Redis]
    H --&gt; I{ç¼“å­˜å‘½ä¸­?}
    I --&gt;|æ˜¯| J[è¿”å›ç»“æœ]
    I --&gt;|å¦| K[æ•°æ®åº“æŸ¥è¯¢]
    K --&gt; L[æ›´æ–°æ‰€æœ‰ç¼“å­˜å±‚]
    L --&gt; M[è¿”å›ç»“æœ]
</code></pre></div>
<p><strong>ç¼“å­˜å®ç°ç­–ç•¥ï¼š</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># src/cache/multi_level_cache.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MultiLevelCache</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l1_cache</span> <span class="o">=</span> <span class="n">LocalLRUCache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>  <span class="c1"># æœ¬åœ°ç¼“å­˜</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l2_cache</span> <span class="o">=</span> <span class="n">RedisCache</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;redis-cluster&#39;</span><span class="p">)</span>  <span class="c1"># åˆ†å¸ƒå¼ç¼“å­˜</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l3_cache</span> <span class="o">=</span> <span class="n">DatabaseQueryCache</span><span class="p">()</span>  <span class="c1"># æŸ¥è¯¢ç»“æœç¼“å­˜</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">match_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;å¤šçº§ç¼“å­˜è·å–é¢„æµ‹ç»“æœ&quot;&quot;&quot;</span>
        <span class="c1"># L1 ç¼“å­˜ - æœ¬åœ°å†…å­˜</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">l1_cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;prediction:</span><span class="si">{</span><span class="n">match_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="c1"># L2 ç¼“å­˜ - Redis</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">l2_cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;prediction:</span><span class="si">{</span><span class="n">match_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">l1_cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;prediction:</span><span class="si">{</span><span class="n">match_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="c1"># L3 ç¼“å­˜ - æ•°æ®åº“æŸ¥è¯¢ç¼“å­˜</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">l3_cache</span><span class="o">.</span><span class="n">get_or_compute</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;prediction:</span><span class="si">{</span><span class="n">match_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_prediction</span><span class="p">(</span><span class="n">match_id</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># æ›´æ–°ä¸Šå±‚ç¼“å­˜</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">l2_cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;prediction:</span><span class="si">{</span><span class="n">match_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">1800</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l1_cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;prediction:</span><span class="si">{</span><span class="n">match_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">invalidate_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">match_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;é¢„æµ‹ç»“æœå¤±æ•ˆå¤„ç†&quot;&quot;&quot;</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;prediction:</span><span class="si">{</span><span class="n">match_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;features:</span><span class="si">{</span><span class="n">match_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>

        <span class="c1"># åˆ é™¤æ‰€æœ‰å±‚çº§çš„ç¼“å­˜</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">l1_cache</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">l2_cache</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">l3_cache</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</code></pre></div>
<h4 id="632">6.3.2 æ¶ˆæ¯é˜Ÿåˆ—æ¶æ„<a class="headerlink" href="#632" title="Permanent link">&para;</a></h4>
<p><strong>å¼‚æ­¥å¤„ç†ç³»ç»Ÿï¼š</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># src/messaging/task_queue.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TaskQueueManager</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">celery_app</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">(</span><span class="s1">&#39;football_prediction&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kafka_producer</span> <span class="o">=</span> <span class="n">KafkaProducer</span><span class="p">()</span>

    <span class="nd">@celery_app</span><span class="o">.</span><span class="n">task</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">process_prediction_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">match_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;å¼‚æ­¥å¤„ç†é¢„æµ‹è¯·æ±‚&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># ç‰¹å¾è®¡ç®—</span>
            <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_features</span><span class="p">(</span><span class="n">match_data</span><span class="p">)</span>

            <span class="c1"># æ¨¡å‹é¢„æµ‹</span>
            <span class="n">prediction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_prediction</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

            <span class="c1"># ç¼“å­˜ç»“æœ</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cache_prediction_result</span><span class="p">(</span><span class="n">match_data</span><span class="p">[</span><span class="s1">&#39;match_id&#39;</span><span class="p">],</span> <span class="n">prediction</span><span class="p">)</span>

            <span class="c1"># å‘é€ç»“æœé€šçŸ¥</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_notify_prediction_ready</span><span class="p">(</span><span class="n">match_data</span><span class="p">[</span><span class="s1">&#39;match_id&#39;</span><span class="p">],</span> <span class="n">prediction</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">retries</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span><span class="p">:</span>
                <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">countdown</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_handle_prediction_failure</span><span class="p">(</span><span class="n">match_data</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">))</span>
</code></pre></div>
<h4 id="633">6.3.3 æ•°æ®åº“è¯»å†™åˆ†ç¦»å’Œåˆ†ç‰‡<a class="headerlink" href="#633" title="Permanent link">&para;</a></h4>
<p><strong>æ•°æ®åº“é›†ç¾¤æ¶æ„ï¼š</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># src/database/cluster_manager.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DatabaseClusterManager</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_master_connection</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_dbs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_read_replicas</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shard_router</span> <span class="o">=</span> <span class="n">ShardRouter</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_read_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_type</span><span class="o">=</span><span class="s1">&#39;general&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;è·å–è¯»è¿æ¥&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">query_type</span> <span class="o">==</span> <span class="s1">&#39;analytics&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_dbs</span><span class="p">[</span><span class="s1">&#39;analytics_replica&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">query_type</span> <span class="o">==</span> <span class="s1">&#39;realtime&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_dbs</span><span class="p">[</span><span class="s1">&#39;realtime_replica&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_dbs</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_write_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">shard_key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;è·å–å†™è¿æ¥&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">shard_key</span><span class="p">:</span>
            <span class="n">shard</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shard_router</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">shard_key</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_db</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;shard_</span><span class="si">{</span><span class="n">shard</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_db</span><span class="p">[</span><span class="s1">&#39;master&#39;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute_read_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;æ‰§è¡Œè¯»æŸ¥è¯¢&quot;&quot;&quot;</span>
        <span class="n">connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_read_connection</span><span class="p">()</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">connection</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute_write_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shard_key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;æ‰§è¡Œå†™æŸ¥è¯¢&quot;&quot;&quot;</span>
        <span class="n">connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_write_connection</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">shard_key</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</code></pre></div>
<h3 id="64">6.4 ç”¨æˆ·ç”»åƒå’Œä¸ªæ€§åŒ–æ¨è<a class="headerlink" href="#64" title="Permanent link">&para;</a></h3>
<h4 id="641">6.4.1 ç”¨æˆ·è¡Œä¸ºåˆ†æç³»ç»Ÿ<a class="headerlink" href="#641" title="Permanent link">&para;</a></h4>
<p><strong>ç”¨æˆ·ç”»åƒå»ºæ¨¡ï¼š</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># src/personalization/user_profiling.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserProfiler</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">behavior_tracker</span> <span class="o">=</span> <span class="n">BehaviorTracker</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preference_engine</span> <span class="o">=</span> <span class="n">PreferenceEngine</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span> <span class="o">=</span> <span class="n">UserClusteringModel</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build_user_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;æ„å»ºç”¨æˆ·ç”»åƒ&quot;&quot;&quot;</span>
        <span class="c1"># æ”¶é›†ç”¨æˆ·è¡Œä¸ºæ•°æ®</span>
        <span class="n">behaviors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">behavior_tracker</span><span class="o">.</span><span class="n">get_user_behaviors</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>

        <span class="c1"># åˆ†æç”¨æˆ·åå¥½</span>
        <span class="n">preferences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_preferences</span><span class="p">(</span><span class="n">behaviors</span><span class="p">)</span>

        <span class="c1"># ç”¨æˆ·èšç±»</span>
        <span class="n">cluster</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="o">.</span><span class="n">predict_cluster</span><span class="p">(</span><span class="n">preferences</span><span class="p">)</span>

        <span class="n">profile</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
            <span class="s1">&#39;favorite_teams&#39;</span><span class="p">:</span> <span class="n">preferences</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;teams&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="s1">&#39;favorite_leagues&#39;</span><span class="p">:</span> <span class="n">preferences</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;leagues&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="s1">&#39;prediction_accuracy_interest&#39;</span><span class="p">:</span> <span class="n">preferences</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;accuracy_focus&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
            <span class="s1">&#39;risk_tolerance&#39;</span><span class="p">:</span> <span class="n">preferences</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;risk_tolerance&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">),</span>
            <span class="s1">&#39;interaction_frequency&#39;</span><span class="p">:</span> <span class="n">behaviors</span><span class="p">[</span><span class="s1">&#39;frequency&#39;</span><span class="p">],</span>
            <span class="s1">&#39;cluster&#39;</span><span class="p">:</span> <span class="n">cluster</span><span class="p">,</span>
            <span class="s1">&#39;created_at&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">profile</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_analyze_preferences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">behaviors</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;åˆ†æç”¨æˆ·åå¥½&quot;&quot;&quot;</span>
        <span class="n">team_interactions</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">league_interactions</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">behavior</span> <span class="ow">in</span> <span class="n">behaviors</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">behavior</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;view_prediction&#39;</span><span class="p">:</span>
                <span class="n">match_info</span> <span class="o">=</span> <span class="n">behavior</span><span class="p">[</span><span class="s1">&#39;match_info&#39;</span><span class="p">]</span>
                <span class="n">team_interactions</span><span class="p">[</span><span class="n">match_info</span><span class="p">[</span><span class="s1">&#39;home_team&#39;</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">team_interactions</span><span class="p">[</span><span class="n">match_info</span><span class="p">[</span><span class="s1">&#39;away_team&#39;</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">league_interactions</span><span class="p">[</span><span class="n">match_info</span><span class="p">[</span><span class="s1">&#39;league&#39;</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;teams&#39;</span><span class="p">:</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">team_interactions</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                          <span class="n">key</span><span class="o">=</span><span class="n">team_interactions</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">5</span><span class="p">],</span>
            <span class="s1">&#39;leagues&#39;</span><span class="p">:</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">league_interactions</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                            <span class="n">key</span><span class="o">=</span><span class="n">league_interactions</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">3</span><span class="p">],</span>
            <span class="s1">&#39;accuracy_focus&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_accuracy_focus</span><span class="p">(</span><span class="n">behaviors</span><span class="p">),</span>
            <span class="s1">&#39;risk_tolerance&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_risk_tolerance</span><span class="p">(</span><span class="n">behaviors</span><span class="p">)</span>
        <span class="p">}</span>
</code></pre></div>
<h4 id="642">6.4.2 ä¸ªæ€§åŒ–æ¨èå¼•æ“<a class="headerlink" href="#642" title="Permanent link">&para;</a></h4>
<p><strong>æ¨èç®—æ³•å®ç°ï¼š</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># src/personalization/recommendation_engine.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PersonalizedRecommendationEngine</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collaborative_filter</span> <span class="o">=</span> <span class="n">CollaborativeFiltering</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_filter</span> <span class="o">=</span> <span class="n">ContentBasedFiltering</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hybrid_model</span> <span class="o">=</span> <span class="n">HybridRecommendationModel</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_personalized_matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;è·å–ä¸ªæ€§åŒ–æ¯”èµ›æ¨è&quot;&quot;&quot;</span>
        <span class="n">user_profile</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_user_profile</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>

        <span class="c1"># åŸºäºå†…å®¹çš„è¿‡æ»¤</span>
        <span class="n">content_recommendations</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">content_filter</span><span class="o">.</span><span class="n">recommend</span><span class="p">(</span>
            <span class="n">user_profile</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="o">*</span><span class="mi">2</span>
        <span class="p">)</span>

        <span class="c1"># ååŒè¿‡æ»¤</span>
        <span class="n">collaborative_recommendations</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">collaborative_filter</span><span class="o">.</span><span class="n">recommend</span><span class="p">(</span>
            <span class="n">user_id</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="o">*</span><span class="mi">2</span>
        <span class="p">)</span>

        <span class="c1"># æ··åˆæ¨è</span>
        <span class="n">final_recommendations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hybrid_model</span><span class="o">.</span><span class="n">combine_recommendations</span><span class="p">(</span>
            <span class="n">content_recommendations</span><span class="p">,</span>
            <span class="n">collaborative_recommendations</span><span class="p">,</span>
            <span class="n">user_profile</span><span class="p">,</span>
            <span class="n">limit</span><span class="o">=</span><span class="n">limit</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">final_recommendations</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_personalized_insights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">match_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;è·å–ä¸ªæ€§åŒ–é¢„æµ‹è§è§£&quot;&quot;&quot;</span>
        <span class="n">user_profile</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_user_profile</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
        <span class="n">base_prediction</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_prediction</span><span class="p">(</span><span class="n">match_id</span><span class="p">)</span>

        <span class="c1"># æ ¹æ®ç”¨æˆ·åå¥½è°ƒæ•´å±•ç¤ºå†…å®¹</span>
        <span class="n">insights</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;prediction&#39;</span><span class="p">:</span> <span class="n">base_prediction</span><span class="p">,</span>
            <span class="s1">&#39;confidence_explanation&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_confidence_explanation</span><span class="p">(</span>
                <span class="n">base_prediction</span><span class="p">,</span> <span class="n">user_profile</span>
            <span class="p">),</span>
            <span class="s1">&#39;key_factors&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_personalize_key_factors</span><span class="p">(</span>
                <span class="n">base_prediction</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">],</span> <span class="n">user_profile</span>
            <span class="p">),</span>
            <span class="s1">&#39;similar_matches&#39;</span><span class="p">:</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_similar_matches</span><span class="p">(</span>
                <span class="n">match_id</span><span class="p">,</span> <span class="n">user_profile</span>
            <span class="p">)</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">insights</span>
</code></pre></div>
<h4 id="643">6.4.3 æ¨èç³»ç»Ÿè¯„ä¼°æ¡†æ¶<a class="headerlink" href="#643" title="Permanent link">&para;</a></h4>
<p><strong>A/Bæµ‹è¯•å’Œæ•ˆæœè¯„ä¼°ï¼š</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># src/personalization/evaluation.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RecommendationEvaluator</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_calculator</span> <span class="o">=</span> <span class="n">MetricsCalculator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ab_tester</span> <span class="o">=</span> <span class="n">ABTester</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_recommendation_quality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recommendations</span><span class="p">,</span> <span class="n">user_interactions</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;è¯„ä¼°æ¨èè´¨é‡&quot;&quot;&quot;</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;precision&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_precision</span><span class="p">(</span><span class="n">recommendations</span><span class="p">,</span> <span class="n">user_interactions</span><span class="p">),</span>
            <span class="s1">&#39;recall&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_recall</span><span class="p">(</span><span class="n">recommendations</span><span class="p">,</span> <span class="n">user_interactions</span><span class="p">),</span>
            <span class="s1">&#39;f1_score&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_f1_score</span><span class="p">(</span><span class="n">recommendations</span><span class="p">,</span> <span class="n">user_interactions</span><span class="p">),</span>
            <span class="s1">&#39;diversity&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_diversity</span><span class="p">(</span><span class="n">recommendations</span><span class="p">),</span>
            <span class="s1">&#39;novelty&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_novelty</span><span class="p">(</span><span class="n">recommendations</span><span class="p">,</span> <span class="n">user_interactions</span><span class="p">),</span>
            <span class="s1">&#39;coverage&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_coverage</span><span class="p">(</span><span class="n">recommendations</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">metrics</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run_recommendation_ab_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control_algorithm</span><span class="p">,</span> <span class="n">treatment_algorithm</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;è¿è¡Œæ¨èç®—æ³•A/Bæµ‹è¯•&quot;&quot;&quot;</span>
        <span class="n">test_users</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_select_test_users</span><span class="p">()</span>

        <span class="c1"># åˆ†é…ç”¨æˆ·åˆ°å¯¹ç…§ç»„å’Œå®éªŒç»„</span>
        <span class="n">control_group</span><span class="p">,</span> <span class="n">treatment_group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_split_users</span><span class="p">(</span><span class="n">test_users</span><span class="p">)</span>

        <span class="c1"># è¿è¡Œæµ‹è¯•</span>
        <span class="n">control_results</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_recommendation_test</span><span class="p">(</span>
            <span class="n">control_group</span><span class="p">,</span> <span class="n">control_algorithm</span>
        <span class="p">)</span>
        <span class="n">treatment_results</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_recommendation_test</span><span class="p">(</span>
            <span class="n">treatment_group</span><span class="p">,</span> <span class="n">treatment_algorithm</span>
        <span class="p">)</span>

        <span class="c1"># ç»Ÿè®¡åˆ†æ</span>
        <span class="n">significance_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_perform_significance_test</span><span class="p">(</span>
            <span class="n">control_results</span><span class="p">,</span> <span class="n">treatment_results</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;control_metrics&#39;</span><span class="p">:</span> <span class="n">control_results</span><span class="p">[</span><span class="s1">&#39;metrics&#39;</span><span class="p">],</span>
            <span class="s1">&#39;treatment_metrics&#39;</span><span class="p">:</span> <span class="n">treatment_results</span><span class="p">[</span><span class="s1">&#39;metrics&#39;</span><span class="p">],</span>
            <span class="s1">&#39;statistical_significance&#39;</span><span class="p">:</span> <span class="n">significance_test</span><span class="p">,</span>
            <span class="s1">&#39;recommendation&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_algorithm_recommendation</span><span class="p">(</span><span class="n">significance_test</span><span class="p">)</span>
        <span class="p">}</span>
</code></pre></div>
<h3 id="65">6.5 ç³»ç»Ÿæ‰©å±•æ€»ç»“<a class="headerlink" href="#65" title="Permanent link">&para;</a></h3>
<h4 id="651">6.5.1 æ‰©å±•ä¼˜å…ˆçº§æ’åº<a class="headerlink" href="#651" title="Permanent link">&para;</a></h4>
<p><strong>ç¬¬ä¸€ä¼˜å…ˆçº§ï¼ˆ6ä¸ªæœˆå†…ï¼‰ï¼š</strong></p>
<ol>
<li>æ¨¡å‹è‡ªåŠ¨æ›´æ–°æœºåˆ¶ - ä¿è¯é¢„æµ‹è´¨é‡æŒç»­ä¼˜åŒ–</li>
<li>å®æ—¶èµ”ç‡é‡‡é›† - æä¾›æ›´åŠæ—¶çš„å¸‚åœºä¿¡æ¯</li>
<li>å¤šå±‚ç¼“å­˜æ¶æ„ - æ”¯æ’‘é«˜å¹¶å‘è®¿é—®éœ€æ±‚</li>
</ol>
<p><strong>ç¬¬äºŒä¼˜å…ˆçº§ï¼ˆ12ä¸ªæœˆå†…ï¼‰ï¼š</strong></p>
<ol>
<li>ç”¨æˆ·ç”»åƒç³»ç»Ÿ - æå‡ç”¨æˆ·ä½“éªŒå’Œç²˜æ€§</li>
<li>æ¶ˆæ¯é˜Ÿåˆ—ä¼˜åŒ– - æé«˜ç³»ç»Ÿå“åº”æ€§å’Œå¯é æ€§</li>
<li>æ•°æ®åº“é›†ç¾¤åŒ– - æ”¯æ’‘æ›´å¤§è§„æ¨¡æ•°æ®å¤„ç†</li>
</ol>
<p><strong>ç¬¬ä¸‰ä¼˜å…ˆçº§ï¼ˆ18ä¸ªæœˆå†…ï¼‰ï¼š</strong></p>
<ol>
<li>ä¸ªæ€§åŒ–æ¨èå¼•æ“ - å¢å¼ºäº§å“ç«äº‰åŠ›</li>
<li>é«˜çº§åˆ†æåŠŸèƒ½ - æä¾›æ›´æ·±å…¥çš„æ•°æ®è§è§£</li>
<li>å¤šè¯­è¨€å’Œå¤šåœ°åŒºæ”¯æŒ - æ‰©å¤§ç”¨æˆ·è¦†ç›–é¢</li>
</ol>
<h4 id="652">6.5.2 æŠ€æœ¯å€ºåŠ¡ç®¡ç†<a class="headerlink" href="#652" title="Permanent link">&para;</a></h4>
<p><strong>ä»£ç é‡æ„è®¡åˆ’ï¼š</strong></p>
<ul>
<li>å»ºç«‹ä»£ç è´¨é‡ç›‘æ§å’Œè‡ªåŠ¨é‡æ„å·¥å…·</li>
<li>å®šæœŸè¿›è¡Œæ¶æ„è¯„å®¡å’ŒæŠ€æœ¯å€ºåŠ¡æ¸…ç†</li>
<li>å®æ–½å¾®æœåŠ¡æ‹†åˆ†ï¼Œæé«˜ç³»ç»Ÿæ¨¡å—åŒ–ç¨‹åº¦</li>
</ul>
<p><strong>æ€§èƒ½ä¼˜åŒ–è·¯çº¿å›¾ï¼š</strong></p>
<ul>
<li>å»ºç«‹æ€§èƒ½åŸºå‡†æµ‹è¯•å’ŒæŒç»­ç›‘æ§</li>
<li>å®æ–½æ¸è¿›å¼æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</li>
<li>å®šæœŸè¿›è¡Œå®¹é‡è§„åˆ’å’Œæ‰©å®¹é¢„æ¡ˆ</li>
</ul>
<p><strong>å®‰å…¨åŠ å›ºæªæ–½ï¼š</strong></p>
<ul>
<li>å®æ–½é›¶ä¿¡ä»»å®‰å…¨æ¶æ„</li>
<li>å»ºç«‹å®‰å…¨æ¼æ´æ‰«æå’Œä¿®å¤æµç¨‹</li>
<li>åŠ å¼ºæ•°æ®åŠ å¯†å’Œéšç§ä¿æŠ¤æªæ–½</li>
</ul>
<hr />
<h2 id="_54">ğŸ“„ æ–‡æ¡£ç‰ˆæœ¬ä¿¡æ¯<a class="headerlink" href="#_54" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>æ–‡æ¡£ç‰ˆæœ¬</strong>ï¼šv1.0</li>
<li><strong>åˆ›å»ºæ—¥æœŸ</strong>ï¼š2024å¹´1æœˆ</li>
<li><strong>æœ€åæ›´æ–°</strong>ï¼š2024å¹´1æœˆ</li>
<li><strong>è´Ÿè´£äºº</strong>ï¼šç³»ç»Ÿæ¶æ„å›¢é˜Ÿ</li>
<li><strong>å®¡æ ¸çŠ¶æ€</strong>ï¼šå·²å®¡æ ¸é€šè¿‡</li>
</ul>
<h2 id="_55">ğŸ“ è”ç³»ä¿¡æ¯<a class="headerlink" href="#_55" title="Permanent link">&para;</a></h2>
<p>å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»å¼€å‘å›¢é˜Ÿï¼š</p>
<ul>
<li><strong>é‚®ç®±</strong>ï¼š<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#100;&#101;&#118;&#45;&#116;&#101;&#97;&#109;&#64;&#102;&#111;&#111;&#116;&#98;&#97;&#108;&#108;&#45;&#112;&#114;&#101;&#100;&#105;&#99;&#116;&#105;&#111;&#110;&#46;&#99;&#111;&#109;">&#100;&#101;&#118;&#45;&#116;&#101;&#97;&#109;&#64;&#102;&#111;&#111;&#116;&#98;&#97;&#108;&#108;&#45;&#112;&#114;&#101;&#100;&#105;&#99;&#116;&#105;&#111;&#110;&#46;&#99;&#111;&#109;</a></li>
<li><strong>æŠ€æœ¯æ–‡æ¡£</strong>ï¼š<a href="https://docs.football-prediction.com">https://docs.football-prediction.com</a></li>
<li><strong>é¡¹ç›®ä»“åº“</strong>ï¼š<a href="https://github.com/your-org/football-prediction-system">https://github.com/your-org/football-prediction-system</a></li>
</ul>
<hr />
<p><strong>æœ¬æ–‡æ¡£ä¸ºè¶³çƒæ¯”èµ›ç»“æœé¢„æµ‹ç³»ç»Ÿçš„æ­£å¼æŠ€æœ¯æ¶æ„è®¾è®¡æ–‡æ¡£ï¼Œæ‰€æœ‰å¼€å‘æ´»åŠ¨åº”ä¸¥æ ¼æŒ‰ç…§æœ¬æ–‡æ¡£æ‰§è¡Œã€‚</strong></p>














  <!-- æ·»åŠ é¡µé¢å¯¼èˆªåŠ©æ‰‹ -->


              </article>
            </div>


  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>

          <button type="button" class="md-top md-icon" data-md-component="top" hidden>

  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  å›åˆ°é¡µé¢é¡¶éƒ¨
</button>

      </main>


        <footer class="md-footer">



  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">

    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Football Prediction Team
    </div>


</div>

    </div>
  </div>
</footer>


  <!-- è‡ªå®šä¹‰é¡µè„šå†…å®¹ -->
  <footer class="md-footer-meta">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        <div class="md-footer-copyright__highlight">
          Â© 2025 Football Prediction Team -
          åŸºäº <a href="https://www.mkdocs.org/">MkDocs</a> å’Œ
          <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a> æ„å»º
        </div>
        <div class="md-footer-copyright__small">
          æ–‡æ¡£æœ€åæ›´æ–°: 2025-10-23 |
          ç‰ˆæœ¬: v1.0.0
        </div>
      </div>

      <!-- ç¤¾äº¤é“¾æ¥ (æš‚æ—¶æ³¨é‡Šæ‰) -->
      <!--
      <div class="md-footer-social">

      </div>
      -->
    </div>
  </footer>

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>

      <div class="md-progress" data-md-component="progress" role="progressbar"></div>


    <script id="__config" type="application/json">{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>



      <script src="../../assets/javascripts/bundle.88dd0f4e.min.js"></script>



  <!-- Google Analytics (é…ç½®ä¸ºé™æ€å€¼) -->
  <!--
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXX-X"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-XXXXX-X');
  </script>
  -->

  </body>
</html>
