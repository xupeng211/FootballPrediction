
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="基于现代Python技术栈的足球预测系统完整文档">
      
      
        <meta name="author" content="Football Prediction Team">
      
      
        <link rel="canonical" href="https://football-prediction-docs.example.com/architecture/architecture/">
      
      
      
      
      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>足球比赛结果预测系统 - 系统架构文档 - 足球预测系统文档</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <meta property="og:type" content="website">
  <meta property="og:title" content="足球预测系统文档">
  <meta property="og:description" content="基于现代Python技术栈的足球预测系统完整文档">
  <meta property="og:url" content="https://football-prediction-docs.example.com/architecture/architecture/">
  <meta property="og:image" content="../../assets/logo.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@football_pred">
  <meta name="twitter:creator" content="@football_pred">

  <!-- 自定义CSS和JS -->
  <link rel="stylesheet" href="../../assets/extra.css">
  <script src="../../assets/extra.js"></script>

  <!-- 添加中文字体支持 -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">

  

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#-" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
  
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="足球预测系统文档" class="md-header__button md-logo" aria-label="足球预测系统文档" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            足球预测系统文档
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              足球比赛结果预测系统 - 系统架构文档
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="切换至深色模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="切换至深色模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="切换至深色模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换至深色模式" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="切换至浅色模式"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="切换至浅色模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/your-org/football-prediction" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    football-prediction/docs
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../index.md" class="md-tabs__link">
        
  
    
  
  首页

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../how-to/QUICKSTART_TOOLS/" class="md-tabs__link">
          
  
    
  
  快速开始

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../ARCHITECTURE/" class="md-tabs__link">
          
  
    
  
  架构设计

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../reference/API_REFERENCE/" class="md-tabs__link">
          
  
    
  
  API参考

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../testing/TEST_IMPROVEMENT_GUIDE/" class="md-tabs__link">
          
  
    
  
  测试指南

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../ops/PRODUCTION_READINESS_PLAN/" class="md-tabs__link">
          
  
    
  
  运维部署

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../ml/ML_MODEL_GUIDE/" class="md-tabs__link">
          
  
    
  
  机器学习

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../security/SECURITY_POLICY.md" class="md-tabs__link">
          
  
    
  
  安全配置

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../project/CONTRIBUTING.md" class="md-tabs__link">
          
  
    
  
  项目管理

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../AI_DEVELOPMENT_DOCUMENTATION_RULES.md" class="md-tabs__link">
          
  
    
  
  参考资料

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    

  <!-- 公告栏配置 (暂时注释掉) -->
  <!--
  
  -->

    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="足球预测系统文档" class="md-nav__button md-logo" aria-label="足球预测系统文档" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    足球预测系统文档
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/your-org/football-prediction" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    football-prediction/docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    首页
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../how-to/QUICKSTART_TOOLS/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    快速开始
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../ARCHITECTURE/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    架构设计
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../reference/API_REFERENCE/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    API参考
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../testing/TEST_IMPROVEMENT_GUIDE/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    测试指南
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../ops/PRODUCTION_READINESS_PLAN/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    运维部署
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../ml/ML_MODEL_GUIDE/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    机器学习
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../security/SECURITY_POLICY.md" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    安全配置
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../project/CONTRIBUTING.md" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    项目管理
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../AI_DEVELOPMENT_DOCUMENTATION_RULES.md" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    参考资料
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  
                  

  
    <a href="https://github.com/your-org/football-prediction/edit/main/docs/architecture/architecture.md" title="编辑此页" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/your-org/football-prediction/raw/main/docs/architecture/architecture.md" title="查看本页的源代码" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="-">足球比赛结果预测系统 - 系统架构文档<a class="headerlink" href="#-" title="Permanent link">&para;</a></h1>
<h2 id="_1">📋 目录<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#1-系统架构概览">系统架构概览</a></li>
<li><a href="#2-模块设计说明">模块设计说明</a></li>
<li><a href="#3-数据库设计草案">数据库设计草案</a></li>
<li><a href="#4-开发阶段规划">开发阶段规划</a></li>
<li><a href="#5-部署与运维架构">部署与运维架构</a></li>
<li><a href="#6-未来扩展建议">未来扩展建议</a></li>
</ol>
<hr />
<h2 id="1">1. 系统架构概览<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 整体架构图<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>graph TB
    subgraph &quot;数据源层&quot;
        A1[API-Football]
        A2[OddsPortal API]
        A3[官方赛事数据]
        A4[第三方体育数据]
    end

    subgraph &quot;数据采集层&quot;
        B1[Scrapy爬虫引擎]
        B2[API数据采集器]
        B3[实时数据同步]
        B4[数据采集调度器]
    end

    subgraph &quot;数据处理层&quot;
        C1[数据清洗模块]
        C2[数据验证模块]
        C3[特征工程引擎]
        C4[数据存储管理]
    end

    subgraph &quot;存储层&quot;
        D1[(MySQL/PostgreSQL&lt;br/&gt;主数据库)]
        D2[(Redis&lt;br/&gt;缓存层)]
        D3[(文件存储&lt;br/&gt;模型&amp;日志)]
    end

    subgraph &quot;机器学习层&quot;
        E1[XGBoost模型]
        E2[LightGBM模型]
        E3[模型训练引擎]
        E4[模型评估系统]
        E5[预测服务引擎]
    end

    subgraph &quot;服务层&quot;
        F1[FastAPI服务]
        F2[RESTful API接口]
        F3[认证授权模块]
        F4[监控告警系统]
    end

    subgraph &quot;前端展示层&quot;
        G1[Vue.js/React前端]
        G2[ECharts可视化]
        G3[响应式UI组件]
        G4[实时数据展示]
    end

    subgraph &quot;部署层&quot;
        H1[Docker容器]
        H2[Kubernetes编排]
        H3[负载均衡器]
        H4[CI/CD流水线]
    end

    A1 &amp; A2 &amp; A3 &amp; A4 --&gt; B1 &amp; B2 &amp; B3
    B1 &amp; B2 &amp; B3 --&gt; B4
    B4 --&gt; C1 &amp; C2
    C1 &amp; C2 --&gt; C3
    C3 --&gt; C4
    C4 --&gt; D1 &amp; D2 &amp; D3
    D1 --&gt; E1 &amp; E2 &amp; E3
    E3 --&gt; E4
    E1 &amp; E2 --&gt; E5
    E5 --&gt; F1
    F1 --&gt; F2 &amp; F3
    F2 --&gt; G1
    G1 --&gt; G2 &amp; G3 &amp; G4
    F1 --&gt; H1
    H1 --&gt; H2
    H2 --&gt; H3
    H4 --&gt; H1
</code></pre></div>
<h3 id="12">1.2 数据流说明<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<p>系统采用经典的数据流水线架构，数据从采集到预测展示的完整链路如下：</p>
<h4 id="_2">输入阶段<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>多源数据采集</strong>：通过API和爬虫从多个数据源（API-Football、OddsPortal等）采集比赛数据、球队信息、历史战绩、实时赔率等</li>
<li><strong>数据标准化</strong>：将不同格式的数据统一转换为标准格式</li>
</ul>
<h4 id="_3">处理阶段<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>数据清洗</strong>：去重、补缺失值、异常值检测和处理</li>
<li><strong>特征工程</strong>：提取球队实力指标、主客场优势、历史交锋记录、伤病情况等特征</li>
<li><strong>数据存储</strong>：结构化数据存入关系数据库，缓存热点数据到Redis</li>
</ul>
<h4 id="_4">建模阶段<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>模型训练</strong>：使用XGBoost/LightGBM对历史数据进行训练</li>
<li><strong>模型评估</strong>：通过交叉验证、回测等方式评估模型性能</li>
<li><strong>预测生成</strong>：对即将进行的比赛生成预测结果和置信度</li>
</ul>
<h4 id="_5">输出阶段<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>API服务</strong>：通过FastAPI提供RESTful接口</li>
<li><strong>前端展示</strong>：使用Vue.js/React构建用户界面，通过ECharts展示预测结果和统计分析</li>
<li><strong>实时更新</strong>：支持实时数据更新和预测结果刷新</li>
</ul>
<hr />
<h2 id="2">2. 模块设计说明<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 数据采集模块<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<h4 id="_6">职责<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<ul>
<li>从多个数据源采集足球比赛相关数据</li>
<li>实现增量采集和全量同步机制</li>
<li>处理API限流和反爬虫策略</li>
<li>保证数据采集的稳定性和实时性</li>
</ul>
<h4 id="_7">输入/输出<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>输入</strong>：API端点配置、爬虫目标网站、采集任务调度配置</li>
<li><strong>输出</strong>：标准化的比赛数据、球队数据、赔率数据、球员数据</li>
</ul>
<h4 id="_8">核心组件<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>src/data_collection/
├── collectors/
│   ├── api_collector.py      # API数据采集器
│   ├── web_scraper.py        # 网页爬虫
│   └── odds_collector.py     # 赔率数据采集
├── schedulers/
│   ├── task_scheduler.py     # 任务调度器
│   └── incremental_sync.py   # 增量同步
└── utils/
    ├── rate_limiter.py       # 访问频率控制
    └── proxy_manager.py      # 代理IP管理
</code></pre></div>
<h4 id="_9">依赖关系<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<ul>
<li>依赖：外部数据API、代理服务、任务调度框架</li>
<li>被依赖：数据存储模块、数据清洗模块</li>
</ul>
<h4 id="_10">扩展方向<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<ul>
<li>支持更多数据源接入</li>
<li>实现分布式采集架构</li>
<li>增加实时流数据采集能力</li>
</ul>
<h3 id="22">2.2 数据存储与清洗模块<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<h4 id="_11">职责<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h4>
<ul>
<li>数据质量检查和清洗处理</li>
<li>建立统一的数据存储规范</li>
<li>实现数据备份和恢复机制</li>
<li>提供数据访问接口</li>
</ul>
<h4 id="_12">输入/输出<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>输入</strong>：原始采集数据、数据质量规则、清洗配置参数</li>
<li><strong>输出</strong>：清洗后的结构化数据、数据质量报告、异常数据记录</li>
</ul>
<h4 id="_13">核心组件<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>src/data_processing/
├── cleaners/
│   ├── data_validator.py     # 数据验证器
│   ├── duplicate_remover.py  # 去重处理
│   └── missing_handler.py    # 缺失值处理
├── storage/
│   ├── database_manager.py   # 数据库管理
│   ├── cache_manager.py      # 缓存管理
│   └── backup_manager.py     # 备份管理
└── transformers/
    ├── data_normalizer.py    # 数据标准化
    └── schema_mapper.py      # 模式映射
</code></pre></div>
<h4 id="_14">依赖关系<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<ul>
<li>依赖：数据采集模块、数据库系统、缓存系统</li>
<li>被依赖：特征工程模块、模型训练模块</li>
</ul>
<h4 id="_15">扩展方向<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h4>
<ul>
<li>实现流式数据处理</li>
<li>增加数据血缘跟踪功能</li>
<li>支持多种数据格式转换</li>
</ul>
<h3 id="23">2.3 特征工程与模型训练模块<a class="headerlink" href="#23" title="Permanent link">&para;</a></h3>
<h4 id="_16">职责<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h4>
<ul>
<li>设计和提取预测相关的特征</li>
<li>训练和优化机器学习模型</li>
<li>实现模型版本管理和A/B测试</li>
<li>提供模型性能监控</li>
</ul>
<h4 id="_17">输入/输出<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>输入</strong>：清洗后的比赛数据、球队数据、历史统计数据</li>
<li><strong>输出</strong>：训练好的预测模型、特征重要性分析、模型评估报告</li>
</ul>
<h4 id="_18">核心组件<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>src/ml/
├── features/
│   ├── team_features.py      # 球队特征工程
│   ├── match_features.py     # 比赛特征工程
│   └── historical_features.py # 历史数据特征
├── models/
│   ├── xgboost_model.py      # XGBoost模型
│   ├── lightgbm_model.py     # LightGBM模型
│   └── ensemble_model.py     # 集成模型
├── training/
│   ├── model_trainer.py      # 模型训练器
│   ├── hyperparameter_tuner.py # 超参数调优
│   └── cross_validator.py    # 交叉验证
└── evaluation/
    ├── model_evaluator.py    # 模型评估
    └── performance_monitor.py # 性能监控
</code></pre></div>
<h4 id="_19">依赖关系<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h4>
<ul>
<li>依赖：数据处理模块、机器学习库（XGBoost、LightGBM）</li>
<li>被依赖：预测服务模块</li>
</ul>
<h4 id="_20">扩展方向<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h4>
<ul>
<li>引入深度学习模型</li>
<li>实现在线学习能力</li>
<li>增加特征自动发现功能</li>
</ul>
<h3 id="24">2.4 预测服务模块<a class="headerlink" href="#24" title="Permanent link">&para;</a></h3>
<h4 id="_21">职责<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h4>
<ul>
<li>基于训练模型提供预测服务</li>
<li>实现实时预测API接口</li>
<li>管理预测结果缓存和历史记录</li>
<li>提供预测置信度和解释性信息</li>
</ul>
<h4 id="_22">输入/输出<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>输入</strong>：预测请求、比赛信息、实时数据更新</li>
<li><strong>输出</strong>：预测结果、置信度评分、预测解释信息</li>
</ul>
<h4 id="_23">核心组件<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>src/prediction/
├── services/
│   ├── prediction_service.py  # 预测服务核心
│   ├── model_loader.py       # 模型加载器
│   └── result_formatter.py   # 结果格式化
├── api/
│   ├── prediction_api.py     # 预测API接口
│   ├── batch_predictor.py    # 批量预测
│   └── real_time_predictor.py # 实时预测
└── utils/
    ├── confidence_calculator.py # 置信度计算
    └── explanation_generator.py # 预测解释
</code></pre></div>
<h4 id="_24">依赖关系<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h4>
<ul>
<li>依赖：机器学习模块、缓存系统、数据库系统</li>
<li>被依赖：API服务层、前端展示模块</li>
</ul>
<h4 id="_25">扩展方向<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h4>
<ul>
<li>支持多模型融合预测</li>
<li>实现预测结果的实时校准</li>
<li>增加用户个性化预测功能</li>
</ul>
<h3 id="25">2.5 前端展示模块<a class="headerlink" href="#25" title="Permanent link">&para;</a></h3>
<h4 id="_26">职责<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h4>
<ul>
<li>提供用户友好的Web界面</li>
<li>展示预测结果和数据可视化</li>
<li>实现响应式设计支持多设备访问</li>
<li>提供实时数据更新和交互功能</li>
</ul>
<h4 id="_27">输入/输出<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>输入</strong>：API数据、用户交互事件、实时数据推送</li>
<li><strong>输出</strong>：可视化图表、用户界面、交互反馈</li>
</ul>
<h4 id="_28">核心组件<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>frontend/
├── src/
│   ├── components/
│   │   ├── PredictionCard.vue    # 预测结果卡片
│   │   ├── MatchList.vue         # 比赛列表
│   │   └── StatisticsChart.vue   # 统计图表
│   ├── views/
│   │   ├── Dashboard.vue         # 仪表板
│   │   ├── MatchDetail.vue       # 比赛详情
│   │   └── Analytics.vue         # 数据分析
│   ├── services/
│   │   ├── api.js                # API服务
│   │   └── websocket.js          # WebSocket连接
│   └── utils/
│       ├── chart-config.js       # 图表配置
│       └── data-formatter.js     # 数据格式化
</code></pre></div>
<h4 id="_29">依赖关系<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h4>
<ul>
<li>依赖：Vue.js/React框架、ECharts/Plotly、API服务</li>
<li>被依赖：最终用户</li>
</ul>
<h4 id="_30">扩展方向<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h4>
<ul>
<li>支持移动端APP开发</li>
<li>实现个性化用户界面</li>
<li>增加社交分享功能</li>
</ul>
<h3 id="26">2.6 容器化与部署模块<a class="headerlink" href="#26" title="Permanent link">&para;</a></h3>
<h4 id="_31">职责<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h4>
<ul>
<li>实现应用的容器化部署</li>
<li>管理服务编排和负载均衡</li>
<li>提供CI/CD流水线支持</li>
<li>监控系统运行状态和性能指标</li>
</ul>
<h4 id="_32">输入/输出<a class="headerlink" href="#_32" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>输入</strong>：应用代码、部署配置、环境变量</li>
<li><strong>输出</strong>：运行中的服务实例、监控数据、部署日志</li>
</ul>
<h4 id="_33">核心组件<a class="headerlink" href="#_33" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>deployment/
├── docker/
│   ├── Dockerfile.api        # API服务镜像
│   ├── Dockerfile.worker     # 后台任务镜像
│   └── Dockerfile.frontend   # 前端应用镜像
├── kubernetes/
│   ├── api-deployment.yaml   # API服务部署
│   ├── database-config.yaml  # 数据库配置
│   └── ingress.yaml          # 负载均衡配置
├── ci-cd/
│   ├── github-actions.yml    # CI/CD流水线
│   └── deployment-script.sh  # 部署脚本
└── monitoring/
    ├── prometheus-config.yml  # 监控配置
    └── grafana-dashboard.json # 仪表板配置
</code></pre></div>
<h4 id="_34">依赖关系<a class="headerlink" href="#_34" title="Permanent link">&para;</a></h4>
<ul>
<li>依赖：Docker、Kubernetes、CI/CD平台</li>
<li>被依赖：所有其他模块（提供运行环境）</li>
</ul>
<h4 id="_35">扩展方向<a class="headerlink" href="#_35" title="Permanent link">&para;</a></h4>
<ul>
<li>实现多云部署支持</li>
<li>增加自动扩缩容功能</li>
<li>提供蓝绿部署能力</li>
</ul>
<hr />
<h2 id="3">3. 数据库设计草案<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 核心表结构<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<h4 id="311-teams">3.1.1 球队表 (teams)<a class="headerlink" href="#311-teams" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">teams</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">team_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">team_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">team_code</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<span class="w">    </span><span class="n">country</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="n">league_id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">founded_year</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">stadium</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
<span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
<span class="w">    </span><span class="n">updated_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>

<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_league</span><span class="w"> </span><span class="p">(</span><span class="n">league_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_country</span><span class="w"> </span><span class="p">(</span><span class="n">country</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>
<h4 id="312-matches">3.1.2 比赛表 (matches)<a class="headerlink" href="#312-matches" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">match_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">home_team_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">away_team_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">league_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">season</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="w">    </span><span class="n">match_date</span><span class="w"> </span><span class="n">DATETIME</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">match_status</span><span class="w"> </span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;scheduled&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;live&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;finished&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;cancelled&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;scheduled&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="n">home_score</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">away_score</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">home_goals_ht</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- 半场比分</span>
<span class="w">    </span><span class="n">away_goals_ht</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">attendance</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">referee</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
<span class="w">    </span><span class="n">venue</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
<span class="w">    </span><span class="n">weather_condition</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
<span class="w">    </span><span class="n">updated_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>

<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">home_team_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">teams</span><span class="p">(</span><span class="n">team_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">away_team_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">teams</span><span class="p">(</span><span class="n">team_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_date</span><span class="w"> </span><span class="p">(</span><span class="n">match_date</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_teams</span><span class="w"> </span><span class="p">(</span><span class="n">home_team_id</span><span class="p">,</span><span class="w"> </span><span class="n">away_team_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_league_season</span><span class="w"> </span><span class="p">(</span><span class="n">league_id</span><span class="p">,</span><span class="w"> </span><span class="n">season</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_status</span><span class="w"> </span><span class="p">(</span><span class="n">match_status</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>
<h4 id="313-odds">3.1.3 赔率表 (odds)<a class="headerlink" href="#313-odds" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">odds</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">odds_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">match_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">bookmaker</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">market_type</span><span class="w"> </span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;1x2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;over_under&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;asian_handicap&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;both_teams_score&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">home_odds</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">draw_odds</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">away_odds</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">over_odds</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">under_odds</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">line_value</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="c1">-- 盘口值</span>
<span class="w">    </span><span class="n">collected_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>

<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">match_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">matches</span><span class="p">(</span><span class="n">match_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_match_bookmaker</span><span class="w"> </span><span class="p">(</span><span class="n">match_id</span><span class="p">,</span><span class="w"> </span><span class="n">bookmaker</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_collected_at</span><span class="w"> </span><span class="p">(</span><span class="n">collected_at</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_market_type</span><span class="w"> </span><span class="p">(</span><span class="n">market_type</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>
<h4 id="314-features">3.1.4 特征表 (features)<a class="headerlink" href="#314-features" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">feature_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">match_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">team_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">team_type</span><span class="w"> </span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;away&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>

<span class="w">    </span><span class="c1">-- 基础统计特征</span>
<span class="w">    </span><span class="n">recent_5_wins</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">recent_5_draws</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">recent_5_losses</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">recent_5_goals_for</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">recent_5_goals_against</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>

<span class="w">    </span><span class="c1">-- 主客场特征</span>
<span class="w">    </span><span class="n">home_wins</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">home_draws</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">home_losses</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">away_wins</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">away_draws</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">away_losses</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>

<span class="w">    </span><span class="c1">-- 对战历史特征</span>
<span class="w">    </span><span class="n">h2h_wins</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">h2h_draws</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">h2h_losses</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">h2h_goals_for</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="n">h2h_goals_against</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>

<span class="w">    </span><span class="c1">-- 联赛排名特征</span>
<span class="w">    </span><span class="n">league_position</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">points</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">goal_difference</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>

<span class="w">    </span><span class="c1">-- 其他特征</span>
<span class="w">    </span><span class="n">days_since_last_match</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">is_derby</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">FALSE</span><span class="p">,</span>
<span class="w">    </span><span class="n">avg_possession</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="w">    </span><span class="n">avg_shots_per_game</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>

<span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>

<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">match_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">matches</span><span class="p">(</span><span class="n">match_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">team_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">teams</span><span class="p">(</span><span class="n">team_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_match</span><span class="w"> </span><span class="p">(</span><span class="n">match_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_team</span><span class="w"> </span><span class="p">(</span><span class="n">team_id</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>
<h4 id="315-predictions">3.1.5 预测表 (predictions)<a class="headerlink" href="#315-predictions" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">predictions</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">prediction_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">match_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">model_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">model_version</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>

<span class="w">    </span><span class="c1">-- 预测结果</span>
<span class="w">    </span><span class="n">predicted_result</span><span class="w"> </span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;home_win&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;draw&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;away_win&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">home_win_probability</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">draw_probability</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">away_win_probability</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>

<span class="w">    </span><span class="c1">-- 比分预测</span>
<span class="w">    </span><span class="n">predicted_home_score</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="w">    </span><span class="n">predicted_away_score</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>

<span class="w">    </span><span class="c1">-- 其他预测</span>
<span class="w">    </span><span class="n">over_2_5_probability</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">both_teams_score_probability</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>

<span class="w">    </span><span class="c1">-- 置信度和特征重要性</span>
<span class="w">    </span><span class="n">confidence_score</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
<span class="w">    </span><span class="n">feature_importance</span><span class="w"> </span><span class="n">JSON</span><span class="p">,</span><span class="w"> </span><span class="c1">-- 存储特征重要性数据</span>

<span class="w">    </span><span class="n">predicted_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>

<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">match_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">matches</span><span class="p">(</span><span class="n">match_id</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_match_model</span><span class="w"> </span><span class="p">(</span><span class="n">match_id</span><span class="p">,</span><span class="w"> </span><span class="n">model_name</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_predicted_at</span><span class="w"> </span><span class="p">(</span><span class="n">predicted_at</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>
<h4 id="316-leagues">3.1.6 联赛表 (leagues)<a class="headerlink" href="#316-leagues" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">leagues</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">league_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">league_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">league_code</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<span class="w">    </span><span class="n">country</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="k">level</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="c1">-- 联赛级别</span>
<span class="w">    </span><span class="n">season_start_month</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">season_end_month</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="w">    </span><span class="n">is_active</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">TRUE</span><span class="p">,</span>
<span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>

<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_country</span><span class="w"> </span><span class="p">(</span><span class="n">country</span><span class="p">),</span>
<span class="w">    </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_active</span><span class="w"> </span><span class="p">(</span><span class="n">is_active</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>
<h3 id="32">3.2 数据一致性约束<a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<h4 id="321">3.2.1 数据完整性约束<a class="headerlink" href="#321" title="Permanent link">&para;</a></h4>
<ul>
<li>所有比赛必须有有效的主客场球队</li>
<li>已完成的比赛必须有比分</li>
<li>预测必须基于未完成的比赛</li>
<li>赔率数据必须在比赛开始前收集</li>
</ul>
<h4 id="322">3.2.2 业务逻辑约束<a class="headerlink" href="#322" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">-- 确保比赛日期不在过去（对于新建比赛）</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">check_future_date</span>
<span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">match_date</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">DATE_SUB</span><span class="p">(</span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">DAY</span><span class="p">));</span>

<span class="c1">-- 确保概率之和等于1</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">predictions</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">check_probability_sum</span>
<span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="k">ABS</span><span class="p">((</span><span class="n">home_win_probability</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">draw_probability</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">away_win_probability</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">001</span><span class="p">);</span>

<span class="c1">-- 确保赔率为正数</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">odds</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">check_positive_odds</span>
<span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">home_odds</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">draw_odds</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">away_odds</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</code></pre></div>
<h3 id="33">3.3 索引优化策略<a class="headerlink" href="#33" title="Permanent link">&para;</a></h3>
<h4 id="331">3.3.1 查询优化索引<a class="headerlink" href="#331" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">-- 最近比赛查询优化</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_recent_matches</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">matches</span><span class="p">(</span><span class="n">match_date</span><span class="w"> </span><span class="k">DESC</span><span class="p">,</span><span class="w"> </span><span class="n">league_id</span><span class="p">);</span>

<span class="c1">-- 球队历史战绩查询优化</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_team_matches</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">matches</span><span class="p">(</span><span class="n">home_team_id</span><span class="p">,</span><span class="w"> </span><span class="n">away_team_id</span><span class="p">,</span><span class="w"> </span><span class="n">match_date</span><span class="p">);</span>

<span class="c1">-- 预测结果查询优化</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_predictions_lookup</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">predictions</span><span class="p">(</span><span class="n">match_id</span><span class="p">,</span><span class="w"> </span><span class="n">model_name</span><span class="p">,</span><span class="w"> </span><span class="n">predicted_at</span><span class="w"> </span><span class="k">DESC</span><span class="p">);</span>

<span class="c1">-- 特征工程查询优化</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_features_team_date</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">matches</span><span class="p">(</span><span class="n">home_team_id</span><span class="p">,</span><span class="w"> </span><span class="n">match_date</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_features_away_date</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">matches</span><span class="p">(</span><span class="n">away_team_id</span><span class="p">,</span><span class="w"> </span><span class="n">match_date</span><span class="p">);</span>
</code></pre></div>
<h3 id="34">3.4 数据分区策略<a class="headerlink" href="#34" title="Permanent link">&para;</a></h3>
<h4 id="341">3.4.1 按时间分区<a class="headerlink" href="#341" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">-- 比赛表按年份分区</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">RANGE</span><span class="w"> </span><span class="p">(</span><span class="k">YEAR</span><span class="p">(</span><span class="n">match_date</span><span class="p">))</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">PARTITION</span><span class="w"> </span><span class="n">p2020</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">LESS</span><span class="w"> </span><span class="k">THAN</span><span class="w"> </span><span class="p">(</span><span class="mi">2021</span><span class="p">),</span>
<span class="w">    </span><span class="n">PARTITION</span><span class="w"> </span><span class="n">p2021</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">LESS</span><span class="w"> </span><span class="k">THAN</span><span class="w"> </span><span class="p">(</span><span class="mi">2022</span><span class="p">),</span>
<span class="w">    </span><span class="n">PARTITION</span><span class="w"> </span><span class="n">p2022</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">LESS</span><span class="w"> </span><span class="k">THAN</span><span class="w"> </span><span class="p">(</span><span class="mi">2023</span><span class="p">),</span>
<span class="w">    </span><span class="n">PARTITION</span><span class="w"> </span><span class="n">p2023</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">LESS</span><span class="w"> </span><span class="k">THAN</span><span class="w"> </span><span class="p">(</span><span class="mi">2024</span><span class="p">),</span>
<span class="w">    </span><span class="n">PARTITION</span><span class="w"> </span><span class="n">p2024</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">LESS</span><span class="w"> </span><span class="k">THAN</span><span class="w"> </span><span class="p">(</span><span class="mi">2025</span><span class="p">),</span>
<span class="w">    </span><span class="n">PARTITION</span><span class="w"> </span><span class="n">p_future</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">LESS</span><span class="w"> </span><span class="k">THAN</span><span class="w"> </span><span class="k">MAXVALUE</span>
<span class="p">);</span>

<span class="c1">-- 预测表按月分区</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">predictions</span><span class="w"> </span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">RANGE</span><span class="w"> </span><span class="p">(</span><span class="k">YEAR</span><span class="p">(</span><span class="n">predicted_at</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">MONTH</span><span class="p">(</span><span class="n">predicted_at</span><span class="p">))</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">PARTITION</span><span class="w"> </span><span class="n">p202401</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">LESS</span><span class="w"> </span><span class="k">THAN</span><span class="w"> </span><span class="p">(</span><span class="mi">202402</span><span class="p">),</span>
<span class="w">    </span><span class="n">PARTITION</span><span class="w"> </span><span class="n">p202402</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">LESS</span><span class="w"> </span><span class="k">THAN</span><span class="w"> </span><span class="p">(</span><span class="mi">202403</span><span class="p">),</span>
<span class="w">    </span><span class="c1">-- ... 更多分区</span>
<span class="w">    </span><span class="n">PARTITION</span><span class="w"> </span><span class="n">p_current</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">LESS</span><span class="w"> </span><span class="k">THAN</span><span class="w"> </span><span class="k">MAXVALUE</span>
<span class="p">);</span>
</code></pre></div>
<h3 id="35">3.5 扩展性考虑<a class="headerlink" href="#35" title="Permanent link">&para;</a></h3>
<h4 id="351">3.5.1 读写分离<a class="headerlink" href="#351" title="Permanent link">&para;</a></h4>
<ul>
<li>主库处理写操作和实时查询</li>
<li>从库处理历史数据分析和报表查询</li>
<li>预测服务优先使用从库减少主库压力</li>
</ul>
<h4 id="352">3.5.2 缓存策略<a class="headerlink" href="#352" title="Permanent link">&para;</a></h4>
<ul>
<li>Redis缓存热点查询数据（近期比赛、实时预测结果）</li>
<li>缓存球队基础信息和联赛信息</li>
<li>缓存预测模型输出结果（1小时有效期）</li>
</ul>
<h4 id="353">3.5.3 归档策略<a class="headerlink" href="#353" title="Permanent link">&para;</a></h4>
<ul>
<li>历史比赛数据（3年以上）归档到单独的归档库</li>
<li>历史预测数据保留用于模型效果回测</li>
<li>赔率历史数据定期清理，保留代表性样本</li>
</ul>
<hr />
<h2 id="4">4. 开发阶段规划<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 阶段一：环境搭建 + 数据采集 + 数据存储清洗<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<h4 id="4-6">时间规划：4-6周<a class="headerlink" href="#4-6" title="Permanent link">&para;</a></h4>
<h4 id="_36">主要任务<a class="headerlink" href="#_36" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>开发环境搭建</strong>（1周）</li>
<li>搭建Python开发环境和依赖管理</li>
<li>配置数据库（MySQL/PostgreSQL）和Redis</li>
<li>建立Git版本控制和代码规范</li>
<li>
<p>配置日志系统和监控基础设施</p>
</li>
<li>
<p><strong>数据采集系统开发</strong>（2-3周）</p>
</li>
<li>实现API数据采集器（API-Football等）</li>
<li>开发Web爬虫系统（处理反爬机制）</li>
<li>建立数据采集任务调度系统</li>
<li>实现增量数据同步机制</li>
<li>
<p>建立数据采集监控和告警</p>
</li>
<li>
<p><strong>数据存储和清洗系统</strong>（1-2周）</p>
</li>
<li>实现数据库表结构创建和迁移</li>
<li>开发数据清洗和验证模块</li>
<li>建立数据质量监控系统</li>
<li>实现数据备份和恢复机制</li>
</ol>
<h4 id="_37">交付物<a class="headerlink" href="#_37" title="Permanent link">&para;</a></h4>
<ul>
<li>完整的数据采集系统，能够稳定获取主要联赛数据</li>
<li>数据库schema和数据清洗流水线</li>
<li>数据质量报告和监控仪表板</li>
<li>技术文档和操作手册</li>
</ul>
<h4 id="_38">里程碑检查<a class="headerlink" href="#_38" title="Permanent link">&para;</a></h4>
<ul>
<li>能够采集至少3个主要联赛的历史数据（最近2个赛季）</li>
<li>数据质量达标（完整性&gt;95%，准确性&gt;98%）</li>
<li>系统稳定运行72小时无中断</li>
</ul>
<h4 id="_39">测试重点<a class="headerlink" href="#_39" title="Permanent link">&para;</a></h4>
<ul>
<li>数据采集的稳定性和准确性测试</li>
<li>数据清洗逻辑的正确性验证</li>
<li>异常情况处理（网络中断、API限流等）</li>
</ul>
<h3 id="42">4.2 阶段二：特征工程 + 模型训练<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<h4 id="6-8">时间规划：6-8周<a class="headerlink" href="#6-8" title="Permanent link">&para;</a></h4>
<h4 id="_40">主要任务<a class="headerlink" href="#_40" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>特征工程开发</strong>（3-4周）</li>
<li>设计和实现基础统计特征（胜负记录、进球数等）</li>
<li>开发高级特征（主客场优势、对战历史、球队实力等）</li>
<li>实现时序特征（最近状态、趋势分析）</li>
<li>建立特征存储和管理系统</li>
<li>
<p>特征有效性分析和筛选</p>
</li>
<li>
<p><strong>模型训练系统</strong>（2-3周）</p>
</li>
<li>实现XGBoost和LightGBM模型训练流水线</li>
<li>开发超参数调优系统</li>
<li>建立交叉验证和模型评估体系</li>
<li>实现模型版本管理和对比系统</li>
<li>
<p>开发模型解释性分析工具</p>
</li>
<li>
<p><strong>模型优化和集成</strong>（1周）</p>
</li>
<li>模型性能优化和调参</li>
<li>实现多模型集成策略</li>
<li>建立模型性能监控系统</li>
</ol>
<h4 id="_41">交付物<a class="headerlink" href="#_41" title="Permanent link">&para;</a></h4>
<ul>
<li>完整的特征工程系统，包含100+个预测特征</li>
<li>训练好的预测模型，预测准确率&gt;55%</li>
<li>模型评估报告和性能基准</li>
<li>特征重要性分析和模型解释文档</li>
</ul>
<h4 id="_42">里程碑检查<a class="headerlink" href="#_42" title="Permanent link">&para;</a></h4>
<ul>
<li>特征工程系统能够为所有比赛生成完整特征向量</li>
<li>模型在测试集上达到预期性能指标</li>
<li>能够为未来比赛生成可信的预测结果</li>
</ul>
<h4 id="_43">测试重点<a class="headerlink" href="#_43" title="Permanent link">&para;</a></h4>
<ul>
<li>特征计算的正确性和一致性</li>
<li>模型预测的准确性和稳定性</li>
<li>不同联赛和时间段的泛化能力测试</li>
</ul>
<h3 id="43-api">4.3 阶段三：预测服务API + 前端展示<a class="headerlink" href="#43-api" title="Permanent link">&para;</a></h3>
<h4 id="6-8_1">时间规划：6-8周<a class="headerlink" href="#6-8_1" title="Permanent link">&para;</a></h4>
<h4 id="_44">主要任务<a class="headerlink" href="#_44" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>预测服务开发</strong>（3-4周）</li>
<li>使用FastAPI构建RESTful API服务</li>
<li>实现实时预测和批量预测接口</li>
<li>开发预测结果缓存和存储系统</li>
<li>建立API认证和限流机制</li>
<li>
<p>实现预测置信度计算和结果解释</p>
</li>
<li>
<p><strong>前端应用开发</strong>（2-3周）</p>
</li>
<li>使用Vue.js/React开发响应式Web界面</li>
<li>实现比赛列表、预测结果展示组件</li>
<li>开发数据可视化图表（ECharts）</li>
<li>建立实时数据更新机制（WebSocket）</li>
<li>
<p>实现移动端适配</p>
</li>
<li>
<p><strong>系统集成和测试</strong>（1周）</p>
</li>
<li>前后端集成和联调</li>
<li>性能优化和用户体验改进</li>
<li>全链路功能测试</li>
</ol>
<h4 id="_45">交付物<a class="headerlink" href="#_45" title="Permanent link">&para;</a></h4>
<ul>
<li>完整的预测API服务，支持多种预测类型</li>
<li>用户友好的Web前端应用</li>
<li>API文档和用户使用指南</li>
<li>系统性能测试报告</li>
</ul>
<h4 id="_46">里程碑检查<a class="headerlink" href="#_46" title="Permanent link">&para;</a></h4>
<ul>
<li>API服务能够稳定提供预测结果，响应时间&lt;500ms</li>
<li>前端应用功能完整，用户体验良好</li>
<li>系统能够同时支持100个并发用户</li>
</ul>
<h4 id="_47">测试重点<a class="headerlink" href="#_47" title="Permanent link">&para;</a></h4>
<ul>
<li>API接口的功能性和性能测试</li>
<li>前端界面的兼容性和易用性测试</li>
<li>系统负载和压力测试</li>
</ul>
<h3 id="44-cicd">4.4 阶段四：容器化部署 + CI/CD流程<a class="headerlink" href="#44-cicd" title="Permanent link">&para;</a></h3>
<h4 id="4-6_1">时间规划：4-6周<a class="headerlink" href="#4-6_1" title="Permanent link">&para;</a></h4>
<h4 id="_48">主要任务<a class="headerlink" href="#_48" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>容器化改造</strong>（2-3周）</li>
<li>编写Dockerfile构建应用镜像</li>
<li>配置Docker Compose本地部署</li>
<li>实现配置管理和环境变量注入</li>
<li>
<p>建立镜像版本管理和仓库</p>
</li>
<li>
<p><strong>云端部署</strong>（1-2周）</p>
</li>
<li>选择和配置云服务提供商（优先香港节点）</li>
<li>实现Kubernetes集群部署（可选）</li>
<li>配置负载均衡和域名解析</li>
<li>
<p>建立生产环境监控和告警</p>
</li>
<li>
<p><strong>CI/CD流程建设</strong>（1周）</p>
</li>
<li>配置GitHub Actions自动化流水线</li>
<li>实现自动化测试和代码质量检查</li>
<li>建立自动部署和回滚机制</li>
<li>建立发布流程和版本管理</li>
</ol>
<h4 id="_49">交付物<a class="headerlink" href="#_49" title="Permanent link">&para;</a></h4>
<ul>
<li>完整的Docker化应用，支持一键部署</li>
<li>生产环境部署方案和运维文档</li>
<li>CI/CD自动化流水线</li>
<li>监控和告警系统</li>
</ul>
<h4 id="_50">里程碑检查<a class="headerlink" href="#_50" title="Permanent link">&para;</a></h4>
<ul>
<li>应用能够在云端稳定运行，可用性&gt;99%</li>
<li>CI/CD流水线运行正常，部署时间&lt;10分钟</li>
<li>监控系统能够及时发现和报告问题</li>
</ul>
<h4 id="_51">测试重点<a class="headerlink" href="#_51" title="Permanent link">&para;</a></h4>
<ul>
<li>容器化应用的稳定性和性能测试</li>
<li>部署流程的可靠性验证</li>
<li>生产环境的压力和灾备测试</li>
</ul>
<h3 id="45">4.5 整体项目时间线<a class="headerlink" href="#45" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>gantt
    title 足球预测系统开发时间线
    dateFormat  YYYY-MM-DD
    section 阶段一
    环境搭建           :done, env, 2024-01-01, 1w
    数据采集开发       :done, collect, after env, 3w
    数据清洗系统       :done, clean, after collect, 2w
    section 阶段二
    特征工程开发       :active, feature, after clean, 4w
    模型训练系统       :model, after feature, 3w
    模型优化集成       :optimize, after model, 1w
    section 阶段三
    预测服务开发       :api, after optimize, 4w
    前端应用开发       :frontend, after api, 3w
    系统集成测试       :integration, after frontend, 1w
    section 阶段四
    容器化改造         :docker, after integration, 3w
    云端部署           :deploy, after docker, 2w
    CI/CD流程         :cicd, after deploy, 1w
</code></pre></div>
<h3 id="46">4.6 风险控制和应对策略<a class="headerlink" href="#46" title="Permanent link">&para;</a></h3>
<h4 id="_52">主要风险点<a class="headerlink" href="#_52" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>数据采集风险</strong></li>
<li>风险：API限流、反爬虫、数据源变更</li>
<li>
<p>应对：多数据源备份、代理IP池、渐进式采集策略</p>
</li>
<li>
<p><strong>模型性能风险</strong></p>
</li>
<li>风险：预测准确率不达标、过拟合问题</li>
<li>
<p>应对：多模型对比、交叉验证、定期重训练</p>
</li>
<li>
<p><strong>技术实现风险</strong></p>
</li>
<li>风险：技术选型不当、性能瓶颈、扩展性问题</li>
<li>
<p>应对：原型验证、压力测试、架构评审</p>
</li>
<li>
<p><strong>部署运维风险</strong></p>
</li>
<li>风险：服务不稳定、安全漏洞、运维成本</li>
<li>应对：灰度部署、安全审计、成本监控</li>
</ol>
<h4 id="_53">质量保证措施<a class="headerlink" href="#_53" title="Permanent link">&para;</a></h4>
<ul>
<li>每个阶段设置质量关口，不达标不进入下一阶段</li>
<li>建立代码评审和自动化测试机制</li>
<li>定期进行架构评审和性能分析</li>
<li>建立完善的文档和知识管理体系</li>
</ul>
<hr />
<h2 id="5">5. 部署与运维架构<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 整体部署架构图<a class="headerlink" href="#51" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>graph TB
    subgraph &quot;用户层&quot;
        U1[Web用户]
        U2[移动用户]
        U3[API用户]
    end

    subgraph &quot;CDN &amp; 负载均衡层&quot;
        CDN[CloudFlare CDN]
        ALB[Application Load Balancer]
    end

    subgraph &quot;容器编排层&quot;
        K8S[Kubernetes集群]
        subgraph &quot;应用服务Pod&quot;
            API1[FastAPI实例1]
            API2[FastAPI实例2]
            API3[FastAPI实例3]
        end
        subgraph &quot;前端服务Pod&quot;
            WEB1[Nginx + Vue.js]
            WEB2[Nginx + Vue.js]
        end
        subgraph &quot;数据服务Pod&quot;
            WORKER1[数据采集Worker]
            WORKER2[模型训练Worker]
            SCHEDULER[任务调度器]
        end
    end

    subgraph &quot;数据层&quot;
        subgraph &quot;数据库集群&quot;
            DB_MASTER[(MySQL主库)]
            DB_SLAVE1[(MySQL从库1)]
            DB_SLAVE2[(MySQL从库2)]
        end
        subgraph &quot;缓存层&quot;
            REDIS_M[(Redis主)]
            REDIS_S[(Redis从)]
        end
        subgraph &quot;存储层&quot;
            S3[对象存储&lt;br/&gt;模型文件&amp;日志]
        end
    end

    subgraph &quot;监控层&quot;
        PROMETHEUS[Prometheus]
        GRAFANA[Grafana]
        ALERTMANAGER[AlertManager]
        ELK[ELK Stack]
    end

    U1 &amp; U2 &amp; U3 --&gt; CDN
    CDN --&gt; ALB
    ALB --&gt; K8S
    K8S --&gt; API1 &amp; API2 &amp; API3
    K8S --&gt; WEB1 &amp; WEB2
    K8S --&gt; WORKER1 &amp; WORKER2 &amp; SCHEDULER

    API1 &amp; API2 &amp; API3 --&gt; DB_SLAVE1 &amp; DB_SLAVE2
    API1 &amp; API2 &amp; API3 --&gt; REDIS_M
    WORKER1 &amp; WORKER2 --&gt; DB_MASTER
    SCHEDULER --&gt; REDIS_M

    DB_MASTER --&gt; DB_SLAVE1 &amp; DB_SLAVE2
    REDIS_M --&gt; REDIS_S

    K8S --&gt; S3
    K8S --&gt; PROMETHEUS
    PROMETHEUS --&gt; GRAFANA
    PROMETHEUS --&gt; ALERTMANAGER
    K8S --&gt; ELK
</code></pre></div>
<h3 id="52-docker">5.2 Docker镜像设计<a class="headerlink" href="#52-docker" title="Permanent link">&para;</a></h3>
<h4 id="521-api">5.2.1 API服务容器<a class="headerlink" href="#521-api" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c"># Dockerfile.api</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">python:3.11-slim</span>

<span class="c"># 设置工作目录</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>

<span class="c"># 安装系统依赖</span>
<span class="k">RUN</span><span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>gcc<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>g++<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>curl<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>/var/lib/apt/lists/*

<span class="c"># 复制依赖文件</span>
<span class="k">COPY</span><span class="w"> </span>requirements.txt<span class="w"> </span>.

<span class="c"># 安装Python依赖</span>
<span class="k">RUN</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--no-cache-dir<span class="w"> </span>-r<span class="w"> </span>requirements.txt

<span class="c"># 复制应用代码</span>
<span class="k">COPY</span><span class="w"> </span>src/<span class="w"> </span>./src/
<span class="k">COPY</span><span class="w"> </span>config/<span class="w"> </span>./config/

<span class="c"># 设置环境变量</span>
<span class="k">ENV</span><span class="w"> </span><span class="nv">PYTHONPATH</span><span class="o">=</span>/app
<span class="k">ENV</span><span class="w"> </span><span class="nv">API_HOST</span><span class="o">=</span><span class="m">0</span>.0.0.0
<span class="k">ENV</span><span class="w"> </span><span class="nv">API_PORT</span><span class="o">=</span><span class="m">8000</span>

<span class="c"># 健康检查</span>
<span class="k">HEALTHCHECK</span><span class="w"> </span>--interval<span class="o">=</span>30s<span class="w"> </span>--timeout<span class="o">=</span>10s<span class="w"> </span>--start-period<span class="o">=</span>60s<span class="w"> </span>--retries<span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>CMD<span class="w"> </span>curl<span class="w"> </span>-f<span class="w"> </span>http://localhost:8000/health<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>

<span class="c"># 暴露端口</span>
<span class="k">EXPOSE</span><span class="w"> </span><span class="s">8000</span>

<span class="c"># 启动命令</span>
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;uvicorn&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;src.api.main:app&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--host&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--port&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;8000&quot;</span><span class="p">]</span>
</code></pre></div>
<h4 id="522">5.2.2 数据采集容器<a class="headerlink" href="#522" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c"># Dockerfile.worker</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">python:3.11-slim</span>

<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>

<span class="c"># 安装Chrome和Chrome Driver（用于Selenium）</span>
<span class="k">RUN</span><span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>wget<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>gnupg<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>unzip<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>curl<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>wget<span class="w"> </span>-q<span class="w"> </span>-O<span class="w"> </span>-<span class="w"> </span>https://dl.google.com/linux/linux_signing_key.pub<span class="w"> </span><span class="p">|</span><span class="w"> </span>apt-key<span class="w"> </span>add<span class="w"> </span>-<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/etc/apt/sources.list.d/google-chrome.list<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>google-chrome-stable<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>/var/lib/apt/lists/*

<span class="c"># 安装ChromeDriver</span>
<span class="k">RUN</span><span class="w"> </span><span class="nv">CHROME_DRIVER_VERSION</span><span class="o">=</span><span class="sb">`</span>curl<span class="w"> </span>-sS<span class="w"> </span>chromedriver.storage.googleapis.com/LATEST_RELEASE<span class="sb">`</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>wget<span class="w"> </span>-O<span class="w"> </span>/tmp/chromedriver.zip<span class="w"> </span>http://chromedriver.storage.googleapis.com/<span class="nv">$CHROME_DRIVER_VERSION</span>/chromedriver_linux64.zip<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>unzip<span class="w"> </span>/tmp/chromedriver.zip<span class="w"> </span>chromedriver<span class="w"> </span>-d<span class="w"> </span>/usr/local/bin/<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>/tmp/chromedriver.zip

<span class="k">COPY</span><span class="w"> </span>requirements.txt<span class="w"> </span>.
<span class="k">RUN</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--no-cache-dir<span class="w"> </span>-r<span class="w"> </span>requirements.txt

<span class="k">COPY</span><span class="w"> </span>src/<span class="w"> </span>./src/
<span class="k">COPY</span><span class="w"> </span>config/<span class="w"> </span>./config/

<span class="k">ENV</span><span class="w"> </span><span class="nv">PYTHONPATH</span><span class="o">=</span>/app

<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;python&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;src/workers/data_collector.py&quot;</span><span class="p">]</span>
</code></pre></div>
<h4 id="523">5.2.3 前端应用容器<a class="headerlink" href="#523" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c"># Dockerfile.frontend</span>
<span class="c"># 构建阶段</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">node:18-alpine</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">builder</span>

<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>

<span class="k">COPY</span><span class="w"> </span>frontend/package*.json<span class="w"> </span>./
<span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>ci<span class="w"> </span>--only<span class="o">=</span>production

<span class="k">COPY</span><span class="w"> </span>frontend/<span class="w"> </span>.
<span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>run<span class="w"> </span>build

<span class="c"># 生产阶段</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">nginx:alpine</span>

<span class="c"># 复制构建文件</span>
<span class="k">COPY</span><span class="w"> </span>--from<span class="o">=</span>builder<span class="w"> </span>/app/dist<span class="w"> </span>/usr/share/nginx/html

<span class="c"># 复制Nginx配置</span>
<span class="k">COPY</span><span class="w"> </span>nginx.conf<span class="w"> </span>/etc/nginx/nginx.conf

<span class="c"># 健康检查</span>
<span class="k">HEALTHCHECK</span><span class="w"> </span>--interval<span class="o">=</span>30s<span class="w"> </span>--timeout<span class="o">=</span>3s<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="k">CMD</span><span class="w"> </span>curl<span class="w"> </span>-f<span class="w"> </span>http://localhost:80/<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>

<span class="k">EXPOSE</span><span class="w"> </span><span class="s">80</span>

<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;nginx&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-g&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;daemon off;&quot;</span><span class="p">]</span>
</code></pre></div>
<h3 id="53-kubernetes">5.3 Kubernetes部署配置<a class="headerlink" href="#53-kubernetes" title="Permanent link">&para;</a></h3>
<h4 id="531-api">5.3.1 API服务部署<a class="headerlink" href="#531-api" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># k8s/api-deployment.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction/api:latest</span>
<span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DATABASE_URL</span>
<span class="w">          </span><span class="nt">valueFrom</span><span class="p">:</span>
<span class="w">            </span><span class="nt">secretKeyRef</span><span class="p">:</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">db-secret</span>
<span class="w">              </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">url</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REDIS_URL</span>
<span class="w">          </span><span class="nt">valueFrom</span><span class="p">:</span>
<span class="w">            </span><span class="nt">configMapKeyRef</span><span class="p">:</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-config</span>
<span class="w">              </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis-url</span>
<span class="w">        </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">          </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;512Mi&quot;</span>
<span class="w">            </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;250m&quot;</span>
<span class="w">          </span><span class="nt">limits</span><span class="p">:</span>
<span class="w">            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1Gi&quot;</span>
<span class="w">            </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;500m&quot;</span>
<span class="w">        </span><span class="nt">livenessProbe</span><span class="p">:</span>
<span class="w">          </span><span class="nt">httpGet</span><span class="p">:</span>
<span class="w">            </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/health</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<span class="w">          </span><span class="nt">initialDelaySeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<span class="w">          </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">        </span><span class="nt">readinessProbe</span><span class="p">:</span>
<span class="w">          </span><span class="nt">httpGet</span><span class="p">:</span>
<span class="w">            </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/ready</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<span class="w">          </span><span class="nt">initialDelaySeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">          </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>

<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api-service</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api</span>
<span class="w">  </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterIP</span>
</code></pre></div>
<h4 id="532">5.3.2 数据库配置<a class="headerlink" href="#532" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># k8s/database-config.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-config</span>
<span class="nt">data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">my.cnf</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">[mysqld]</span>
<span class="w">    </span><span class="no">innodb_buffer_pool_size = 2G</span>
<span class="w">    </span><span class="no">innodb_log_file_size = 256M</span>
<span class="w">    </span><span class="no">max_connections = 500</span>
<span class="w">    </span><span class="no">query_cache_size = 128M</span>
<span class="w">    </span><span class="no">slow_query_log = 1</span>
<span class="w">    </span><span class="no">long_query_time = 2</span>

<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">StatefulSet</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-master</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">serviceName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-master</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-master</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-master</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql:8.0</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MYSQL_ROOT_PASSWORD</span>
<span class="w">          </span><span class="nt">valueFrom</span><span class="p">:</span>
<span class="w">            </span><span class="nt">secretKeyRef</span><span class="p">:</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-secret</span>
<span class="w">              </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">root-password</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MYSQL_DATABASE</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football_prediction</span>
<span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3306</span>
<span class="w">        </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-data</span>
<span class="w">          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/lib/mysql</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-config</span>
<span class="w">          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/mysql/conf.d</span>
<span class="w">        </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">          </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2Gi&quot;</span>
<span class="w">            </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000m&quot;</span>
<span class="w">          </span><span class="nt">limits</span><span class="p">:</span>
<span class="w">            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4Gi&quot;</span>
<span class="w">            </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2000m&quot;</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-config</span>
<span class="w">        </span><span class="nt">configMap</span><span class="p">:</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-config</span>
<span class="w">  </span><span class="nt">volumeClaimTemplates</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-data</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">accessModes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;ReadWriteOnce&quot;</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">        </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">          </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100Gi</span>
</code></pre></div>
<h4 id="533">5.3.3 负载均衡配置<a class="headerlink" href="#533" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># k8s/ingress.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-ingress</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">kubernetes.io/ingress.class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">    </span><span class="nt">cert-manager.io/cluster-issuer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">letsencrypt-prod</span>
<span class="w">    </span><span class="nt">nginx.ingress.kubernetes.io/rate-limit</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;100&quot;</span>
<span class="w">    </span><span class="nt">nginx.ingress.kubernetes.io/rate-limit-window</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1m&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tls</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api.football-prediction.com</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction.com</span>
<span class="w">    </span><span class="nt">secretName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-tls</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction.com</span>
<span class="w">    </span><span class="nt">http</span><span class="p">:</span>
<span class="w">      </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">        </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">        </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">          </span><span class="nt">service</span><span class="p">:</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-frontend-service</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span>
<span class="w">              </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api.football-prediction.com</span>
<span class="w">    </span><span class="nt">http</span><span class="p">:</span>
<span class="w">      </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">        </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">        </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">          </span><span class="nt">service</span><span class="p">:</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api-service</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span>
<span class="w">              </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div>
<h3 id="54">5.4 云端与本地部署方案对比<a class="headerlink" href="#54" title="Permanent link">&para;</a></h3>
<h4 id="541">5.4.1 本地部署方案<a class="headerlink" href="#541" title="Permanent link">&para;</a></h4>
<p><strong>优势：</strong></p>
<ul>
<li>完全可控的环境和数据</li>
<li>无需担心云服务商限制和费用</li>
<li>适合开发测试和小规模使用</li>
</ul>
<p><strong>劣势：</strong></p>
<ul>
<li>需要自己维护硬件和网络</li>
<li>扩展性有限</li>
<li>需要更多运维工作</li>
</ul>
<p><strong>适用场景：</strong></p>
<ul>
<li>开发测试环境</li>
<li>预算有限的个人项目</li>
<li>对数据安全要求极高的场景</li>
</ul>
<p><strong>部署配置：</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># docker-compose.yml</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.8&#39;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">api</span><span class="p">:</span>
<span class="w">    </span><span class="nt">build</span><span class="p">:</span>
<span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.</span>
<span class="w">      </span><span class="nt">dockerfile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Dockerfile.api</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;8000:8000&quot;</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DATABASE_URL=mysql://user:pass@mysql:3306/football</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REDIS_URL=redis://redis:6379</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>

<span class="w">  </span><span class="nt">frontend</span><span class="p">:</span>
<span class="w">    </span><span class="nt">build</span><span class="p">:</span>
<span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.</span>
<span class="w">      </span><span class="nt">dockerfile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Dockerfile.frontend</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:80&quot;</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>

<span class="w">  </span><span class="nt">mysql</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql:8.0</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MYSQL_ROOT_PASSWORD=rootpassword</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MYSQL_DATABASE=football</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql_data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>

<span class="w">  </span><span class="nt">redis</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:7-alpine</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis_data:/data</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>

<span class="w">  </span><span class="nt">data_collector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">build</span><span class="p">:</span>
<span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.</span>
<span class="w">      </span><span class="nt">dockerfile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Dockerfile.worker</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DATABASE_URL=mysql://user:pass@mysql:3306/football</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">mysql_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">redis_data</span><span class="p">:</span>
</code></pre></div>
<h4 id="542">5.4.2 云端部署方案<a class="headerlink" href="#542" title="Permanent link">&para;</a></h4>
<p><strong>优势：</strong></p>
<ul>
<li>高可用性和自动扩展</li>
<li>专业的运维和安全保障</li>
<li>全球CDN加速</li>
<li>丰富的云服务生态</li>
</ul>
<p><strong>劣势：</strong></p>
<ul>
<li>持续的运营成本</li>
<li>可能的厂商锁定</li>
<li>数据传输和存储限制</li>
</ul>
<p><strong>适用场景：</strong></p>
<ul>
<li>生产环境部署</li>
<li>需要高可用性的应用</li>
<li>全球用户访问的服务</li>
</ul>
<p><strong>推荐云服务商选择（优先香港节点）：</strong></p>
<ol>
<li><strong>阿里云（香港）</strong></li>
<li>优势：对大陆访问友好，服务稳定</li>
<li>适合：国内外双重覆盖</li>
<li>
<p>成本：中等</p>
</li>
<li>
<p><strong>腾讯云（香港）</strong></p>
</li>
<li>优势：网络延迟低，价格合理</li>
<li>适合：国内用户为主的应用</li>
<li>
<p>成本：较低</p>
</li>
<li>
<p><strong>AWS（亚太-香港）</strong></p>
</li>
<li>优势：全球化服务，生态丰富</li>
<li>适合：需要全球部署的应用</li>
<li>
<p>成本：较高</p>
</li>
<li>
<p><strong>Google Cloud（香港）</strong></p>
</li>
<li>优势：AI/ML服务强大</li>
<li>适合：机器学习重度应用</li>
<li>成本：中等</li>
</ol>
<h3 id="55-kubernetes">5.5 Kubernetes扩展配置<a class="headerlink" href="#55-kubernetes" title="Permanent link">&para;</a></h3>
<h4 id="551">5.5.1 自动伸缩配置<a class="headerlink" href="#551" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># k8s/hpa.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">autoscaling/v2</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HorizontalPodAutoscaler</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api-hpa</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">scaleTargetRef</span><span class="p">:</span>
<span class="w">    </span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api</span>
<span class="w">  </span><span class="nt">minReplicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="nt">maxReplicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">  </span><span class="nt">metrics</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Resource</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cpu</span>
<span class="w">      </span><span class="nt">target</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Utilization</span>
<span class="w">        </span><span class="nt">averageUtilization</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">70</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Resource</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">memory</span>
<span class="w">      </span><span class="nt">target</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Utilization</span>
<span class="w">        </span><span class="nt">averageUtilization</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">  </span><span class="nt">behavior</span><span class="p">:</span>
<span class="w">    </span><span class="nt">scaleUp</span><span class="p">:</span>
<span class="w">      </span><span class="nt">stabilizationWindowSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">      </span><span class="nt">policies</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pods</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">        </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">    </span><span class="nt">scaleDown</span><span class="p">:</span>
<span class="w">      </span><span class="nt">stabilizationWindowSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">300</span>
<span class="w">      </span><span class="nt">policies</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pods</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">        </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
</code></pre></div>
<h4 id="552">5.5.2 资源配额管理<a class="headerlink" href="#552" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># k8s/resource-quota.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ResourceQuota</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-quota</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hard</span><span class="p">:</span>
<span class="w">    </span><span class="nt">requests.cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span>
<span class="w">    </span><span class="nt">requests.memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8Gi</span>
<span class="w">    </span><span class="nt">limits.cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;8&quot;</span>
<span class="w">    </span><span class="nt">limits.memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16Gi</span>
<span class="w">    </span><span class="nt">count/pods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<span class="w">    </span><span class="nt">count/services</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">    </span><span class="nt">count/secrets</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">    </span><span class="nt">count/configmaps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>

<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LimitRange</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-limits</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">limits</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">default</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500m</span>
<span class="w">      </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1Gi</span>
<span class="w">    </span><span class="nt">defaultRequest</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100m</span>
<span class="w">      </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">256Mi</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Container</span>
</code></pre></div>
<h3 id="56">5.6 监控和告警系统<a class="headerlink" href="#56" title="Permanent link">&para;</a></h3>
<h4 id="561-prometheus">5.6.1 Prometheus监控配置<a class="headerlink" href="#561-prometheus" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># monitoring/prometheus-config.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prometheus-config</span>
<span class="nt">data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prometheus.yml</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">global:</span>
<span class="w">      </span><span class="no">scrape_interval: 15s</span>
<span class="w">      </span><span class="no">evaluation_interval: 15s</span>

<span class="w">    </span><span class="no">rule_files:</span>
<span class="w">      </span><span class="no">- &quot;/etc/prometheus/rules/*.yml&quot;</span>

<span class="w">    </span><span class="no">alerting:</span>
<span class="w">      </span><span class="no">alertmanagers:</span>
<span class="w">      </span><span class="no">- static_configs:</span>
<span class="w">        </span><span class="no">- targets:</span>
<span class="w">          </span><span class="no">- alertmanager:9093</span>

<span class="w">    </span><span class="no">scrape_configs:</span>
<span class="w">    </span><span class="no">- job_name: &#39;kubernetes-pods&#39;</span>
<span class="w">      </span><span class="no">kubernetes_sd_configs:</span>
<span class="w">      </span><span class="no">- role: pod</span>
<span class="w">      </span><span class="no">relabel_configs:</span>
<span class="w">      </span><span class="no">- source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_scrape]</span>
<span class="w">        </span><span class="no">action: keep</span>
<span class="w">        </span><span class="no">regex: true</span>
<span class="w">      </span><span class="no">- source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_path]</span>
<span class="w">        </span><span class="no">action: replace</span>
<span class="w">        </span><span class="no">target_label: __metrics_path__</span>
<span class="w">        </span><span class="no">regex: (.+)</span>

<span class="w">    </span><span class="no">- job_name: &#39;football-prediction-api&#39;</span>
<span class="w">      </span><span class="no">static_configs:</span>
<span class="w">      </span><span class="no">- targets: [&#39;football-prediction-api-service:80&#39;]</span>
<span class="w">      </span><span class="no">metrics_path: /metrics</span>
<span class="w">      </span><span class="no">scrape_interval: 10s</span>
</code></pre></div>
<h4 id="562">5.6.2 告警规则配置<a class="headerlink" href="#562" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># monitoring/alert-rules.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prometheus-rules</span>
<span class="nt">data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">football-prediction.yml</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">groups:</span>
<span class="w">    </span><span class="no">- name: football-prediction</span>
<span class="w">      </span><span class="no">rules:</span>
<span class="w">      </span><span class="no">- alert: HighErrorRate</span>
<span class="w">        </span><span class="no">expr: rate(http_requests_total{status=~&quot;5..&quot;}[5m]) &gt; 0.1</span>
<span class="w">        </span><span class="no">for: 5m</span>
<span class="w">        </span><span class="no">labels:</span>
<span class="w">          </span><span class="no">severity: warning</span>
<span class="w">        </span><span class="no">annotations:</span>
<span class="w">          </span><span class="no">summary: &quot;High error rate detected&quot;</span>
<span class="w">          </span><span class="no">description: &quot;Error rate is {{ $value }} for {{ $labels.instance }}&quot;</span>

<span class="w">      </span><span class="no">- alert: HighResponseTime</span>
<span class="w">        </span><span class="no">expr: histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m])) &gt; 1</span>
<span class="w">        </span><span class="no">for: 2m</span>
<span class="w">        </span><span class="no">labels:</span>
<span class="w">          </span><span class="no">severity: warning</span>
<span class="w">        </span><span class="no">annotations:</span>
<span class="w">          </span><span class="no">summary: &quot;High response time detected&quot;</span>
<span class="w">          </span><span class="no">description: &quot;95th percentile response time is {{ $value }}s&quot;</span>

<span class="w">      </span><span class="no">- alert: DatabaseConnectionFailure</span>
<span class="w">        </span><span class="no">expr: mysql_up == 0</span>
<span class="w">        </span><span class="no">for: 1m</span>
<span class="w">        </span><span class="no">labels:</span>
<span class="w">          </span><span class="no">severity: critical</span>
<span class="w">        </span><span class="no">annotations:</span>
<span class="w">          </span><span class="no">summary: &quot;Database connection failure&quot;</span>
<span class="w">          </span><span class="no">description: &quot;MySQL database is down&quot;</span>

<span class="w">      </span><span class="no">- alert: PredictionServiceDown</span>
<span class="w">        </span><span class="no">expr: up{job=&quot;football-prediction-api&quot;} == 0</span>
<span class="w">        </span><span class="no">for: 2m</span>
<span class="w">        </span><span class="no">labels:</span>
<span class="w">          </span><span class="no">severity: critical</span>
<span class="w">        </span><span class="no">annotations:</span>
<span class="w">          </span><span class="no">summary: &quot;Prediction service is down&quot;</span>
<span class="w">          </span><span class="no">description: &quot;Football prediction API is not responding&quot;</span>
</code></pre></div>
<h4 id="563-grafana">5.6.3 Grafana仪表板配置<a class="headerlink" href="#563-grafana" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;dashboard&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;足球预测系统监控&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;panels&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;API请求QPS&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;graph&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;expr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;rate(http_requests_total[5m])&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;legendFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{method}} {{status}}&quot;</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;响应时间分布&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;graph&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;expr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;histogram_quantile(0.50, rate(http_request_duration_seconds_bucket[5m]))&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;legendFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;50th percentile&quot;</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;expr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m]))&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;legendFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;95th percentile&quot;</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;数据库连接池状态&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;stat&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;expr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mysql_global_status_threads_connected&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;legendFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Active Connections&quot;</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;预测准确率趋势&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;graph&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;expr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;prediction_accuracy_rate&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;legendFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Accuracy Rate&quot;</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="57">5.7 安全配置<a class="headerlink" href="#57" title="Permanent link">&para;</a></h3>
<h4 id="571">5.7.1 网络安全策略<a class="headerlink" href="#571" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># k8s/network-policy.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetworkPolicy</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-network-policy</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">podSelector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">football-prediction-api</span>
<span class="w">  </span><span class="nt">policyTypes</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Egress</span>
<span class="w">  </span><span class="nt">ingress</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">from</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">podSelector</span><span class="p">:</span>
<span class="w">        </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">          </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-ingress</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<span class="w">  </span><span class="nt">egress</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">to</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">podSelector</span><span class="p">:</span>
<span class="w">        </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">          </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql-master</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3306</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">to</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">podSelector</span><span class="p">:</span>
<span class="w">        </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">          </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6379</span>
</code></pre></div>
<h4 id="572">5.7.2 密钥管理<a class="headerlink" href="#572" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># k8s/secrets.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Secret</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">db-secret</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Opaque</span>
<span class="nt">stringData</span><span class="p">:</span>
<span class="w">  </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql://username:password@mysql-master:3306/football_prediction</span>
<span class="w">  </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app_user</span>
<span class="w">  </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secure_password_here</span>

<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Secret</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api-secret</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Opaque</span>
<span class="nt">stringData</span><span class="p">:</span>
<span class="w">  </span><span class="nt">jwt-secret</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">your_jwt_secret_key_here</span>
<span class="w">  </span><span class="nt">api-key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">your_api_key_here</span>
</code></pre></div>
<hr />
<h2 id="6">6. 未来扩展建议<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 模型自动更新机制<a class="headerlink" href="#61" title="Permanent link">&para;</a></h3>
<h4 id="611">6.1.1 自动重训练流水线<a class="headerlink" href="#611" title="Permanent link">&para;</a></h4>
<p><strong>设计目标：</strong></p>
<ul>
<li>实现模型性能的持续监控和自动优化</li>
<li>基于新数据和反馈建立自适应学习系统</li>
<li>确保预测质量随时间推移不断提升</li>
</ul>
<p><strong>核心组件架构：</strong></p>
<div class="highlight"><pre><span></span><code>graph TD
    A[数据变化监测] --&gt; B{是否需要重训练}
    B --&gt;|是| C[自动数据准备]
    B --&gt;|否| D[继续监控]
    C --&gt; E[特征工程更新]
    E --&gt; F[模型训练]
    F --&gt; G[模型验证]
    G --&gt; H{性能是否提升}
    H --&gt;|是| I[模型部署]
    H --&gt;|否| J[回滚到上一版本]
    I --&gt; K[A/B测试]
    K --&gt; L[性能监控]
    L --&gt; A
    J --&gt; A
</code></pre></div>
<p><strong>实现方案：</strong></p>
<ol>
<li><strong>数据质量监控</strong></li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1"># src/ml/monitoring/data_monitor.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DataQualityMonitor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;completeness&#39;</span><span class="p">:</span> <span class="mf">0.95</span><span class="p">,</span>
            <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="mf">0.98</span><span class="p">,</span>
            <span class="s1">&#39;consistency&#39;</span><span class="p">:</span> <span class="mf">0.99</span><span class="p">,</span>
            <span class="s1">&#39;freshness&#39;</span><span class="p">:</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">3600</span>  <span class="c1"># 24小时</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_retrain_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;检查是否需要重新训练&quot;&quot;&quot;</span>
        <span class="n">conditions</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;data_volume&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_new_data_volume</span><span class="p">(),</span>
            <span class="s1">&#39;performance_degradation&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_model_performance</span><span class="p">(),</span>
            <span class="s1">&#39;concept_drift&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_detect_concept_drift</span><span class="p">(),</span>
            <span class="s1">&#39;scheduled&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_schedule</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">conditions</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">conditions</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_detect_concept_drift</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;检测概念漂移&quot;&quot;&quot;</span>
        <span class="n">recent_accuracy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_recent_accuracy</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
        <span class="n">historical_accuracy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_historical_accuracy</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">historical_accuracy</span> <span class="o">-</span> <span class="n">recent_accuracy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.05</span>
</code></pre></div>
<ol>
<li><strong>自动训练调度器</strong></li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1"># src/ml/training/auto_trainer.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AutoTrainer</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_registry</span> <span class="o">=</span> <span class="n">ModelRegistry</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">training_pipeline</span> <span class="o">=</span> <span class="n">TrainingPipeline</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute_retrain_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;执行自动重训练流水线&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># 1. 数据准备</span>
            <span class="n">training_data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_training_data</span><span class="p">()</span>

            <span class="c1"># 2. 特征工程</span>
            <span class="n">features</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_features</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>

            <span class="c1"># 3. 模型训练</span>
            <span class="n">new_model</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_train_model</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

            <span class="c1"># 4. 模型验证</span>
            <span class="n">validation_results</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_model</span><span class="p">(</span><span class="n">new_model</span><span class="p">)</span>

            <span class="c1"># 5. 性能比较</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_model_better</span><span class="p">(</span><span class="n">validation_results</span><span class="p">):</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_deploy_model</span><span class="p">(</span><span class="n">new_model</span><span class="p">)</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_ab_test</span><span class="p">(</span><span class="n">new_model</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;新模型性能不如现有模型，跳过部署&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;自动重训练失败: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_notify_failure</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
<ol>
<li><strong>模型版本管理</strong></li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1"># src/ml/registry/model_registry.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ModelRegistry</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storage_backend</span> <span class="o">=</span> <span class="n">S3Backend</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata_store</span> <span class="o">=</span> <span class="n">PostgreSQLStore</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">register_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">metadata</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;注册新模型版本&quot;&quot;&quot;</span>
        <span class="n">version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_version</span><span class="p">()</span>
        <span class="n">model_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;models/football_prediction/v</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># 保存模型文件</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storage_backend</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">model_path</span><span class="p">)</span>

        <span class="c1"># 保存元数据</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata_store</span><span class="o">.</span><span class="n">save</span><span class="p">({</span>
            <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="n">version</span><span class="p">,</span>
            <span class="s1">&#39;created_at&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
            <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;metrics&#39;</span><span class="p">],</span>
            <span class="s1">&#39;features&#39;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">],</span>
            <span class="s1">&#39;training_data_hash&#39;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;data_hash&#39;</span><span class="p">]</span>
        <span class="p">})</span>

        <span class="k">return</span> <span class="n">version</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rollback_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_version</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;回滚到指定版本&quot;&quot;&quot;</span>
        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_backend</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;models/football_prediction/v</span><span class="si">{</span><span class="n">target_version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_deploy_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;已回滚到模型版本 </span><span class="si">{</span><span class="n">target_version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h4 id="612-ab">6.1.2 A/B测试框架<a class="headerlink" href="#612-ab" title="Permanent link">&para;</a></h4>
<p><strong>实现多版本模型并行测试：</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># src/prediction/ab_testing/experiment.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ABTestManager</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiments</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">traffic_splitter</span> <span class="o">=</span> <span class="n">TrafficSplitter</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_experiment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">control_model</span><span class="p">,</span> <span class="n">treatment_model</span><span class="p">,</span> <span class="n">traffic_split</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;创建A/B测试实验&quot;&quot;&quot;</span>
        <span class="n">experiment</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;control_model&#39;</span><span class="p">:</span> <span class="n">control_model</span><span class="p">,</span>
            <span class="s1">&#39;treatment_model&#39;</span><span class="p">:</span> <span class="n">treatment_model</span><span class="p">,</span>
            <span class="s1">&#39;traffic_split&#39;</span><span class="p">:</span> <span class="n">traffic_split</span><span class="p">,</span>
            <span class="s1">&#39;start_time&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
            <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiments</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">experiment</span>
        <span class="k">return</span> <span class="n">experiment</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">route_prediction_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;根据A/B测试策略路由预测请求&quot;&quot;&quot;</span>
        <span class="n">active_experiment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_active_experiment</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">active_experiment</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_should_use_treatment</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">active_experiment</span><span class="p">[</span><span class="s1">&#39;treatment_model&#39;</span><span class="p">]</span>
            <span class="n">variant</span> <span class="o">=</span> <span class="s1">&#39;treatment&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">active_experiment</span><span class="p">[</span><span class="s1">&#39;control_model&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">active_experiment</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_model</span>
            <span class="n">variant</span> <span class="o">=</span> <span class="s1">&#39;control&#39;</span>

        <span class="c1"># 执行预测</span>
        <span class="n">prediction</span> <span class="o">=</span> <span class="k">await</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

        <span class="c1"># 记录实验数据</span>
        <span class="k">if</span> <span class="n">active_experiment</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_experiment_data</span><span class="p">(</span><span class="n">active_experiment</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">variant</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">prediction</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">prediction</span>
</code></pre></div>
<h3 id="62">6.2 实时赔率和球队动态增量采集<a class="headerlink" href="#62" title="Permanent link">&para;</a></h3>
<h4 id="621">6.2.1 实时数据流处理架构<a class="headerlink" href="#621" title="Permanent link">&para;</a></h4>
<p><strong>技术选型：</strong></p>
<ul>
<li>Apache Kafka作为消息队列</li>
<li>Apache Flink/Spark Streaming进行流处理</li>
<li>WebSocket连接获取实时赔率变化</li>
</ul>
<p><strong>架构设计：</strong></p>
<div class="highlight"><pre><span></span><code>graph LR
    subgraph &quot;数据源&quot;
        A1[博彩网站WebSocket]
        A2[体育数据API]
        A3[社交媒体监控]
        A4[新闻爬虫]
    end

    subgraph &quot;消息队列&quot;
        B[Apache Kafka]
    end

    subgraph &quot;流处理&quot;
        C1[Flink - 赔率处理]
        C2[Flink - 新闻分析]
        C3[Flink - 社媒情感]
    end

    subgraph &quot;实时存储&quot;
        D1[(Redis Stream)]
        D2[(InfluxDB)]
    end

    subgraph &quot;预测服务&quot;
        E[实时预测引擎]
    end

    A1 &amp; A2 &amp; A3 &amp; A4 --&gt; B
    B --&gt; C1 &amp; C2 &amp; C3
    C1 &amp; C2 &amp; C3 --&gt; D1 &amp; D2
    D1 &amp; D2 --&gt; E
</code></pre></div>
<p><strong>实现方案：</strong></p>
<ol>
<li><strong>实时赔率采集器</strong></li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1"># src/real_time/collectors/odds_stream.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RealTimeOddsCollector</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kafka_producer</span> <span class="o">=</span> <span class="n">KafkaProducer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">websocket_connections</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">start_odds_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bookmakers</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;启动实时赔率流采集&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">bookmaker</span> <span class="ow">in</span> <span class="n">bookmakers</span><span class="p">:</span>
            <span class="n">connection</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_websocket_connection</span><span class="p">(</span><span class="n">bookmaker</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">websocket_connections</span><span class="p">[</span><span class="n">bookmaker</span><span class="p">]</span> <span class="o">=</span> <span class="n">connection</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle_odds_stream</span><span class="p">(</span><span class="n">bookmaker</span><span class="p">,</span> <span class="n">connection</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_handle_odds_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bookmaker</span><span class="p">,</span> <span class="n">connection</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;处理赔率流数据&quot;&quot;&quot;</span>
        <span class="k">async</span> <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">connection</span><span class="p">:</span>
            <span class="n">odds_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_odds_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">bookmaker</span><span class="p">)</span>

            <span class="c1"># 发送到Kafka</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">kafka_producer</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;odds_stream&#39;</span><span class="p">,</span> <span class="p">{</span>
                <span class="s1">&#39;bookmaker&#39;</span><span class="p">:</span> <span class="n">bookmaker</span><span class="p">,</span>
                <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">odds_data</span>
            <span class="p">})</span>

            <span class="c1"># 检测显著变化</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_detect_significant_change</span><span class="p">(</span><span class="n">odds_data</span><span class="p">):</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_prediction_update</span><span class="p">(</span><span class="n">odds_data</span><span class="p">)</span>
</code></pre></div>
<ol>
<li><strong>流处理引擎</strong></li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1"># src/real_time/processors/odds_processor.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">OddsStreamProcessor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flink_env</span> <span class="o">=</span> <span class="n">StreamExecutionEnvironment</span><span class="o">.</span><span class="n">get_execution_environment</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_processing_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;创建赔率流处理管道&quot;&quot;&quot;</span>
        <span class="c1"># 从Kafka读取赔率流</span>
        <span class="n">odds_stream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flink_env</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span>
            <span class="n">FlinkKafkaConsumer</span><span class="p">(</span><span class="s1">&#39;odds_stream&#39;</span><span class="p">,</span> <span class="n">SimpleStringSchema</span><span class="p">(),</span> <span class="n">kafka_props</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># 数据清洗和标准化</span>
        <span class="n">cleaned_stream</span> <span class="o">=</span> <span class="n">odds_stream</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_clean_odds_data</span><span class="p">)</span>

        <span class="c1"># 计算移动平均和趋势</span>
        <span class="n">windowed_stream</span> <span class="o">=</span> <span class="n">cleaned_stream</span><span class="o">.</span><span class="n">key_by</span><span class="p">(</span><span class="s1">&#39;match_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">time_window</span><span class="p">(</span><span class="n">Time</span><span class="o">.</span><span class="n">minutes</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
        <span class="n">trend_stream</span> <span class="o">=</span> <span class="n">windowed_stream</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">OddsTrendCalculator</span><span class="p">())</span>

        <span class="c1"># 检测异常波动</span>
        <span class="n">anomaly_stream</span> <span class="o">=</span> <span class="n">trend_stream</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">AnomalyDetector</span><span class="p">())</span>

        <span class="c1"># 输出到存储系统</span>
        <span class="n">trend_stream</span><span class="o">.</span><span class="n">add_sink</span><span class="p">(</span><span class="n">RedisSink</span><span class="p">(</span><span class="s1">&#39;odds_trends&#39;</span><span class="p">))</span>
        <span class="n">anomaly_stream</span><span class="o">.</span><span class="n">add_sink</span><span class="p">(</span><span class="n">AlertingSink</span><span class="p">(</span><span class="s1">&#39;odds_anomalies&#39;</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flink_env</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;OddsProcessingJob&quot;</span><span class="p">)</span>
</code></pre></div>
<h4 id="622">6.2.2 球队动态信息采集<a class="headerlink" href="#622" title="Permanent link">&para;</a></h4>
<p><strong>信息源整合：</strong></p>
<ul>
<li>官方球队网站和社交媒体</li>
<li>体育新闻网站</li>
<li>球员伤病报告</li>
<li>转会市场信息</li>
</ul>
<p><strong>实现方案：</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># src/real_time/collectors/team_news.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TeamNewsCollector</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">news_sources</span> <span class="o">=</span> <span class="n">NewsSourceRegistry</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nlp_processor</span> <span class="o">=</span> <span class="n">NLPProcessor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kafka_producer</span> <span class="o">=</span> <span class="n">KafkaProducer</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">collect_team_news</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">teams</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;采集球队动态新闻&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">teams</span><span class="p">:</span>
            <span class="n">news_items</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_team_news</span><span class="p">(</span><span class="n">team</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">news</span> <span class="ow">in</span> <span class="n">news_items</span><span class="p">:</span>
                <span class="c1"># NLP分析新闻内容</span>
                <span class="n">analysis</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlp_processor</span><span class="o">.</span><span class="n">analyze_news</span><span class="p">(</span><span class="n">news</span><span class="p">)</span>

                <span class="c1"># 提取关键信息</span>
                <span class="n">extracted_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_key_info</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">extracted_info</span><span class="p">[</span><span class="s1">&#39;importance&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">:</span>  <span class="c1"># 高重要性新闻</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_to_processing</span><span class="p">(</span><span class="n">team</span><span class="p">,</span> <span class="n">extracted_info</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_key_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analysis</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;提取关键信息&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;player_injuries&#39;</span><span class="p">:</span> <span class="n">analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;injuries&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="s1">&#39;lineup_changes&#39;</span><span class="p">:</span> <span class="n">analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lineup_changes&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="s1">&#39;coaching_changes&#39;</span><span class="p">:</span> <span class="n">analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;coaching_news&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="s1">&#39;sentiment_score&#39;</span><span class="p">:</span> <span class="n">analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sentiment&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;importance&#39;</span><span class="p">:</span> <span class="n">analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;importance_score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">}</span>
</code></pre></div>
<h3 id="63">6.3 高并发架构优化<a class="headerlink" href="#63" title="Permanent link">&para;</a></h3>
<h4 id="631">6.3.1 缓存策略升级<a class="headerlink" href="#631" title="Permanent link">&para;</a></h4>
<p><strong>多层缓存架构：</strong></p>
<div class="highlight"><pre><span></span><code>graph TD
    A[用户请求] --&gt; B[CDN缓存]
    B --&gt; C{缓存命中?}
    C --&gt;|是| D[返回结果]
    C --&gt;|否| E[应用层缓存 - Redis]
    E --&gt; F{缓存命中?}
    F --&gt;|是| G[返回结果]
    F --&gt;|否| H[数据库缓存 - Redis]
    H --&gt; I{缓存命中?}
    I --&gt;|是| J[返回结果]
    I --&gt;|否| K[数据库查询]
    K --&gt; L[更新所有缓存层]
    L --&gt; M[返回结果]
</code></pre></div>
<p><strong>缓存实现策略：</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># src/cache/multi_level_cache.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MultiLevelCache</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l1_cache</span> <span class="o">=</span> <span class="n">LocalLRUCache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>  <span class="c1"># 本地缓存</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l2_cache</span> <span class="o">=</span> <span class="n">RedisCache</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;redis-cluster&#39;</span><span class="p">)</span>  <span class="c1"># 分布式缓存</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l3_cache</span> <span class="o">=</span> <span class="n">DatabaseQueryCache</span><span class="p">()</span>  <span class="c1"># 查询结果缓存</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">match_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;多级缓存获取预测结果&quot;&quot;&quot;</span>
        <span class="c1"># L1 缓存 - 本地内存</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">l1_cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;prediction:</span><span class="si">{</span><span class="n">match_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="c1"># L2 缓存 - Redis</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">l2_cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;prediction:</span><span class="si">{</span><span class="n">match_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">l1_cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;prediction:</span><span class="si">{</span><span class="n">match_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="c1"># L3 缓存 - 数据库查询缓存</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">l3_cache</span><span class="o">.</span><span class="n">get_or_compute</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;prediction:</span><span class="si">{</span><span class="n">match_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_prediction</span><span class="p">(</span><span class="n">match_id</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># 更新上层缓存</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">l2_cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;prediction:</span><span class="si">{</span><span class="n">match_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">1800</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l1_cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;prediction:</span><span class="si">{</span><span class="n">match_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">invalidate_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">match_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;预测结果失效处理&quot;&quot;&quot;</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;prediction:</span><span class="si">{</span><span class="n">match_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;features:</span><span class="si">{</span><span class="n">match_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>

        <span class="c1"># 删除所有层级的缓存</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">l1_cache</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">l2_cache</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">l3_cache</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</code></pre></div>
<h4 id="632">6.3.2 消息队列架构<a class="headerlink" href="#632" title="Permanent link">&para;</a></h4>
<p><strong>异步处理系统：</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># src/messaging/task_queue.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TaskQueueManager</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">celery_app</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">(</span><span class="s1">&#39;football_prediction&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kafka_producer</span> <span class="o">=</span> <span class="n">KafkaProducer</span><span class="p">()</span>

    <span class="nd">@celery_app</span><span class="o">.</span><span class="n">task</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">process_prediction_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">match_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;异步处理预测请求&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># 特征计算</span>
            <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_features</span><span class="p">(</span><span class="n">match_data</span><span class="p">)</span>

            <span class="c1"># 模型预测</span>
            <span class="n">prediction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_prediction</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

            <span class="c1"># 缓存结果</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cache_prediction_result</span><span class="p">(</span><span class="n">match_data</span><span class="p">[</span><span class="s1">&#39;match_id&#39;</span><span class="p">],</span> <span class="n">prediction</span><span class="p">)</span>

            <span class="c1"># 发送结果通知</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_notify_prediction_ready</span><span class="p">(</span><span class="n">match_data</span><span class="p">[</span><span class="s1">&#39;match_id&#39;</span><span class="p">],</span> <span class="n">prediction</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">retries</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span><span class="p">:</span>
                <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">countdown</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_handle_prediction_failure</span><span class="p">(</span><span class="n">match_data</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">))</span>
</code></pre></div>
<h4 id="633">6.3.3 数据库读写分离和分片<a class="headerlink" href="#633" title="Permanent link">&para;</a></h4>
<p><strong>数据库集群架构：</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># src/database/cluster_manager.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DatabaseClusterManager</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_master_connection</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_dbs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_read_replicas</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shard_router</span> <span class="o">=</span> <span class="n">ShardRouter</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_read_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_type</span><span class="o">=</span><span class="s1">&#39;general&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;获取读连接&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">query_type</span> <span class="o">==</span> <span class="s1">&#39;analytics&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_dbs</span><span class="p">[</span><span class="s1">&#39;analytics_replica&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">query_type</span> <span class="o">==</span> <span class="s1">&#39;realtime&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_dbs</span><span class="p">[</span><span class="s1">&#39;realtime_replica&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_dbs</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_write_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">shard_key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;获取写连接&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">shard_key</span><span class="p">:</span>
            <span class="n">shard</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shard_router</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">shard_key</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_db</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;shard_</span><span class="si">{</span><span class="n">shard</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_db</span><span class="p">[</span><span class="s1">&#39;master&#39;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute_read_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;执行读查询&quot;&quot;&quot;</span>
        <span class="n">connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_read_connection</span><span class="p">()</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">connection</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute_write_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shard_key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;执行写查询&quot;&quot;&quot;</span>
        <span class="n">connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_write_connection</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">shard_key</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</code></pre></div>
<h3 id="64">6.4 用户画像和个性化推荐<a class="headerlink" href="#64" title="Permanent link">&para;</a></h3>
<h4 id="641">6.4.1 用户行为分析系统<a class="headerlink" href="#641" title="Permanent link">&para;</a></h4>
<p><strong>用户画像建模：</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># src/personalization/user_profiling.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserProfiler</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">behavior_tracker</span> <span class="o">=</span> <span class="n">BehaviorTracker</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preference_engine</span> <span class="o">=</span> <span class="n">PreferenceEngine</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span> <span class="o">=</span> <span class="n">UserClusteringModel</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build_user_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;构建用户画像&quot;&quot;&quot;</span>
        <span class="c1"># 收集用户行为数据</span>
        <span class="n">behaviors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">behavior_tracker</span><span class="o">.</span><span class="n">get_user_behaviors</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>

        <span class="c1"># 分析用户偏好</span>
        <span class="n">preferences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_preferences</span><span class="p">(</span><span class="n">behaviors</span><span class="p">)</span>

        <span class="c1"># 用户聚类</span>
        <span class="n">cluster</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="o">.</span><span class="n">predict_cluster</span><span class="p">(</span><span class="n">preferences</span><span class="p">)</span>

        <span class="n">profile</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
            <span class="s1">&#39;favorite_teams&#39;</span><span class="p">:</span> <span class="n">preferences</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;teams&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="s1">&#39;favorite_leagues&#39;</span><span class="p">:</span> <span class="n">preferences</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;leagues&#39;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="s1">&#39;prediction_accuracy_interest&#39;</span><span class="p">:</span> <span class="n">preferences</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;accuracy_focus&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
            <span class="s1">&#39;risk_tolerance&#39;</span><span class="p">:</span> <span class="n">preferences</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;risk_tolerance&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">),</span>
            <span class="s1">&#39;interaction_frequency&#39;</span><span class="p">:</span> <span class="n">behaviors</span><span class="p">[</span><span class="s1">&#39;frequency&#39;</span><span class="p">],</span>
            <span class="s1">&#39;cluster&#39;</span><span class="p">:</span> <span class="n">cluster</span><span class="p">,</span>
            <span class="s1">&#39;created_at&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">profile</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_analyze_preferences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">behaviors</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;分析用户偏好&quot;&quot;&quot;</span>
        <span class="n">team_interactions</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">league_interactions</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">behavior</span> <span class="ow">in</span> <span class="n">behaviors</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">behavior</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;view_prediction&#39;</span><span class="p">:</span>
                <span class="n">match_info</span> <span class="o">=</span> <span class="n">behavior</span><span class="p">[</span><span class="s1">&#39;match_info&#39;</span><span class="p">]</span>
                <span class="n">team_interactions</span><span class="p">[</span><span class="n">match_info</span><span class="p">[</span><span class="s1">&#39;home_team&#39;</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">team_interactions</span><span class="p">[</span><span class="n">match_info</span><span class="p">[</span><span class="s1">&#39;away_team&#39;</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">league_interactions</span><span class="p">[</span><span class="n">match_info</span><span class="p">[</span><span class="s1">&#39;league&#39;</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;teams&#39;</span><span class="p">:</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">team_interactions</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                          <span class="n">key</span><span class="o">=</span><span class="n">team_interactions</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">5</span><span class="p">],</span>
            <span class="s1">&#39;leagues&#39;</span><span class="p">:</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">league_interactions</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                            <span class="n">key</span><span class="o">=</span><span class="n">league_interactions</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">3</span><span class="p">],</span>
            <span class="s1">&#39;accuracy_focus&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_accuracy_focus</span><span class="p">(</span><span class="n">behaviors</span><span class="p">),</span>
            <span class="s1">&#39;risk_tolerance&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_risk_tolerance</span><span class="p">(</span><span class="n">behaviors</span><span class="p">)</span>
        <span class="p">}</span>
</code></pre></div>
<h4 id="642">6.4.2 个性化推荐引擎<a class="headerlink" href="#642" title="Permanent link">&para;</a></h4>
<p><strong>推荐算法实现：</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># src/personalization/recommendation_engine.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PersonalizedRecommendationEngine</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collaborative_filter</span> <span class="o">=</span> <span class="n">CollaborativeFiltering</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_filter</span> <span class="o">=</span> <span class="n">ContentBasedFiltering</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hybrid_model</span> <span class="o">=</span> <span class="n">HybridRecommendationModel</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_personalized_matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;获取个性化比赛推荐&quot;&quot;&quot;</span>
        <span class="n">user_profile</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_user_profile</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>

        <span class="c1"># 基于内容的过滤</span>
        <span class="n">content_recommendations</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">content_filter</span><span class="o">.</span><span class="n">recommend</span><span class="p">(</span>
            <span class="n">user_profile</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="o">*</span><span class="mi">2</span>
        <span class="p">)</span>

        <span class="c1"># 协同过滤</span>
        <span class="n">collaborative_recommendations</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">collaborative_filter</span><span class="o">.</span><span class="n">recommend</span><span class="p">(</span>
            <span class="n">user_id</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="o">*</span><span class="mi">2</span>
        <span class="p">)</span>

        <span class="c1"># 混合推荐</span>
        <span class="n">final_recommendations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hybrid_model</span><span class="o">.</span><span class="n">combine_recommendations</span><span class="p">(</span>
            <span class="n">content_recommendations</span><span class="p">,</span>
            <span class="n">collaborative_recommendations</span><span class="p">,</span>
            <span class="n">user_profile</span><span class="p">,</span>
            <span class="n">limit</span><span class="o">=</span><span class="n">limit</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">final_recommendations</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_personalized_insights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">match_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;获取个性化预测见解&quot;&quot;&quot;</span>
        <span class="n">user_profile</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_user_profile</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
        <span class="n">base_prediction</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_prediction</span><span class="p">(</span><span class="n">match_id</span><span class="p">)</span>

        <span class="c1"># 根据用户偏好调整展示内容</span>
        <span class="n">insights</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;prediction&#39;</span><span class="p">:</span> <span class="n">base_prediction</span><span class="p">,</span>
            <span class="s1">&#39;confidence_explanation&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_confidence_explanation</span><span class="p">(</span>
                <span class="n">base_prediction</span><span class="p">,</span> <span class="n">user_profile</span>
            <span class="p">),</span>
            <span class="s1">&#39;key_factors&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_personalize_key_factors</span><span class="p">(</span>
                <span class="n">base_prediction</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">],</span> <span class="n">user_profile</span>
            <span class="p">),</span>
            <span class="s1">&#39;similar_matches&#39;</span><span class="p">:</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_similar_matches</span><span class="p">(</span>
                <span class="n">match_id</span><span class="p">,</span> <span class="n">user_profile</span>
            <span class="p">)</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">insights</span>
</code></pre></div>
<h4 id="643">6.4.3 推荐系统评估框架<a class="headerlink" href="#643" title="Permanent link">&para;</a></h4>
<p><strong>A/B测试和效果评估：</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># src/personalization/evaluation.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RecommendationEvaluator</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_calculator</span> <span class="o">=</span> <span class="n">MetricsCalculator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ab_tester</span> <span class="o">=</span> <span class="n">ABTester</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_recommendation_quality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recommendations</span><span class="p">,</span> <span class="n">user_interactions</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;评估推荐质量&quot;&quot;&quot;</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;precision&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_precision</span><span class="p">(</span><span class="n">recommendations</span><span class="p">,</span> <span class="n">user_interactions</span><span class="p">),</span>
            <span class="s1">&#39;recall&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_recall</span><span class="p">(</span><span class="n">recommendations</span><span class="p">,</span> <span class="n">user_interactions</span><span class="p">),</span>
            <span class="s1">&#39;f1_score&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_f1_score</span><span class="p">(</span><span class="n">recommendations</span><span class="p">,</span> <span class="n">user_interactions</span><span class="p">),</span>
            <span class="s1">&#39;diversity&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_diversity</span><span class="p">(</span><span class="n">recommendations</span><span class="p">),</span>
            <span class="s1">&#39;novelty&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_novelty</span><span class="p">(</span><span class="n">recommendations</span><span class="p">,</span> <span class="n">user_interactions</span><span class="p">),</span>
            <span class="s1">&#39;coverage&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_coverage</span><span class="p">(</span><span class="n">recommendations</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">metrics</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run_recommendation_ab_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control_algorithm</span><span class="p">,</span> <span class="n">treatment_algorithm</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;运行推荐算法A/B测试&quot;&quot;&quot;</span>
        <span class="n">test_users</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_select_test_users</span><span class="p">()</span>

        <span class="c1"># 分配用户到对照组和实验组</span>
        <span class="n">control_group</span><span class="p">,</span> <span class="n">treatment_group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_split_users</span><span class="p">(</span><span class="n">test_users</span><span class="p">)</span>

        <span class="c1"># 运行测试</span>
        <span class="n">control_results</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_recommendation_test</span><span class="p">(</span>
            <span class="n">control_group</span><span class="p">,</span> <span class="n">control_algorithm</span>
        <span class="p">)</span>
        <span class="n">treatment_results</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_recommendation_test</span><span class="p">(</span>
            <span class="n">treatment_group</span><span class="p">,</span> <span class="n">treatment_algorithm</span>
        <span class="p">)</span>

        <span class="c1"># 统计分析</span>
        <span class="n">significance_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_perform_significance_test</span><span class="p">(</span>
            <span class="n">control_results</span><span class="p">,</span> <span class="n">treatment_results</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;control_metrics&#39;</span><span class="p">:</span> <span class="n">control_results</span><span class="p">[</span><span class="s1">&#39;metrics&#39;</span><span class="p">],</span>
            <span class="s1">&#39;treatment_metrics&#39;</span><span class="p">:</span> <span class="n">treatment_results</span><span class="p">[</span><span class="s1">&#39;metrics&#39;</span><span class="p">],</span>
            <span class="s1">&#39;statistical_significance&#39;</span><span class="p">:</span> <span class="n">significance_test</span><span class="p">,</span>
            <span class="s1">&#39;recommendation&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_algorithm_recommendation</span><span class="p">(</span><span class="n">significance_test</span><span class="p">)</span>
        <span class="p">}</span>
</code></pre></div>
<h3 id="65">6.5 系统扩展总结<a class="headerlink" href="#65" title="Permanent link">&para;</a></h3>
<h4 id="651">6.5.1 扩展优先级排序<a class="headerlink" href="#651" title="Permanent link">&para;</a></h4>
<p><strong>第一优先级（6个月内）：</strong></p>
<ol>
<li>模型自动更新机制 - 保证预测质量持续优化</li>
<li>实时赔率采集 - 提供更及时的市场信息</li>
<li>多层缓存架构 - 支撑高并发访问需求</li>
</ol>
<p><strong>第二优先级（12个月内）：</strong></p>
<ol>
<li>用户画像系统 - 提升用户体验和粘性</li>
<li>消息队列优化 - 提高系统响应性和可靠性</li>
<li>数据库集群化 - 支撑更大规模数据处理</li>
</ol>
<p><strong>第三优先级（18个月内）：</strong></p>
<ol>
<li>个性化推荐引擎 - 增强产品竞争力</li>
<li>高级分析功能 - 提供更深入的数据见解</li>
<li>多语言和多地区支持 - 扩大用户覆盖面</li>
</ol>
<h4 id="652">6.5.2 技术债务管理<a class="headerlink" href="#652" title="Permanent link">&para;</a></h4>
<p><strong>代码重构计划：</strong></p>
<ul>
<li>建立代码质量监控和自动重构工具</li>
<li>定期进行架构评审和技术债务清理</li>
<li>实施微服务拆分，提高系统模块化程度</li>
</ul>
<p><strong>性能优化路线图：</strong></p>
<ul>
<li>建立性能基准测试和持续监控</li>
<li>实施渐进式性能优化策略</li>
<li>定期进行容量规划和扩容预案</li>
</ul>
<p><strong>安全加固措施：</strong></p>
<ul>
<li>实施零信任安全架构</li>
<li>建立安全漏洞扫描和修复流程</li>
<li>加强数据加密和隐私保护措施</li>
</ul>
<hr />
<h2 id="_54">📄 文档版本信息<a class="headerlink" href="#_54" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>文档版本</strong>：v1.0</li>
<li><strong>创建日期</strong>：2024年1月</li>
<li><strong>最后更新</strong>：2024年1月</li>
<li><strong>负责人</strong>：系统架构团队</li>
<li><strong>审核状态</strong>：已审核通过</li>
</ul>
<h2 id="_55">📞 联系信息<a class="headerlink" href="#_55" title="Permanent link">&para;</a></h2>
<p>如有任何问题或建议，请联系开发团队：</p>
<ul>
<li><strong>邮箱</strong>：<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#100;&#101;&#118;&#45;&#116;&#101;&#97;&#109;&#64;&#102;&#111;&#111;&#116;&#98;&#97;&#108;&#108;&#45;&#112;&#114;&#101;&#100;&#105;&#99;&#116;&#105;&#111;&#110;&#46;&#99;&#111;&#109;">&#100;&#101;&#118;&#45;&#116;&#101;&#97;&#109;&#64;&#102;&#111;&#111;&#116;&#98;&#97;&#108;&#108;&#45;&#112;&#114;&#101;&#100;&#105;&#99;&#116;&#105;&#111;&#110;&#46;&#99;&#111;&#109;</a></li>
<li><strong>技术文档</strong>：<a href="https://docs.football-prediction.com">https://docs.football-prediction.com</a></li>
<li><strong>项目仓库</strong>：<a href="https://github.com/your-org/football-prediction-system">https://github.com/your-org/football-prediction-system</a></li>
</ul>
<hr />
<p><strong>本文档为足球比赛结果预测系统的正式技术架构设计文档，所有开发活动应严格按照本文档执行。</strong></p>












                

  <!-- 添加页面导航助手 -->
  

              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
  
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Football Prediction Team
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      

  <!-- 自定义页脚内容 -->
  <footer class="md-footer-meta">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        <div class="md-footer-copyright__highlight">
          © 2025 Football Prediction Team -
          基于 <a href="https://www.mkdocs.org/">MkDocs</a> 和
          <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a> 构建
        </div>
        <div class="md-footer-copyright__small">
          文档最后更新: 2025-10-23 |
          版本: v1.0.0
        </div>
      </div>

      <!-- 社交链接 (暂时注释掉) -->
      <!--
      <div class="md-footer-social">
        
      </div>
      -->
    </div>
  </footer>

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
  
      <script src="../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    

  <!-- Google Analytics (配置为静态值) -->
  <!--
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXX-X"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-XXXXX-X');
  </script>
  -->

  </body>
</html>