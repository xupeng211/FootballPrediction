# 务实的开发工作流程

基于当前项目状态（测试覆盖率16.5%）的渐进式改进方法

## 🎯 核心原则

1. **不让情况变得更糟**
   - 每次提交不增加新的失败测试
   - 不引入新的 lint 错误

2. **快速反馈循环**
   - 本地先运行基本检查
   - 不要等 CI 发现简单错误

3. **渐进式改进**
   - 每周提高一点点
   - 庆祝小胜利

## 📋 推荐的工作流程

### 日常开发（每30分钟）
```bash
# 快速检查
make test-quick          # 只运行关键测试
```

### 提交前（必须）
```bash
# 1. 语法检查（5秒）
python -m py_compile src/**/*.py

# 2. 快速 lint（10秒）
ruff check src/ --quiet --max-line-length=100

# 3. 运行一个测试（30秒）
pytest tests/unit/test_config.py -v

# 如果都通过，提交
git add -A
git commit -m "feat: 描述改动"
```

### 推送前（每天1-2次）
```bash
# 运行覆盖率检查（2分钟）
make coverage-local  # 确保不低于15%

# 如果通过，推送
git push
```

## ⚠️ 什么时候可以使用 --no-verify

1. **紧急修复**：生产环境问题
2. **文档更新**：不涉及代码的改动
3. **实验性分支**：明确标注为实验

## 📈 改进计划

### 第1周：建立基础
- 确保所有新代码有基本测试
- 覆盖率达到 18%

### 第2周：提高质量
- 修复 50% 的 lint 错误
- 覆盖率达到 20%

### 第3周：巩固成果
- 覆盖率达到 25%
- 减少使用 --no-verify

### 第4周：建立习惯
- 覆盖率达到 30%
- 完全不使用 --no-verify

## 🎖️ 成功指标

- [ ] CI 通过率 > 90%
- [ ] 本地测试运行率 > 80%
- [ ] 覆盖率每周 +5%
- [ ] lint 错误每周 -20%
