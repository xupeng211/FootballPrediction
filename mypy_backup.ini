[mypy]
# 全局配置
python_version = 3.11
warn_unused_configs = True
disallow_untyped_defs = False
check_untyped_defs = False
warn_return_any = False
warn_redundant_casts = False
warn_unused_ignores = False
no_implicit_optional = False
strict_equality = True
show_error_codes = True
pretty = True
show_column_numbers = True
show_error_context = True

# 排除路径（正则表达式）
exclude = (?x)(
    ^examples/|
    ^scripts/|
    ^notebooks/|
    _simple\.py$|
    ^tests/|
    ^src/domain_simple/|
    ^src/streaming/.*_simple|
    ^src/adapters/.*_simple
)

# === 阶段 1: 核心业务模块（较严格模式） ===
[mypy-src.core.*]
disallow_untyped_defs = True
check_untyped_defs = True
ignore_missing_imports = True
warn_return_any = True
warn_unused_ignores = True

[mypy-src.services.*]
disallow_untyped_defs = False
check_untyped_defs = True
ignore_missing_imports = True
warn_return_any = False
warn_unused_ignores = False

[mypy-src.api.*]
disallow_untyped_defs = True
check_untyped_defs = True
ignore_missing_imports = True
warn_return_any = True
warn_unused_ignores = True

[mypy-src.domain.*]
disallow_untyped_defs = False
check_untyped_defs = False
ignore_missing_imports = True
warn_return_any = False
warn_unused_ignores = False
disable_error_code = name-defined,no-any-return,arg-type,attr-defined,assignment,var-annotated,operator,call-overload

[mypy-src.repositories.*]
disallow_untyped_defs = True
check_untyped_defs = True
ignore_missing_imports = True
warn_return_any = False
warn_unused_ignores = False

[mypy-src.database.repositories.*]
disallow_untyped_defs = True
check_untyped_defs = True
ignore_missing_imports = True
warn_return_any = False
warn_unused_ignores = False

# === 阶段 2: 辅助模块（宽松模式） ===
[mypy-src.utils.*]
ignore_missing_imports = True
warn_return_any = False
warn_unused_ignores = False

[mypy-src.monitoring.*]
ignore_missing_imports = True
warn_return_any = False
warn_unused_ignores = False

[mypy-src.tasks.*]
ignore_missing_imports = True
warn_return_any = False
warn_unused_ignores = False

[mypy-src.cache.*]
ignore_missing_imports = True
warn_return_any = False
warn_unused_ignores = False

[mypy-src.collectors.*]
ignore_missing_imports = True
warn_return_any = False
warn_unused_ignores = False

[mypy-src.data.*]
ignore_missing_imports = True
warn_return_any = False
warn_unused_ignores = False

[mypy-src.features.*]
ignore_missing_imports = True
warn_return_any = False
warn_unused_ignores = False
disable_error_code = misc,arg-type,attr-defined,call-overload,var-annotated,assignment,name-defined,no-any-return,return-value,valid-type

[mypy-src.ml.*]
ignore_missing_imports = True
warn_return_any = False
warn_unused_ignores = False

[mypy-src.scheduler.*]
ignore_missing_imports = True
warn_return_any = False
warn_unused_ignores = False

[mypy-src.security.*]
ignore_missing_imports = True
warn_return_any = False
warn_unused_ignores = False

[mypy-src.models.*]
ignore_missing_imports = True
warn_return_any = False
warn_unused_ignores = False

# === 阶段 3: 非核心模块（完全忽略） ===
[mypy-examples.*]
ignore_errors = True

[mypy-tests.*]
ignore_errors = True

[mypy-*_simple]
ignore_errors = True

[mypy-src.domain_simple.*]
ignore_errors = True

[mypy-src.streaming.*_simple]
ignore_errors = True

[mypy-src.adapters.*_simple]
ignore_errors = True

[mypy-src.monitoring.system_monitor]
ignore_errors = True

[mypy-src.database.migrations.env]
ignore_errors = True

[mypy-src.cache.examples]
ignore_errors = True

[mypy-src.main]
ignore_errors = True

[mypy-src.tasks.monitoring]
ignore_errors = True

[mypy-src.cache.ttl_cache_enhanced.cache_instances]
ignore_errors = True

[mypy-src.monitoring.health_checker]
ignore_errors = True

[mypy-src.api.dependencies]
ignore_errors = True

[mypy-src.facades.*]
ignore_errors = True

[mypy-src.cqrs.*]
ignore_errors = True

# 第三方库忽略
[mypy-celery.*]
ignore_missing_imports = True

[mypy-confluent_kafka.*]
ignore_missing_imports = True

[mypy-boto3.*]
ignore_missing_imports = True

[mypy-great_expectations.*]
ignore_missing_imports = True

[mypy-openlineage.*]
ignore_missing_imports = True

[mypy-psutil.*]
ignore_missing_imports = True

[mypy-sklearn.*]
ignore_missing_imports = True

[mypy-scipy.*]
ignore_missing_imports = True

[mypy-pandas.*]
ignore_missing_imports = True

[mypy-marshmallow.*]
ignore_missing_imports = True

[mypy-feast.*]
ignore_missing_imports = True

[mypy-mlflow.*]
ignore_missing_imports = True

[mypy-pyarrow.*]
ignore_missing_imports = True

[mypy-pyarrow.parquet.*]
ignore_missing_imports = True

[mypy-redis.*]
ignore_missing_imports = True

[mypy-kafka.*]
ignore_missing_imports = True

[mypy-prometheus_client.*]
ignore_missing_imports = True

[mypy-grafana_api.*]
ignore_missing_imports = True

[mypy-loki.*]
ignore_missing_imports = True

[mypy-opentelemetry.*]
ignore_missing_imports = True
