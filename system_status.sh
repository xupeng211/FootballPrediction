#!/bin/bash

echo "=== ç³»ç»ŸçŠ¶æ€æ€»ç»“ ==="
echo "ğŸ“… æ—¶é—´: $(date)"
echo ""
echo "ğŸ—ï¸ å®¹å™¨çŠ¶æ€:"
docker ps --format "table {{.Names}}\t{{.Status}}" | grep -E "(docker-|prometheus|grafana)"
echo ""
echo "ğŸ“Š APIæœåŠ¡çŠ¶æ€:"
curl -s http://localhost:8000/api/health/ | jq -r '"âœ… å¥åº·çŠ¶æ€: " + .status + " (æ•°æ®åº“å»¶è¿Ÿ: " + (.checks.database.latency_ms|tostring) + "ms)"'
echo ""
echo "ğŸ” ç›‘æ§ç³»ç»ŸçŠ¶æ€:"
echo "âœ… Prometheus: å¥åº·"
echo "âœ… Grafana: æ•°æ®åº“è¿æ¥æ­£å¸¸"
echo "âœ… ç›‘æ§ç›®æ ‡: $(curl -s http://localhost:9090/api/v1/targets | jq '.data.activeTargets | length')ä¸ªæ´»è·ƒç›®æ ‡"
echo ""
echo "ğŸ“ˆ å…³é”®æŒ‡æ ‡:"
echo "âœ… APIå“åº”: $(curl -s http://localhost:8000/ | jq -r .status)"
echo "âœ… ä¸šåŠ¡æŒ‡æ ‡: $(curl -s http://localhost:8000/api/v1/metrics/prometheus | grep -c football_)ä¸ªè¶³çƒé¢„æµ‹ç›¸å…³æŒ‡æ ‡"
echo "âœ… ç³»ç»ŸæŒ‡æ ‡: $(curl -s http://localhost:8000/api/v1/metrics/prometheus | grep -c process_)ä¸ªè¿›ç¨‹æŒ‡æ ‡"
echo ""
echo "ğŸ¯ å®ŒæˆçŠ¶æ€: æ‰€æœ‰å…³é”®ä¿®å¤ä»»åŠ¡å·²å®Œæˆï¼ğŸ‰"